<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> Charts | air-methods.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content=" Charts | air-methods.utf8" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" Charts | air-methods.utf8" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visuals.html"/>
<link rel="next" href="time-series.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>1</b> Best practices</a><ul>
<li class="chapter" data-level="1.1" data-path="best-practices.html"><a href="best-practices.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>1.1</b> Welcome to the Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="best-practices.html"><a href="best-practices.html#keep-r-updated"><i class="fa fa-check"></i><b>1.2</b> Keep R updated</a></li>
<li class="chapter" data-level="1.3" data-path="best-practices.html"><a href="best-practices.html#script-organization"><i class="fa fa-check"></i><b>1.3</b> Script organization</a></li>
<li class="chapter" data-level="1.4" data-path="best-practices.html"><a href="best-practices.html#divide-and-conquer"><i class="fa fa-check"></i><b>1.4</b> Divide and conquer</a></li>
<li class="chapter" data-level="1.5" data-path="best-practices.html"><a href="best-practices.html#codebooks-metadata-and-data-dictionaries"><i class="fa fa-check"></i><b>1.5</b> Codebooks, metadata, and data dictionaries</a></li>
<li class="chapter" data-level="1.6" data-path="best-practices.html"><a href="best-practices.html#data-formatting"><i class="fa fa-check"></i><b>1.6</b> Data formatting</a></li>
<li class="chapter" data-level="1.7" data-path="best-practices.html"><a href="best-practices.html#pollutant-names"><i class="fa fa-check"></i><b>1.7</b> Pollutant names</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>2</b> Get data</a><ul>
<li class="chapter" data-level="2.1" data-path="get-data.html"><a href="get-data.html#air-monitoring"><i class="fa fa-check"></i><b>2.1</b> Air monitoring</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-data.html"><a href="get-data.html#AQS"><i class="fa fa-check"></i><b>2.1.1</b> Retrieving data from AQS</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-data.html"><a href="get-data.html#rqamd"><i class="fa fa-check"></i><b>2.1.2</b> Retrieving data from AQS DataMart</a></li>
<li class="chapter" data-level="2.1.3" data-path="get-data.html"><a href="get-data.html#aqi-now"><i class="fa fa-check"></i><b>2.1.3</b> Current AQI observations</a></li>
<li class="chapter" data-level="2.1.4" data-path="get-data.html"><a href="get-data.html#wairsites"><i class="fa fa-check"></i><b>2.1.4</b> WAIR Site information table</a></li>
<li class="chapter" data-level="2.1.5" data-path="get-data.html"><a href="get-data.html#monitors"><i class="fa fa-check"></i><b>2.1.5</b> AirNow:Active AQI monitors</a></li>
<li class="chapter" data-level="2.1.6" data-path="get-data.html"><a href="get-data.html#EPAsites"><i class="fa fa-check"></i><b>2.1.6</b> EPA Google Earth Site Maps</a></li>
<li class="chapter" data-level="2.1.7" data-path="get-data.html"><a href="get-data.html#lims"><i class="fa fa-check"></i><b>2.1.7</b> Retrieving data from LIMS via Tableau</a></li>
<li class="chapter" data-level="2.1.8" data-path="get-data.html"><a href="get-data.html#AirVision"><i class="fa fa-check"></i><b>2.1.8</b> Retrieving continuous data from AirVision</a></li>
<li class="chapter" data-level="2.1.9" data-path="get-data.html"><a href="get-data.html#wair"><i class="fa fa-check"></i><b>2.1.9</b> Retrieving data from MPCA WAIR database</a></li>
<li class="chapter" data-level="2.1.10" data-path="get-data.html"><a href="get-data.html#toxics"><i class="fa fa-check"></i><b>2.1.10</b> Air toxics Data Explorer</a></li>
<li class="chapter" data-level="2.1.11" data-path="get-data.html"><a href="get-data.html#criteria"><i class="fa fa-check"></i><b>2.1.11</b> Criteria Pollutant Data Explorer</a></li>
<li class="chapter" data-level="2.1.12" data-path="get-data.html"><a href="get-data.html#AQI"><i class="fa fa-check"></i><b>2.1.12</b> Air Quality Index Summary Reports</a></li>
<li class="chapter" data-level="2.1.13" data-path="get-data.html"><a href="get-data.html#PAHs"><i class="fa fa-check"></i><b>2.1.13</b> Air Monitoring for PAHs</a></li>
<li class="chapter" data-level="2.1.14" data-path="get-data.html"><a href="get-data.html#tableau"><i class="fa fa-check"></i><b>2.1.14</b> Internal Data Explorers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-data.html"><a href="get-data.html#health-and-standards"><i class="fa fa-check"></i><b>2.2</b> Health and standards</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-data.html"><a href="get-data.html#IHBs"><i class="fa fa-check"></i><b>2.2.1</b> Inhalation health benchmarks (IHBs)</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-data.html"><a href="get-data.html#NAAQS"><i class="fa fa-check"></i><b>2.2.2</b> Air Quality Standards (NAAQS and MAAQS)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-data.html"><a href="get-data.html#air-modeling"><i class="fa fa-check"></i><b>2.3</b> Air modeling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="get-data.html"><a href="get-data.html#nata"><i class="fa fa-check"></i><b>2.3.1</b> NATA modeling</a></li>
<li class="chapter" data-level="2.3.2" data-path="get-data.html"><a href="get-data.html#mnrisks"><i class="fa fa-check"></i><b>2.3.2</b> MNRISKS statewide risk modeling</a></li>
<li class="chapter" data-level="2.3.3" data-path="get-data.html"><a href="get-data.html#downscale"><i class="fa fa-check"></i><b>2.3.3</b> Downscaler modeling results for Ozone and PM2.5</a></li>
<li class="chapter" data-level="2.3.4" data-path="get-data.html"><a href="get-data.html#cmaq"><i class="fa fa-check"></i><b>2.3.4</b> CMAQ Ozone modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="get-data.html"><a href="get-data.html#context"><i class="fa fa-check"></i><b>2.4</b> Context</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-data.html"><a href="get-data.html#mn-ei"><i class="fa fa-check"></i><b>2.4.1</b> MN Emissions Inventory</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-data.html"><a href="get-data.html#nei"><i class="fa fa-check"></i><b>2.4.2</b> EPA’s NEI</a></li>
<li class="chapter" data-level="2.4.3" data-path="get-data.html"><a href="get-data.html#fac-coords"><i class="fa fa-check"></i><b>2.4.3</b> Facility locations</a></li>
<li class="chapter" data-level="2.4.4" data-path="get-data.html"><a href="get-data.html#wx-obs"><i class="fa fa-check"></i><b>2.4.4</b> Weather observations</a></li>
<li class="chapter" data-level="2.4.5" data-path="get-data.html"><a href="get-data.html#hysplit"><i class="fa fa-check"></i><b>2.4.5</b> HYSPLIT wind trajectories</a></li>
<li class="chapter" data-level="2.4.6" data-path="get-data.html"><a href="get-data.html#landuse"><i class="fa fa-check"></i><b>2.4.6</b> Land use maps</a></li>
<li class="chapter" data-level="2.4.7" data-path="get-data.html"><a href="get-data.html#census"><i class="fa fa-check"></i><b>2.4.7</b> United States Census boundaries</a></li>
<li class="chapter" data-level="2.4.8" data-path="get-data.html"><a href="get-data.html#acs"><i class="fa fa-check"></i><b>2.4.8</b> American Community Survey (ACS)</a></li>
</ul></li>
</ul></li>
<li><a href="quality-assurance-methods.html#quality-assurance-methods"><strong>Quality assurance methods</strong></a></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#missing"><i class="fa fa-check"></i><b>3.1</b> Blank, NULL, and missing values</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#quals"><i class="fa fa-check"></i><b>3.2</b> Qualified data</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#dups"><i class="fa fa-check"></i><b>3.3</b> Duplicate observations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-validation.html"><a href="data-validation.html"><i class="fa fa-check"></i><b>4</b> Data validation</a><ul>
<li class="chapter" data-level="4.1" data-path="data-validation.html"><a href="data-validation.html#leaks"><i class="fa fa-check"></i><b>4.1</b> Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="4.2" data-path="data-validation.html"><a href="data-validation.html#outs"><i class="fa fa-check"></i><b>4.2</b> Extreme values and outliers</a></li>
<li class="chapter" data-level="4.3" data-path="data-validation.html"><a href="data-validation.html#sticky2"><i class="fa fa-check"></i><b>4.3</b> Sequential repeats and “sticky” numbers</a></li>
<li class="chapter" data-level="4.4" data-path="data-validation.html"><a href="data-validation.html#unique"><i class="fa fa-check"></i><b>4.4</b> Unique detected values</a></li>
<li class="chapter" data-level="4.5" data-path="data-validation.html"><a href="data-validation.html#valid_ref"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="collocated-monitors.html"><a href="collocated-monitors.html"><i class="fa fa-check"></i><b>5</b> Collocated monitors</a><ul>
<li class="chapter" data-level="5.1" data-path="collocated-monitors.html"><a href="collocated-monitors.html#evalpocs"><i class="fa fa-check"></i><b>5.1</b> Evaluate collocated air monitors</a></li>
<li class="chapter" data-level="5.2" data-path="collocated-monitors.html"><a href="collocated-monitors.html#pripocs"><i class="fa fa-check"></i><b>5.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="detection-limits.html"><a href="detection-limits.html"><i class="fa fa-check"></i><b>6</b> Detection limits</a><ul>
<li class="chapter" data-level="6.1" data-path="detection-limits.html"><a href="detection-limits.html#method-detection-limit"><i class="fa fa-check"></i><b>6.1</b> Method Detection Limit</a></li>
<li class="chapter" data-level="6.2" data-path="detection-limits.html"><a href="detection-limits.html#calculating-mdls"><i class="fa fa-check"></i><b>6.2</b> Calculating MDLs</a></li>
<li class="chapter" data-level="6.3" data-path="detection-limits.html"><a href="detection-limits.html#finding-mpca-detection-limits"><i class="fa fa-check"></i><b>6.3</b> Finding MPCA detection limits</a></li>
<li class="chapter" data-level="6.4" data-path="detection-limits.html"><a href="detection-limits.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>6.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="6.5" data-path="detection-limits.html"><a href="detection-limits.html#estimating-below-detection-values-what-not-to-do"><i class="fa fa-check"></i><b>6.5</b> Estimating below detection values <em>(what not to do)</em></a></li>
<li class="chapter" data-level="6.6" data-path="detection-limits.html"><a href="detection-limits.html#below-detection-values"><i class="fa fa-check"></i><b>6.6</b> Below detection values</a></li>
<li class="chapter" data-level="6.7" data-path="detection-limits.html"><a href="detection-limits.html#multiple-detection-limits"><i class="fa fa-check"></i><b>6.7</b> Multiple detection limits</a></li>
<li class="chapter" data-level="6.8" data-path="detection-limits.html"><a href="detection-limits.html#reporting-limits"><i class="fa fa-check"></i><b>6.8</b> Reporting limits</a></li>
<li class="chapter" data-level="6.9" data-path="detection-limits.html"><a href="detection-limits.html#references"><i class="fa fa-check"></i><b>6.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="completeness-checks.html"><a href="completeness-checks.html"><i class="fa fa-check"></i><b>7</b> Completeness checks</a><ul>
<li class="chapter" data-level="7.1" data-path="completeness-checks.html"><a href="completeness-checks.html#complete"><i class="fa fa-check"></i><b>7.1</b> Completeness checks</a></li>
</ul></li>
<li><a href="summary-methods.html#summary-methods"><strong>Summary methods</strong></a></li>
<li class="chapter" data-level="8" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>8</b> Summary statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-statistics.html"><a href="summary-statistics.html#normal"><i class="fa fa-check"></i><b>8.1</b> Test for normality</a></li>
<li class="chapter" data-level="8.2" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>8.2</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.3" data-path="summary-statistics.html"><a href="summary-statistics.html#below"><i class="fa fa-check"></i><b>8.3</b> Below the detection limit</a></li>
<li class="chapter" data-level="8.4" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>8.4</b> Upper confidence limits (UCLs)</a></li>
<li class="chapter" data-level="8.5" data-path="summary-statistics.html"><a href="summary-statistics.html#incomplete"><i class="fa fa-check"></i><b>8.5</b> Annual summaries for incomplete data</a></li>
<li class="chapter" data-level="8.6" data-path="summary-statistics.html"><a href="summary-statistics.html#health"><i class="fa fa-check"></i><b>8.6</b> Comparison of data to inhalation health benchmarks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="site-comparisons.html"><a href="site-comparisons.html"><i class="fa fa-check"></i><b>9</b> Site comparisons</a><ul>
<li class="chapter" data-level="9.1" data-path="site-comparisons.html"><a href="site-comparisons.html#confidence-intervals"><i class="fa fa-check"></i><b>9.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.2" data-path="site-comparisons.html"><a href="site-comparisons.html#tools-to-visualize-data"><i class="fa fa-check"></i><b>9.2</b> Tools to visualize data</a><ul>
<li class="chapter" data-level="9.2.1" data-path="site-comparisons.html"><a href="site-comparisons.html#beeswarm-plots"><i class="fa fa-check"></i><b>9.2.1</b> Beeswarm Plots</a></li>
<li class="chapter" data-level="9.2.2" data-path="site-comparisons.html"><a href="site-comparisons.html#correlation-matrices"><i class="fa fa-check"></i><b>9.2.2</b> Correlation matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="start-finish.html"><a href="start-finish.html"><i class="fa fa-check"></i><b>10</b> From start to finish</a><ul>
<li class="chapter" data-level="10.1" data-path="start-finish.html"><a href="start-finish.html#functions"><i class="fa fa-check"></i><b>10.1</b> Functions</a></li>
<li class="chapter" data-level="10.2" data-path="start-finish.html"><a href="start-finish.html#analysis-steps"><i class="fa fa-check"></i><b>10.2</b> Analysis steps</a></li>
</ul></li>
<li><a href="visuals.html#visuals"><strong>Visuals</strong></a></li>
<li class="chapter" data-level="11" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>11</b> Charts</a><ul>
<li class="chapter" data-level="11.1" data-path="charts.html"><a href="charts.html#calendar-plots"><i class="fa fa-check"></i><b>11.1</b> Calendar plots</a></li>
<li class="chapter" data-level="11.2" data-path="charts.html"><a href="charts.html#colors-and-themes"><i class="fa fa-check"></i><b>11.2</b> Colors and themes</a></li>
<li class="chapter" data-level="11.3" data-path="charts.html"><a href="charts.html#pollution-roses"><i class="fa fa-check"></i><b>11.3</b> Pollution roses</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>12</b> Time series</a><ul>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#hour-of-the-day"><i class="fa fa-check"></i>Hour of the day</a></li>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#day-of-the-week"><i class="fa fa-check"></i>Day of the week</a></li>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i>Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a><ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-map-of-air-monitors"><i class="fa fa-check"></i>Interactive map of air monitors</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#creating-shapefiles-in-r"><i class="fa fa-check"></i>Creating shapefiles in R</a></li>
</ul></li>
<li><a href="mpca-data-tools.html#mpca-data-tools"><strong>MPCA data tools</strong></a></li>
<li class="chapter" data-level="14" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html"><i class="fa fa-check"></i><b>14</b> Air toxics explorer</a><ul>
<li class="chapter" data-level="14.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#mpca-air-toxics-methods"><i class="fa fa-check"></i><b>14.1</b> MPCA Air Toxics Methods</a><ul>
<li class="chapter" data-level="14.1.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-cleaning-1"><i class="fa fa-check"></i><b>14.1.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="14.1.2" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-validation-1"><i class="fa fa-check"></i><b>14.1.2</b> Data Validation</a></li>
<li class="chapter" data-level="14.1.3" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#parameter-occurrence-codes-pocs"><i class="fa fa-check"></i><b>14.1.3</b> Parameter Occurrence Codes (POCs)</a></li>
<li class="chapter" data-level="14.1.4" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#producing-annual-summaries"><i class="fa fa-check"></i><b>14.1.4</b> Producing Annual Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="criteria-pollutant-explorer.html"><a href="criteria-pollutant-explorer.html"><i class="fa fa-check"></i><b>15</b> Criteria pollutant explorer</a></li>
<li class="chapter" data-level="16" data-path="aqi-explorer.html"><a href="aqi-explorer.html"><i class="fa fa-check"></i><b>16</b> AQI explorer</a></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a><ul>
<li class="chapter" data-level="16.1" data-path="edit-this-book.html"><a href="edit-this-book.html#references-1"><i class="fa fa-check"></i><b>16.1</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="charts" class="section level1">
<h1><span class="header-section-number"></span> Charts</h1>
<p><img src="http://imgs.xkcd.com/comics/cat_proximity.png" style="width:45.0%" /></p>
<p><br></p>
<p>This section describes various charts for exploring and reporting air monitoring data.</p>
<div id="calendar-plots" class="section level2">
<h2><span class="header-section-number">11.1</span> Calendar plots</h2>
<p>The R package <em>openair</em> provides a convenient function for presenting data in a calendar format. The code below shows an example of using the <code>calendarPlot()</code> function to display monitoring results for formaldehyde.</p>
<p><br></p>
<p><img src="air-methods_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="colors-and-themes" class="section level2">
<h2><span class="header-section-number">11.2</span> Colors and themes</h2>
<p><img src="https://pbs.twimg.com/media/CQWw9EgWsAAoUi0.png" /></p>
<p>R offers a wide variety of color palettes and chart themes to use in your plots.</p>
<p>Some <strong>color palettes</strong> include:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">Viridis colors</a></li>
<li><a href="https://github.com/karthik/wesanderson">Wes Anderson Movies colors</a></li>
<li><a href="https://github.com/ewenme/ghibli">Ghibli Movie colors</a></li>
</ul>
<p>Some <strong>chart themes</strong> include:</p>
<ul>
<li><a href="https://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a></li>
<li><a href="http://xkcd.r-forge.r-project.org/">XKCD</a></li>
<li><a href="http://xkcd.r-forge.r-project.org/">ggthemes</a></li>
<li><a href="https://github.com/gadenbuie/ggpomological">ggpomological</a></li>
<li><a href="https://github.com/cttobin/ggthemr">ggthemr</a></li>
<li><a href="https://github.com/briandconnelly/lato">lato</a></li>
</ul>
<p>The example below shows charts with the <code>ggpomological</code> theme.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p>A pollutant scatterplot with <em>pomological</em> colors.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co">#devtools::install_github(&quot;gadenbuie/ggpomological&quot;)</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">library</span>(ggpomological)</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb85-4" title="4"></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="co"># Load air pollution data</span></a>
<a class="sourceLine" id="cb85-6" title="6">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)</a>
<a class="sourceLine" id="cb85-7" title="7"></a>
<a class="sourceLine" id="cb85-8" title="8"><span class="kw">names</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;poc&quot;</span>, <span class="st">&quot;param_code&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;null_code&quot;</span>, <span class="st">&quot;md_limit&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cas&quot;</span>)</a>
<a class="sourceLine" id="cb85-9" title="9"></a>
<a class="sourceLine" id="cb85-10" title="10">data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, pollutant <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Formaldehyde&quot;</span>, <span class="st">&quot;Benzene&quot;</span>, <span class="st">&quot;1,3-Butadiene&quot;</span>))</a>
<a class="sourceLine" id="cb85-11" title="11"></a>
<a class="sourceLine" id="cb85-12" title="12">data<span class="op">$</span>pollutant &lt;-<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>pollutant, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Formaldehyde&quot;</span>, <span class="st">&quot;Benzene&quot;</span>, <span class="st">&quot;1,3-Butadiene&quot;</span>))</a>
<a class="sourceLine" id="cb85-13" title="13"></a>
<a class="sourceLine" id="cb85-14" title="14"><span class="co"># Make scatterplot w/ pomo colors</span></a>
<a class="sourceLine" id="cb85-15" title="15"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> pollutant, <span class="dt">y =</span> conc, <span class="dt">color =</span> pollutant, <span class="dt">fill =</span> pollutant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb85-16" title="16"><span class="st">     </span><span class="kw">scale_y_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb85-17" title="17"><span class="st">     </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">factor</span>(pollutant)), <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-18" title="18"><span class="st">     </span><span class="kw">scale_color_pomological</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-19" title="19"><span class="st">     </span><span class="kw">scale_fill_pomological</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-20" title="20"><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Air monitoring results&quot;</span>)</a></code></pre></div>
<p><img src="air-methods_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<p><br></p>
<p>You can even add a calm cream paper background.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># Make scatterplot w/ pomo colors and cream background</span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> conc, <span class="dt">color =</span> pollutant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="st">     </span><span class="kw">scale_y_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb86-4" title="4"><span class="st">     </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-5" title="5"><span class="st">     </span><span class="kw">scale_color_pomological</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-6" title="6"><span class="st">     </span><span class="kw">theme_pomological</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-7" title="7"><span class="st">     </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Air monitoring results&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;2009 - 2013&quot;</span>)</a></code></pre></div>
<p><img src="air-methods_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<p><br></p>
<p>Or create a fancy chart in the style of an old fashioned nature journal.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">library</span>(extrafont)</a>
<a class="sourceLine" id="cb87-2" title="2"></a>
<a class="sourceLine" id="cb87-3" title="3"></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="co">## Download fancyfont here - https://fonts.google.com/specimen/Homemade+Apple/</span></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="co">## Add to this folder - &quot;Control Panel\All Control Panel Items\Fonts&quot;</span></a>
<a class="sourceLine" id="cb87-6" title="6"></a>
<a class="sourceLine" id="cb87-7" title="7"><span class="co"># Check loaded fonts</span></a>
<a class="sourceLine" id="cb87-8" title="8"><span class="kw">loadfonts</span>(<span class="dt">device =</span> <span class="st">&quot;win&quot;</span>)</a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="co">#windowsFonts()</span></a>
<a class="sourceLine" id="cb87-11" title="11"></a>
<a class="sourceLine" id="cb87-12" title="12">fonts_df &lt;-<span class="st"> </span><span class="kw">fonttable</span>()</a>
<a class="sourceLine" id="cb87-13" title="13"></a>
<a class="sourceLine" id="cb87-14" title="14"><span class="kw">font_import</span>(<span class="dt">pattern =</span> <span class="st">&quot;HomemadeApple-Regular&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># Make fancy scatterplot w/ pomo colors, paper background and cursive fonts</span></a>
<a class="sourceLine" id="cb88-2" title="2">fancy_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> conc, <span class="dt">color =</span> pollutant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="st">                   </span><span class="kw">scale_y_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="st">                   </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="st">                   </span><span class="kw">scale_color_pomological</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb88-6" title="6"><span class="st">                   </span><span class="kw">theme_pomological_fancy</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb88-7" title="7"><span class="st">                   </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Air monitoring data&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;2009 - 2013&quot;</span>)</a>
<a class="sourceLine" id="cb88-8" title="8"></a>
<a class="sourceLine" id="cb88-9" title="9"><span class="co"># Create web image</span></a>
<a class="sourceLine" id="cb88-10" title="10"><span class="kw">paint_pomological</span>(fancy_plot, <span class="dt">res =</span> <span class="dv">120</span>)</a></code></pre></div>
<p><img src="air-methods_files/figure-html/unnamed-chunk-103-1.png" width="100%" /></p>
<p><br></p>
<p>Or create a density plot.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#devtools::install_github(&quot;yixuan/showtext&quot;)</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">library</span>(showtext)</a>
<a class="sourceLine" id="cb89-3" title="3"></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="co"># Get fancy font</span></a>
<a class="sourceLine" id="cb89-5" title="5"><span class="kw">font_add_google</span>(<span class="dt">name =</span> <span class="st">&quot;Homemade Apple&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Homemade Apple&quot;</span>)</a>
<a class="sourceLine" id="cb89-6" title="6"></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="co">#font_add_google(name = &quot;Indie Flower&quot;, family = &quot;Indie Flower&quot;)</span></a>
<a class="sourceLine" id="cb89-8" title="8"></a>
<a class="sourceLine" id="cb89-9" title="9"></a>
<a class="sourceLine" id="cb89-10" title="10"><span class="co"># Create density plot</span></a>
<a class="sourceLine" id="cb89-11" title="11"><span class="co">#showtext_begin()</span></a>
<a class="sourceLine" id="cb89-12" title="12"><span class="co">#showtext_end()</span></a>
<a class="sourceLine" id="cb89-13" title="13"></a>
<a class="sourceLine" id="cb89-14" title="14"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">sqrt</span>(conc), <span class="dt">fill =</span> pollutant, <span class="dt">color =</span> pollutant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-15" title="15"><span class="st">                   </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb89-16" title="16"><span class="st">                   </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-17" title="17"><span class="st">                   </span><span class="kw">scale_fill_pomological</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb89-18" title="18"><span class="st">                   </span><span class="kw">scale_color_pomological</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb89-19" title="19"><span class="st">                   </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Air monitoring data&quot;</span>, </a>
<a class="sourceLine" id="cb89-20" title="20">                        <span class="dt">subtitle =</span> <span class="st">&quot;2009 - 2013&quot;</span>, </a>
<a class="sourceLine" id="cb89-21" title="21">                        <span class="dt">x        =</span> <span class="st">&quot;concentration&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-22" title="22"><span class="st">                   </span><span class="kw">theme_pomological</span>(<span class="st">&quot;Homemade Apple&quot;</span>)  <span class="co">#theme(text = element_text(family = &quot;Homemade Apple&quot;))</span></a></code></pre></div>
<p><img src="air-methods_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p><br></p>
<p>Or split up the density plot into separate rows.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">library</span>(ggridges)</a>
<a class="sourceLine" id="cb90-2" title="2"></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="co"># Create fancy_plot</span></a>
<a class="sourceLine" id="cb90-4" title="4">fancy_plot &lt;-<span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">sqrt</span>(conc), <span class="dt">y =</span> forcats<span class="op">::</span><span class="kw">fct_rev</span>(pollutant), <span class="dt">fill =</span> pollutant, <span class="dt">color =</span> pollutant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-5" title="5"><span class="st">                   </span><span class="kw">geom_density_ridges</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-6" title="6"><span class="st">                   </span><span class="kw">theme_pomological</span>(<span class="dt">base_family =</span> <span class="st">&#39;Homemade Apple&#39;</span>,</a>
<a class="sourceLine" id="cb90-7" title="7">                                     <span class="dt">base_size   =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb90-8" title="8">                                     <span class="dt">base_theme  =</span> ggridges<span class="op">::</span><span class="kw">theme_ridges</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-9" title="9"><span class="st">                   </span><span class="kw">scale_fill_pomological</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb90-10" title="10"><span class="st">                   </span><span class="kw">scale_color_pomological</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb90-11" title="11"><span class="st">                   </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Air monitoring data&quot;</span>, </a>
<a class="sourceLine" id="cb90-12" title="12">                        <span class="dt">subtitle =</span> <span class="st">&quot;2009 - 2013&quot;</span>, </a>
<a class="sourceLine" id="cb90-13" title="13">                        <span class="dt">x        =</span> <span class="st">&quot;concentration&quot;</span>, </a>
<a class="sourceLine" id="cb90-14" title="14">                        <span class="dt">y        =</span> <span class="st">&quot;pollutant&quot;</span>)</a>
<a class="sourceLine" id="cb90-15" title="15"></a>
<a class="sourceLine" id="cb90-16" title="16"><span class="co"># Create web image</span></a>
<a class="sourceLine" id="cb90-17" title="17"><span class="kw">paint_pomological</span>(fancy_plot, <span class="dt">res =</span> <span class="dv">120</span>)</a></code></pre></div>
<p><img src="air-methods_files/figure-html/unnamed-chunk-105-1.png" width="100%" /></p>
</div>
</div>
<div id="pollution-roses" class="section level2">
<h2><span class="header-section-number">11.3</span> Pollution roses</h2>
<p><img src="images/pollution_rose.png" style="width:70.0%" /></p>
<p><br></p>
<p>Pollution roses display a map of pollutant concentrations that correspond to different wind directions. The length of each “paddle” is correlated with the percentage valid measurements taken when the wind was blowing from that direction.</p>
<p>If the longest paddle is the one extending downward, then the wind blew from the South on average more times than any other direction for days with valid pollutant measurements. The colors on a paddle correspond to the concentration of the pollutant. In this case, blue shows lower concentrations and orange shows higher concentrations.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>For a 24-hour sample, the plotted wind direction is the vector averaged wind direction over all hours of the day.</p>
</blockquote>
<p><br></p>
<p><strong>Sample <code>R</code> script</strong></p>
<p>The script below produces an interactive Shiny App for exploring pollutant concentrations in relation to wind direction and speed.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">pollution_roses =<span class="st"> </span><span class="cf">function</span>(data, met_data_filepath, <span class="dt">num_breaks =</span> <span class="dv">5</span>) { <span class="co">#Met data must be in Tableau format</span></a>
<a class="sourceLine" id="cb91-2" title="2">  </a>
<a class="sourceLine" id="cb91-3" title="3">  <span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb91-4" title="4">  <span class="kw">library</span>(openair)</a>
<a class="sourceLine" id="cb91-5" title="5">  <span class="kw">library</span>(reshape)</a>
<a class="sourceLine" id="cb91-6" title="6">  <span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb91-7" title="7">  <span class="kw">library</span>(rsconnect)</a>
<a class="sourceLine" id="cb91-8" title="8">  </a>
<a class="sourceLine" id="cb91-9" title="9">  data<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">ymd</span>(data<span class="op">$</span>Date)</a>
<a class="sourceLine" id="cb91-10" title="10">  </a>
<a class="sourceLine" id="cb91-11" title="11">  met_data =<span class="st"> </span><span class="kw">read.csv</span>(met_data_filepath)</a>
<a class="sourceLine" id="cb91-12" title="12">  <span class="kw">names</span>(met_data)[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">9</span>)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Day&quot;</span>,<span class="st">&quot;wd&quot;</span>,<span class="st">&quot;ws&quot;</span>)</a>
<a class="sourceLine" id="cb91-13" title="13">  met_data =<span class="st"> </span><span class="kw">mutate</span>(met_data, <span class="dt">date =</span> <span class="kw">paste0</span>(Year,<span class="st">&quot;/&quot;</span>,Month,<span class="st">&quot;/&quot;</span>,Day,<span class="st">&quot; &quot;</span>,Hour,<span class="st">&quot;:00&quot;</span>))</a>
<a class="sourceLine" id="cb91-14" title="14">  met_data<span class="op">$</span>date =<span class="st"> </span><span class="kw">ymd_hm</span>(met_data<span class="op">$</span>date)</a>
<a class="sourceLine" id="cb91-15" title="15">  met_data =<span class="st"> </span>met_data[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">10</span>)]</a>
<a class="sourceLine" id="cb91-16" title="16">  met_data =<span class="st"> </span><span class="kw">timeAverage</span>(met_data, <span class="dt">avg.time =</span> <span class="st">&quot;day&quot;</span>)</a>
<a class="sourceLine" id="cb91-17" title="17">  met_data<span class="op">$</span>date =<span class="st"> </span><span class="kw">ymd</span>(met_data<span class="op">$</span>date)</a>
<a class="sourceLine" id="cb91-18" title="18">  </a>
<a class="sourceLine" id="cb91-19" title="19">  data &lt;-<span class="st"> </span><span class="kw">left_join</span>(data, met_data, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Date&quot;</span> =<span class="st"> &quot;date&quot;</span>))</a>
<a class="sourceLine" id="cb91-20" title="20">  </a>
<a class="sourceLine" id="cb91-21" title="21">  Pollutant &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>Pollutant)</a>
<a class="sourceLine" id="cb91-22" title="22">  Site &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>AQSID)</a>
<a class="sourceLine" id="cb91-23" title="23">  Year &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>Year)</a>
<a class="sourceLine" id="cb91-24" title="24"></a>
<a class="sourceLine" id="cb91-25" title="25">  <span class="kw">shinyApp</span>(</a>
<a class="sourceLine" id="cb91-26" title="26">  <span class="dt">ui =</span> <span class="kw">fluidPage</span>(<span class="dt">responsive =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb91-27" title="27">                 <span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb91-28" title="28">                   <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb91-29" title="29">                          <span class="dt">style =</span> <span class="st">&quot;padding-bottom: 20px;&quot;</span>,</a>
<a class="sourceLine" id="cb91-30" title="30">                          <span class="kw">inputPanel</span>(</a>
<a class="sourceLine" id="cb91-31" title="31">                            <span class="kw">selectInput</span>(<span class="st">&quot;Pollutant&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a pollutant&quot;</span>, <span class="dt">choices =</span> Pollutant),</a>
<a class="sourceLine" id="cb91-32" title="32">                            <span class="kw">selectInput</span>(<span class="st">&quot;Year&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a year&quot;</span>, <span class="dt">choices =</span> Year),</a>
<a class="sourceLine" id="cb91-33" title="33">                            <span class="kw">selectInput</span>(<span class="st">&quot;Site&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a site&quot;</span>, <span class="dt">choices =</span> Site))),</a>
<a class="sourceLine" id="cb91-34" title="34">                   <span class="kw">column</span>(<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb91-35" title="35">                          <span class="kw">plotOutput</span>(<span class="st">&#39;normviz&#39;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)))),</a>
<a class="sourceLine" id="cb91-36" title="36">  </a>
<a class="sourceLine" id="cb91-37" title="37">  </a>
<a class="sourceLine" id="cb91-38" title="38">  <span class="dt">server =</span> <span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb91-39" title="39">    </a>
<a class="sourceLine" id="cb91-40" title="40">    </a>
<a class="sourceLine" id="cb91-41" title="41">    </a>
<a class="sourceLine" id="cb91-42" title="42">    </a>
<a class="sourceLine" id="cb91-43" title="43">    output<span class="op">$</span>normviz &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb91-44" title="44">      <span class="kw">print</span>(input<span class="op">$</span>Pollutant)</a>
<a class="sourceLine" id="cb91-45" title="45">      <span class="kw">print</span>(input<span class="op">$</span>Site)</a>
<a class="sourceLine" id="cb91-46" title="46">      <span class="kw">print</span>(input<span class="op">$</span>Year)</a>
<a class="sourceLine" id="cb91-47" title="47">      data_sub =<span class="st"> </span><span class="kw">filter</span>(data, Pollutant<span class="op">==</span>input<span class="op">$</span>Pollutant, AQSID <span class="op">==</span><span class="st"> </span>input<span class="op">$</span>Site, Year <span class="op">==</span><span class="st"> </span>input<span class="op">$</span>Year, <span class="op">!</span><span class="kw">is.na</span>(Result))</a>
<a class="sourceLine" id="cb91-48" title="48">      data_sub =<span class="st"> </span>data_sub <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">MDL =</span> <span class="kw">max</span>(MDL), <span class="dt">minimum =</span> <span class="kw">min</span>(Result), <span class="dt">maximum =</span> <span class="kw">max</span>(Result), <span class="dt">Result =</span> <span class="kw">ifelse</span>(Censored, <span class="fl">1e-16</span>, Result))</a>
<a class="sourceLine" id="cb91-49" title="49">      breaks_site =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb91-50" title="50">      <span class="cf">if</span>(<span class="op">!</span><span class="kw">all</span>(data_sub<span class="op">$</span>Censored)){</a>
<a class="sourceLine" id="cb91-51" title="51">        </a>
<a class="sourceLine" id="cb91-52" title="52">        breaks_site =<span class="st"> </span><span class="kw">c</span>(breaks_site, <span class="dv">0</span>, <span class="co">#c(round_any(data_sub$minimum[1], 0.001, floor),</span></a>
<a class="sourceLine" id="cb91-53" title="53">                      <span class="kw">round_any</span>( <span class="kw">c</span>(data_sub<span class="op">$</span>MDL[<span class="dv">1</span>], data_sub<span class="op">$</span>MDL[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>(data_sub<span class="op">$</span>maximum[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>data_sub<span class="op">$</span>MDL[<span class="dv">1</span>]) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-54" title="54"><span class="st">                                     </span>(<span class="dv">1</span><span class="op">:</span>(num_breaks<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span>(num_breaks<span class="dv">-1</span>) ) ), <span class="fl">0.0001</span>, ceiling ) )</a>
<a class="sourceLine" id="cb91-55" title="55">        <span class="kw">pollutionRose</span>(data_sub, <span class="dt">statistic =</span> <span class="st">&quot;abs.count&quot;</span>, <span class="dt">pollutant =</span> <span class="st">&quot;Result&quot;</span>, <span class="dt">breaks =</span> breaks_site, </a>
<a class="sourceLine" id="cb91-56" title="56">                  <span class="dt">key.footer=</span><span class="st">&quot;ug/m3&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Daily Average Pollution Rose for&quot;</span>,</a>
<a class="sourceLine" id="cb91-57" title="57">                  data_sub<span class="op">$</span>Pollutant[<span class="dv">1</span>],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, data_sub<span class="op">$</span>AQSID[<span class="dv">1</span>]) )</a>
<a class="sourceLine" id="cb91-58" title="58">      }</a>
<a class="sourceLine" id="cb91-59" title="59">      <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb91-60" title="60">        breaks_site =<span class="st"> </span><span class="kw">c</span>(breaks_site, <span class="kw">c</span>(<span class="kw">round_any</span>(<span class="dv">0</span>, <span class="fl">0.0001</span>, floor),</a>
<a class="sourceLine" id="cb91-61" title="61">                      <span class="kw">round_any</span>( <span class="kw">c</span>(data_sub<span class="op">$</span>MDL[<span class="dv">1</span>], <span class="dv">2</span><span class="op">*</span>data_sub<span class="op">$</span>MDL[<span class="dv">1</span>] ), <span class="fl">0.0001</span>, ceiling ) ) )</a>
<a class="sourceLine" id="cb91-62" title="62">        <span class="kw">pollutionRose</span>(data_sub, <span class="dt">statistic =</span> <span class="st">&quot;abs.count&quot;</span>, <span class="dt">pollutant =</span> <span class="st">&quot;Result&quot;</span>, <span class="dt">breaks =</span> breaks_site, </a>
<a class="sourceLine" id="cb91-63" title="63">                  <span class="dt">key.footer=</span><span class="st">&quot;ug/m3&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Daily Average Pollution Rose for&quot;</span>,</a>
<a class="sourceLine" id="cb91-64" title="64">                  data_sub<span class="op">$</span>Pollutant[<span class="dv">1</span>],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, data_sub<span class="op">$</span>AQSID[<span class="dv">1</span>]) )</a>
<a class="sourceLine" id="cb91-65" title="65">        </a>
<a class="sourceLine" id="cb91-66" title="66">      }</a>
<a class="sourceLine" id="cb91-67" title="67">      </a>
<a class="sourceLine" id="cb91-68" title="68">    })</a>
<a class="sourceLine" id="cb91-69" title="69">    </a>
<a class="sourceLine" id="cb91-70" title="70">  })</a>
<a class="sourceLine" id="cb91-71" title="71"></a>
<a class="sourceLine" id="cb91-72" title="72">}</a></code></pre></div>
</div>
<p><br><a href="charts.html#charts">Back to top</a></p>

</div>
</div>
<script>
  $(".btn_code").click(function() {
    $(this.parentNode).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="visuals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/60-charts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["air-methods.pdf", "air-methods.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
