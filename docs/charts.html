<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.4.3 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="site-comparisons-derek-cassie.html">
<link rel="next" href="time-series.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="data-cleaning-dorian-cassie.html"><a href="data-cleaning-dorian-cassie.html"><i class="fa fa-check"></i><b>1</b> Data cleaning (Dorian &amp; Cassie)</a><ul>
<li class="chapter" data-level="1.1" data-path="data-cleaning-dorian-cassie.html"><a href="data-cleaning-dorian-cassie.html#missing"><i class="fa fa-check"></i><b>1.1</b> Remove blank, <code>NULL</code>, and missing values</a></li>
<li class="chapter" data-level="1.2" data-path="data-cleaning-dorian-cassie.html"><a href="data-cleaning-dorian-cassie.html#quals"><i class="fa fa-check"></i><b>1.2</b> Remove <code>Qualified</code> data (Cassie)</a></li>
<li class="chapter" data-level="1.3" data-path="data-cleaning-dorian-cassie.html"><a href="data-cleaning-dorian-cassie.html#dups"><i class="fa fa-check"></i><b>1.3</b> Duplicate observations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-validation-kristie.html"><a href="data-validation-kristie.html"><i class="fa fa-check"></i><b>2</b> Data validation (Kristie)</a><ul>
<li class="chapter" data-level="2.1" data-path="data-validation-kristie.html"><a href="data-validation-kristie.html#leaks"><i class="fa fa-check"></i><b>2.1</b> Identifying Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="2.2" data-path="data-validation-kristie.html"><a href="data-validation-kristie.html#outs"><i class="fa fa-check"></i><b>2.2</b> Identify exceptional and extreme values aka outliers.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="collocated-monitors-derek.html"><a href="collocated-monitors-derek.html"><i class="fa fa-check"></i><b>3</b> Collocated monitors (Derek)</a><ul>
<li class="chapter" data-level="3.1" data-path="collocated-monitors-derek.html"><a href="collocated-monitors-derek.html#evalpocs"><i class="fa fa-check"></i><b>3.1</b> Evaluate collocated air monitors (POCs)</a></li>
<li class="chapter" data-level="3.2" data-path="collocated-monitors-derek.html"><a href="collocated-monitors-derek.html#pripocs"><i class="fa fa-check"></i><b>3.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html"><i class="fa fa-check"></i><b>4</b> Detection limits (Kristie &amp; Cassie)</a><ul>
<li class="chapter" data-level="4.1" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#method-detection-limit---definition"><i class="fa fa-check"></i><b>4.1</b> Method Detection Limit - Definition</a></li>
<li class="chapter" data-level="4.2" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#procedure-for-calculating-method-detection-limits"><i class="fa fa-check"></i><b>4.2</b> Procedure for calculating method detection limits</a></li>
<li class="chapter" data-level="4.3" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#finding-detection-limits-cassie"><i class="fa fa-check"></i><b>4.3</b> Finding detection limits (Cassie)</a></li>
<li class="chapter" data-level="4.4" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>4.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="4.5" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#below-detection-values-kristie"><i class="fa fa-check"></i><b>4.5</b> Below detection values (Kristie)</a><ul>
<li class="chapter" data-level="" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#example-charts-for-visualizing-data-below-detection-limits"><i class="fa fa-check"></i>Example charts for visualizing data below detection limits</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="detection-limits-kristie-cassie.html"><a href="detection-limits-kristie-cassie.html#multiple-detection-limits"><i class="fa fa-check"></i><b>4.6</b> Multiple detection limits</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="completeness-checks-dorian-cassie.html"><a href="completeness-checks-dorian-cassie.html"><i class="fa fa-check"></i><b>5</b> Completeness checks (Dorian &amp; Cassie)</a><ul>
<li class="chapter" data-level="5.1" data-path="completeness-checks-dorian-cassie.html"><a href="completeness-checks-dorian-cassie.html#complete"><i class="fa fa-check"></i><b>5.1</b> Completeness checks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>6</b> Summary statistics</a><ul>
<li class="chapter" data-level="6.1" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>6.1</b> Bootstrapping (Dorian)</a></li>
<li class="chapter" data-level="6.2" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>6.2</b> Confidence intervals (Derek)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="site-comparisons-derek-cassie.html"><a href="site-comparisons-derek-cassie.html"><i class="fa fa-check"></i><b>7</b> Site comparisons (Derek &amp; Cassie)</a><ul>
<li class="chapter" data-level="7.1" data-path="site-comparisons-derek-cassie.html"><a href="site-comparisons-derek-cassie.html#confidence-intervals"><i class="fa fa-check"></i><b>7.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="7.2" data-path="site-comparisons-derek-cassie.html"><a href="site-comparisons-derek-cassie.html#correlation-matrices-cassie"><i class="fa fa-check"></i><b>7.2</b> Correlation matrices (Cassie)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>8</b> Charts</a><ul>
<li class="chapter" data-level="8.1" data-path="charts.html"><a href="charts.html#boxplots-dorian"><i class="fa fa-check"></i><b>8.1</b> Boxplots (Dorian)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="charts.html"><a href="charts.html#log-boxplot"><i class="fa fa-check"></i><b>8.1.1</b> Log boxplot</a></li>
<li class="chapter" data-level="8.1.2" data-path="charts.html"><a href="charts.html#outliers"><i class="fa fa-check"></i><b>8.1.2</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="charts.html"><a href="charts.html#calendar-plots-cassie"><i class="fa fa-check"></i><b>8.2</b> Calendar plots (Cassie)</a></li>
<li class="chapter" data-level="8.3" data-path="charts.html"><a href="charts.html#colors-dorian"><i class="fa fa-check"></i><b>8.3</b> Colors (Dorian)</a></li>
<li class="chapter" data-level="8.4" data-path="charts.html"><a href="charts.html#openair-package-derek-cassie"><i class="fa fa-check"></i><b>8.4</b> <em>openair</em> package (Derek &amp; Cassie)</a><ul>
<li class="chapter" data-level="8.4.1" data-path="charts.html"><a href="charts.html#pollution-roses-and-love-poems-derek"><i class="fa fa-check"></i><b>8.4.1</b> Pollution roses and love poems (Derek)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>9</b> Time series</a><ul>
<li class="chapter" data-level="9.1" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i><b>9.1</b> Seasonality</a></li>
<li class="chapter" data-level="9.2" data-path="time-series.html"><a href="time-series.html#changepoints-before-after-tests"><i class="fa fa-check"></i><b>9.2</b> Changepoints (before &amp; after tests)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="maps-kristie.html"><a href="maps-kristie.html"><i class="fa fa-check"></i><b>10</b> Maps (Kristie)</a><ul>
<li class="chapter" data-level="10.1" data-path="maps-kristie.html"><a href="maps-kristie.html#kriging"><i class="fa fa-check"></i><b>10.1</b> Kriging</a></li>
<li class="chapter" data-level="10.2" data-path="maps-kristie.html"><a href="maps-kristie.html#spatial-averaging-and-aggregation"><i class="fa fa-check"></i><b>10.2</b> Spatial averaging and aggregation</a></li>
<li class="chapter" data-level="10.3" data-path="maps-kristie.html"><a href="maps-kristie.html#creating-shapefiles-in-r-adn-joining-to-ej-areas"><i class="fa fa-check"></i><b>10.3</b> Creating shapefiles in R adn joining to EJ areas</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="additional-resources-kristie.html"><a href="additional-resources-kristie.html"><i class="fa fa-check"></i><b>11</b> Additional resources (Kristie)</a></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="charts" class="section level1">
<h1><span class="header-section-number"></span> Charts</h1>
<div id="boxplots-dorian" class="section level2">
<h2><span class="header-section-number">8.1</span> Boxplots (Dorian)</h2>
<p>Dividing by zero is an amazing super power. Unfortunately for you your computer does not have this power. Making a log boxplot with data containing zeros or negative values will result in your computer melting itself. It will never forgive you.</p>
<div id="log-boxplot" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Log boxplot</h3>
<p>Coming soon…</p>
</div>
<div id="outliers" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Outliers</h3>
<p>Coming soon…</p>
</div>
</div>
<div id="calendar-plots-cassie" class="section level2">
<h2><span class="header-section-number">8.2</span> Calendar plots (Cassie)</h2>
<p>We have created a nice plot.</p>
</div>
<div id="colors-dorian" class="section level2">
<h2><span class="header-section-number">8.3</span> Colors (Dorian)</h2>
<p>Please use Ghibli colors. See <a href="https://github.com/ewenme/ghibli">Ghibli</a>.</p>
<div class="figure">
<img src="https://github.com/ewenme/ghibli/raw/master/ghibli.jpg" alt="Ghibli colors" />
<p class="caption">Ghibli colors</p>
</div>
</div>
<div id="openair-package-derek-cassie" class="section level2">
<h2><span class="header-section-number">8.4</span> <em>openair</em> package (Derek &amp; Cassie)</h2>
<p>Coming soon…</p>

<div id="pollution-roses-and-love-poems-derek" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Pollution roses and love poems (Derek)</h3>
<p>Pollution roses are a visual display of pollutant concentrations and wind directions correspnding to those concentrations. The length of each “paddle” is correlated with the percentage of days of valid measurements taken when the wind was blowing from that direction. So if the longest paddle the one extending upward, then the wind blew from the North on average more times than any other direction for days with valid measurements of a pollutant. The colors on a paddle correspond to the concentration of the pollutant. Blue means lower concentrations up to red which are the highest concentrations.</p>
<p>Note that for 24-hour samples, wind direction is the vector averaged wind direction of each hour in a day.</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generates pollution roses for all air toxics for a site and saves them in a folder defined by output_path</span>


<span class="co">#Currently does not address POCs. Only use for single POC sites until fixed.</span>


<span class="co">#Currently only works for single site. Multi-site capability may be added in future.</span>


<span class="co">#------------------------------------------------------------------------------------------------</span>


<span class="co">#Enter all values between the dashed lines</span>


<span class="co"># Monitoring data must be a csv in ATDE format with columns &quot;AQS_ID&quot;, &quot;POC&quot;, &quot;Param_Code&quot;, &quot;Date&quot;,&quot;Concentration&quot;,</span>

<span class="co"># &quot;Null_Data_Code&quot;, &quot;MDL&quot;, &quot;Pollutant&quot;, &quot;Year&quot;, &quot;CAS&quot;</span>

<span class="co"># Date needs to be in yyyy-mm-dd format or yyyymmdd</span>


<span class="co">#met_data needs to be filtered to site of interest (pull from Tableau)</span>


monitoring_data_file =<span class="st"> &quot;.csv&quot;</span> <span class="co">#complete path of csv file with monitoring data USE FORWARD SLASHES /</span>

met_data_file =<span class="st"> &quot;.csv&quot;</span> <span class="co">#complete path of csv file with met data USE FORWARD SLASHES /</span>

output_path =<span class="st"> &quot;&quot;</span> <span class="co">#path to output folder USE FORWARD SLASHES /</span>

site_num =<span class="st"> </span><span class="dv">123456789</span> <span class="co"># site number: enter complete 9 digit AQS ID without dashes</span>

site_name =<span class="st"> &quot;&quot;</span> <span class="co">#Enter site name in quotes as you want it to appear on the title of roses use \n for new line</span>

png_height =<span class="st"> </span><span class="dv">600</span> <span class="co">#Image height</span>

png_width =<span class="st"> </span><span class="dv">600</span> <span class="co">#Image width</span>

num_breaks =<span class="st"> </span><span class="dv">5</span> <span class="co">#number of colors desired on pollution rose. Breaks are minimum to MDL, then (num_breaks - 1) evenly spaced intervals from MDL to maximum value for pollutant.</span>


<span class="co">#-------------------------------------------------------------------------------------------------</span>


<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(openair)
<span class="kw">library</span>(reshape)


site_save =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;[.]&quot;</span>, <span class="st">&quot;&quot;</span>, site_name)

site_save =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>, site_save)

site_save =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;/&quot;</span>, <span class="st">&quot;-&quot;</span>, site_save)


data =<span class="st"> </span><span class="kw">read.csv</span>(monitoring_data_file, <span class="dt">stringsAsFactors =</span> F)

<span class="kw">names</span>(data)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AQS_ID&quot;</span>, <span class="st">&quot;POC&quot;</span>, <span class="st">&quot;Param_Code&quot;</span>, <span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Concentration&quot;</span>, <span class="st">&quot;Null_Data_Code&quot;</span>, <span class="st">&quot;MDL&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;CAS&quot;</span>)

data<span class="op">$</span>date =<span class="st"> </span><span class="kw">ymd</span>(data<span class="op">$</span>Date)

data<span class="op">$</span>Pollutant =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;/&quot;</span>, <span class="st">&quot;-&quot;</span>, data<span class="op">$</span>Pollutant) <span class="co">#R confuses forward slashes for file paths when naming pngs</span>

met_data =<span class="st"> </span><span class="kw">read.csv</span>(met_data_file)

data_site =<span class="st"> </span><span class="kw">filter</span>(data, AQS_ID <span class="op">%in%</span><span class="st"> </span>site_num <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(Concentration) )

data_site =<span class="st"> </span>data_site <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Pollutant) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">max</span>(Concentration) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.001</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">max</span>(Concentration) <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(MDL))

pollutants_site =<span class="st"> </span>data_site <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Pollutant) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">MDL =</span> <span class="kw">max</span>(MDL), <span class="dt">minimum =</span> <span class="kw">min</span>(Concentration), <span class="dt">maximum =</span> <span class="kw">max</span>(Concentration))

data_site =<span class="st"> </span><span class="kw">select</span>(data_site, date, Pollutant, Concentration)

breaks_site =<span class="st"> </span><span class="ot">NULL</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(pollutants_site)) {

breaks_site =<span class="st"> </span><span class="kw">rbind</span>(breaks_site, <span class="kw">c</span>(<span class="kw">round_any</span>(pollutants_site<span class="op">$</span>minimum[i], <span class="fl">0.001</span>, floor), <span class="kw">round_any</span>(
<span class="kw">c</span>(pollutants_site<span class="op">$</span>MDL[i], pollutants_site<span class="op">$</span>MDL[i] <span class="op">+</span><span class="st"> </span>(pollutants_site<span class="op">$</span>maximum[i]
<span class="op">-</span><span class="st"> </span>pollutants_site<span class="op">$</span>MDL[i]) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>(num_breaks<span class="op">-</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(num_breaks<span class="op">-</span><span class="dv">1</span>) ) ), <span class="fl">0.001</span>,
ceiling ) ) )

}

data_site =<span class="st"> </span><span class="kw">spread</span>(data_site, <span class="dt">key =</span> Pollutant, <span class="dt">value =</span> Concentration)

<span class="kw">names</span>(met_data)[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">8</span>)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Day&quot;</span>,<span class="st">&quot;wd&quot;</span>,<span class="st">&quot;ws&quot;</span>)

met_data =<span class="st"> </span><span class="kw">mutate</span>(met_data, <span class="dt">date =</span> <span class="kw">paste0</span>(Year,<span class="st">&quot;/&quot;</span>,Month,<span class="st">&quot;/&quot;</span>,Day,<span class="st">&quot;&quot;</span>,Hour,<span class="st">&quot;:00&quot;</span>))

met_data<span class="op">$</span>date =<span class="st"> </span><span class="kw">ymd_hm</span>(met_data<span class="op">$</span>date)

met_data =<span class="st"> </span>met_data[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">9</span><span class="op">:</span><span class="dv">11</span>)]

met_data =<span class="st"> </span><span class="kw">timeAverage</span>(met_data, <span class="dt">avg.time =</span> <span class="st">&quot;day&quot;</span>)

met_data<span class="op">$</span>date =<span class="st"> </span><span class="kw">ymd</span>(met_data<span class="op">$</span>date)

data_site =<span class="st"> </span><span class="kw">left_join</span>(data_site, met_data, <span class="dt">by =</span> <span class="st">&quot;date&quot;</span>)

<span class="kw">png</span>(<span class="kw">paste0</span>(output_path,<span class="st">&quot;/Wind Rose for &quot;</span>, site_save,<span class="st">&quot;.png&quot;</span>), <span class="dt">height =</span> png_height, <span class="dt">width=</span>png_width)

<span class="kw">windRose</span>(data_site, <span class="dt">paddle =</span> F, <span class="dt">breaks =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">key.footer =</span> <span class="st">&quot;mph&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Daily Average Wind Rose </span><span class="ch">\n</span><span class="st">&quot;</span>, site_name) )

<span class="kw">dev.off</span>()

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(pollutants_site)) {

  <span class="kw">png</span>(<span class="kw">paste0</span>(output_path,<span class="st">&quot;/Pollution Rose for &quot;</span>, pollutants_site<span class="op">$</span>Pollutant[i],<span class="st">&quot; &quot;</span>, eight), <span class="dt">width=</span>png_width)
  
  <span class="kw">pollutionRose</span>(data_site, <span class="dt">statistic =</span> <span class="st">&quot;abs.count&quot;</span>, <span class="dt">pollutant =</span> pollutants_site<span class="op">$</span>Pollutant[i], <span class="dt">breaks =</span> breaks_site[i,], <span class="dt">key.footer=</span><span class="st">&quot;ug/m3&quot;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Daily Average Pollution Rose for&quot;</span>, pollutants_site<span class="op">$</span>Pollutant[i],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, site_name) )
  
  <span class="kw">dev.off</span>()

}

## ?? site_save,&quot;.png&quot;), height=png_h</code></pre></div>

</div>
</div>
</div>
<script>
  $(".toggle").click(function() {
    $(this).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="site-comparisons-derek-cassie.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/60-charts.Rmd",
"text": "Edit"
},
"download": ["air-methods.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
