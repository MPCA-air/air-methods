<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.5.2 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="summary-methods.html">
<link rel="next" href="site-comparisons.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.3/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>1</b> Best practices</a><ul>
<li class="chapter" data-level="1.1" data-path="best-practices.html"><a href="best-practices.html#tidyverse"><i class="fa fa-check"></i><b>1.1</b> Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="best-practices.html"><a href="best-practices.html#pollutant-names"><i class="fa fa-check"></i><b>1.2</b> Pollutant names</a></li>
<li class="chapter" data-level="1.3" data-path="best-practices.html"><a href="best-practices.html#keeping-r-up-to-date"><i class="fa fa-check"></i><b>1.3</b> Keeping R up-to-date</a></li>
<li class="chapter" data-level="1.4" data-path="best-practices.html"><a href="best-practices.html#script-layout"><i class="fa fa-check"></i><b>1.4</b> Script layout</a></li>
<li class="chapter" data-level="1.5" data-path="best-practices.html"><a href="best-practices.html#divide-and-conquer"><i class="fa fa-check"></i><b>1.5</b> Divide and conquer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-data.html"><a href="getting-data.html"><i class="fa fa-check"></i><b>2</b> Getting data</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-data.html"><a href="getting-data.html#air-monitoring"><i class="fa fa-check"></i><b>2.1</b> Air monitoring</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-data.html"><a href="getting-data.html#AQS"><i class="fa fa-check"></i><b>2.1.1</b> Retrieving data from AQS</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-data.html"><a href="getting-data.html#rqamd"><i class="fa fa-check"></i><b>2.1.2</b> Retrieving data from AQS DataMart</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-data.html"><a href="getting-data.html#aqi-now"><i class="fa fa-check"></i><b>2.1.3</b> Current AQI observations</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-data.html"><a href="getting-data.html#monitors"><i class="fa fa-check"></i><b>2.1.4</b> Active AQI monitors</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-data.html"><a href="getting-data.html#lims"><i class="fa fa-check"></i><b>2.1.5</b> Retrieving data from LIMS via Tableau</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-data.html"><a href="getting-data.html#AirVision"><i class="fa fa-check"></i><b>2.1.6</b> Retrieving continuous data from AirVision</a></li>
<li class="chapter" data-level="2.1.7" data-path="getting-data.html"><a href="getting-data.html#wair"><i class="fa fa-check"></i><b>2.1.7</b> Retrieving data from MPCA WAIR database</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-data.html"><a href="getting-data.html#health-and-standards"><i class="fa fa-check"></i><b>2.2</b> Health and standards</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-data.html"><a href="getting-data.html#IHBs"><i class="fa fa-check"></i><b>2.2.1</b> Inhalation health benchmarks</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-data.html"><a href="getting-data.html#NAAQS"><i class="fa fa-check"></i><b>2.2.2</b> Air Quality Standards (NAAQs and MAAQS)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-data.html"><a href="getting-data.html#air-modeling"><i class="fa fa-check"></i><b>2.3</b> Air modeling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-data.html"><a href="getting-data.html#nata"><i class="fa fa-check"></i><b>2.3.1</b> NATA modeling</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-data.html"><a href="getting-data.html#mnrisks"><i class="fa fa-check"></i><b>2.3.2</b> MNRISKS statewide risk modeling</a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-data.html"><a href="getting-data.html#downscale"><i class="fa fa-check"></i><b>2.3.3</b> Downscaler modeling results for Ozone and PM2.5</a></li>
<li class="chapter" data-level="2.3.4" data-path="getting-data.html"><a href="getting-data.html#cmaq"><i class="fa fa-check"></i><b>2.3.4</b> CMAQ Ozone modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-data.html"><a href="getting-data.html#context"><i class="fa fa-check"></i><b>2.4</b> Context</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-data.html"><a href="getting-data.html#mn-ei"><i class="fa fa-check"></i><b>2.4.1</b> MN Emissions Inventory</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-data.html"><a href="getting-data.html#nei"><i class="fa fa-check"></i><b>2.4.2</b> EPA’s NEI</a></li>
<li class="chapter" data-level="2.4.3" data-path="getting-data.html"><a href="getting-data.html#fac-coords"><i class="fa fa-check"></i><b>2.4.3</b> Facility locations</a></li>
<li class="chapter" data-level="2.4.4" data-path="getting-data.html"><a href="getting-data.html#wx-obs"><i class="fa fa-check"></i><b>2.4.4</b> Weather observations</a></li>
<li class="chapter" data-level="2.4.5" data-path="getting-data.html"><a href="getting-data.html#hysplit"><i class="fa fa-check"></i><b>2.4.5</b> HYSPLIT wind trajectories</a></li>
<li class="chapter" data-level="2.4.6" data-path="getting-data.html"><a href="getting-data.html#landuse"><i class="fa fa-check"></i><b>2.4.6</b> Land use maps</a></li>
<li class="chapter" data-level="2.4.7" data-path="getting-data.html"><a href="getting-data.html#census"><i class="fa fa-check"></i><b>2.4.7</b> United States Census boundaries</a></li>
<li class="chapter" data-level="2.4.8" data-path="getting-data.html"><a href="getting-data.html#acs"><i class="fa fa-check"></i><b>2.4.8</b> American Community Survey (ACS)</a></li>
</ul></li>
</ul></li>
<li><a href="quality-assurance-methods.html#quality-assurance-methods"><strong>Quality assurance methods</strong></a></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#missing"><i class="fa fa-check"></i><b>3.1</b> Remove blank, NULL, and missing values</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#quals"><i class="fa fa-check"></i><b>3.2</b> Remove <em>Qualified</em> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#leaks"><i class="fa fa-check"></i><b>3.3</b> Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="3.4" data-path="data-cleaning.html"><a href="data-cleaning.html#outs"><i class="fa fa-check"></i><b>3.4</b> Exceptional values and outliers</a></li>
<li class="chapter" data-level="3.5" data-path="data-cleaning.html"><a href="data-cleaning.html#sticky2"><i class="fa fa-check"></i><b>3.5</b> Sequential repeats and “sticky” numbers</a></li>
<li class="chapter" data-level="3.6" data-path="data-cleaning.html"><a href="data-cleaning.html#unique"><i class="fa fa-check"></i><b>3.6</b> Unique detected values</a></li>
<li class="chapter" data-level="3.7" data-path="data-cleaning.html"><a href="data-cleaning.html#valid_ref"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collocated-monitors.html"><a href="collocated-monitors.html"><i class="fa fa-check"></i><b>4</b> Collocated monitors</a><ul>
<li class="chapter" data-level="4.1" data-path="collocated-monitors.html"><a href="collocated-monitors.html#evalpocs"><i class="fa fa-check"></i><b>4.1</b> Evaluate collocated air monitors</a></li>
<li class="chapter" data-level="4.2" data-path="collocated-monitors.html"><a href="collocated-monitors.html#pripocs"><i class="fa fa-check"></i><b>4.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="detection-limits.html"><a href="detection-limits.html"><i class="fa fa-check"></i><b>5</b> Detection limits</a><ul>
<li class="chapter" data-level="5.1" data-path="detection-limits.html"><a href="detection-limits.html#method-detection-limit"><i class="fa fa-check"></i><b>5.1</b> Method Detection Limit</a></li>
<li class="chapter" data-level="5.2" data-path="detection-limits.html"><a href="detection-limits.html#procedure-for-calculating-method-detection-limits"><i class="fa fa-check"></i><b>5.2</b> Procedure for calculating method detection limits</a></li>
<li class="chapter" data-level="5.3" data-path="detection-limits.html"><a href="detection-limits.html#finding-detection-limits"><i class="fa fa-check"></i><b>5.3</b> Finding detection limits</a></li>
<li class="chapter" data-level="5.4" data-path="detection-limits.html"><a href="detection-limits.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>5.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="5.5" data-path="detection-limits.html"><a href="detection-limits.html#estimating-below-detection-values-what-not-to-do"><i class="fa fa-check"></i><b>5.5</b> Estimating below detection values <em>(what not to do)</em></a></li>
<li class="chapter" data-level="5.6" data-path="detection-limits.html"><a href="detection-limits.html#below-detection-values"><i class="fa fa-check"></i><b>5.6</b> Below detection values</a></li>
<li class="chapter" data-level="5.7" data-path="detection-limits.html"><a href="detection-limits.html#multiple-detection-limits"><i class="fa fa-check"></i><b>5.7</b> Multiple detection limits</a></li>
<li class="chapter" data-level="5.8" data-path="detection-limits.html"><a href="detection-limits.html#references"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="completeness-checks.html"><a href="completeness-checks.html"><i class="fa fa-check"></i><b>6</b> Completeness checks</a><ul>
<li class="chapter" data-level="6.1" data-path="completeness-checks.html"><a href="completeness-checks.html#complete"><i class="fa fa-check"></i><b>6.1</b> Completeness checks</a></li>
</ul></li>
<li><a href="summary-methods.html#summary-methods"><strong>Summary methods</strong></a></li>
<li class="chapter" data-level="7" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>7</b> Summary statistics</a><ul>
<li class="chapter" data-level="7.1" data-path="summary-statistics.html"><a href="summary-statistics.html#test-for-normality"><i class="fa fa-check"></i><b>7.1</b> Test for normality</a></li>
<li class="chapter" data-level="7.2" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>7.2</b> Bootstrapping</a></li>
<li class="chapter" data-level="7.3" data-path="summary-statistics.html"><a href="summary-statistics.html#below"><i class="fa fa-check"></i><b>7.3</b> Below the detection limit</a></li>
<li class="chapter" data-level="7.4" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>7.4</b> Upper confidence limits (UCLs)</a></li>
<li class="chapter" data-level="7.5" data-path="summary-statistics.html"><a href="summary-statistics.html#incomplete"><i class="fa fa-check"></i><b>7.5</b> Annual summaries for incomplete data</a></li>
<li class="chapter" data-level="7.6" data-path="summary-statistics.html"><a href="summary-statistics.html#health"><i class="fa fa-check"></i><b>7.6</b> Comparison of data to inhalation health benchmarks</a></li>
<li class="chapter" data-level="7.7" data-path="summary-statistics.html"><a href="summary-statistics.html#roll365"><i class="fa fa-check"></i><b>7.7</b> Rolling 365 day summaries</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="site-comparisons.html"><a href="site-comparisons.html"><i class="fa fa-check"></i><b>8</b> Site comparisons</a><ul>
<li class="chapter" data-level="8.1" data-path="site-comparisons.html"><a href="site-comparisons.html#confidence-intervals"><i class="fa fa-check"></i><b>8.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.2" data-path="site-comparisons.html"><a href="site-comparisons.html#tools-to-visualize-data"><i class="fa fa-check"></i><b>8.2</b> Tools to visualize data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="site-comparisons.html"><a href="site-comparisons.html#beeswarm-plots"><i class="fa fa-check"></i><b>8.2.1</b> Beeswarm Plots</a></li>
<li class="chapter" data-level="8.2.2" data-path="site-comparisons.html"><a href="site-comparisons.html#correlation-matrices"><i class="fa fa-check"></i><b>8.2.2</b> Correlation matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="start-finish.html"><a href="start-finish.html"><i class="fa fa-check"></i><b>9</b> Start to finish</a><ul>
<li class="chapter" data-level="9.1" data-path="start-finish.html"><a href="start-finish.html#functions"><i class="fa fa-check"></i><b>9.1</b> Functions</a></li>
<li class="chapter" data-level="9.2" data-path="start-finish.html"><a href="start-finish.html#analysis-steps"><i class="fa fa-check"></i><b>9.2</b> Analysis steps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>10</b> Charts</a><ul>
<li class="chapter" data-level="10.1" data-path="charts.html"><a href="charts.html#boxplots"><i class="fa fa-check"></i><b>10.1</b> Boxplots</a><ul>
<li class="chapter" data-level="10.1.1" data-path="charts.html"><a href="charts.html#log-boxplots"><i class="fa fa-check"></i><b>10.1.1</b> Log boxplots</a></li>
<li class="chapter" data-level="10.1.2" data-path="charts.html"><a href="charts.html#outliers"><i class="fa fa-check"></i><b>10.1.2</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="charts.html"><a href="charts.html#calendar-plots"><i class="fa fa-check"></i><b>10.2</b> Calendar plots</a></li>
<li class="chapter" data-level="10.3" data-path="charts.html"><a href="charts.html#color-palettes"><i class="fa fa-check"></i><b>10.3</b> Color palettes</a></li>
<li class="chapter" data-level="10.4" data-path="charts.html"><a href="charts.html#pollution-roses"><i class="fa fa-check"></i><b>10.4</b> Pollution roses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>11</b> Time series</a><ul>
<li class="chapter" data-level="11.1" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i><b>11.1</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>12</b> Maps</a><ul>
<li class="chapter" data-level="12.1" data-path="maps.html"><a href="maps.html#creating-shapefiles-in-r-and-joining-to-ej-areas"><i class="fa fa-check"></i><b>12.1</b> Creating shapefiles in R and joining to EJ areas</a></li>
<li class="chapter" data-level="12.2" data-path="maps.html"><a href="maps.html#spatial-averaging-and-aggregation"><i class="fa fa-check"></i><b>12.2</b> Spatial averaging and aggregation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>13</b> Additional resources</a></li>
<li><a href="mpca-data-tools.html#mpca-data-tools"><strong>MPCA data tools</strong></a></li>
<li class="chapter" data-level="14" data-path="aqi-explorer.html"><a href="aqi-explorer.html"><i class="fa fa-check"></i><b>14</b> AQI explorer</a></li>
<li class="chapter" data-level="15" data-path="criteria-pollutant-explorer.html"><a href="criteria-pollutant-explorer.html"><i class="fa fa-check"></i><b>15</b> Criteria pollutant explorer</a></li>
<li class="chapter" data-level="16" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html"><i class="fa fa-check"></i><b>16</b> Air toxics explorer</a><ul>
<li class="chapter" data-level="16.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#mpca-air-toxics-methods"><i class="fa fa-check"></i><b>16.1</b> MPCA Air Toxics Methods</a><ul>
<li class="chapter" data-level="16.1.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-cleaning-1"><i class="fa fa-check"></i><b>16.1.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="16.1.2" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-validation-1"><i class="fa fa-check"></i><b>16.1.2</b> Data Validation</a></li>
<li class="chapter" data-level="16.1.3" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#parameter-occurrence-codes-pocs"><i class="fa fa-check"></i><b>16.1.3</b> Parameter Occurrence Codes (POCs)</a></li>
<li class="chapter" data-level="16.1.4" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#producing-annual-summaries"><i class="fa fa-check"></i><b>16.1.4</b> Producing Annual Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summary-statistics" class="section level1">
<h1><span class="header-section-number"></span> Summary statistics</h1>
<p><img src="https://d21ii91i3y6o6h.cloudfront.net/gallery_images/from_proof/12936/large/1464301097/number-rcatladies.png" width="40%" style="display: block; margin: auto;" /></p>
<p>The summary methods described in this chapter inlcude:</p>
<p><a href="summary-statistics.html#boots">7.2</a> <strong>Bootstrapping</strong><br />
<a href="summary-statistics.html#below">7.3</a> <strong>Below the detection limit</strong><br />
<a href="summary-statistics.html#confidence">7.4</a> <strong>Confidence intervals</strong><br />
<a href="summary-statistics.html#incomplete">7.5</a> <strong>Annual summaries for incomplete data</strong><br />
<a href="summary-statistics.html#health">7.6</a> <strong>Comparison of data to inhalation health benchmarks</strong><br />
<a href="summary-statistics.html#roll365">7.7</a> <strong>Rolling 365 day summaries</strong></p>
<p><br></p>
<div id="test-for-normality" class="section level2">
<h2><span class="header-section-number">7.1</span> Test for normality</h2>
<p>Data should be tested for normality prior to determining the type of summary statistic to report. In general environmental data are non-normal and contain with many low values and a few high values. This causes the mean of the data to be higher than the median (right skewed). Many normality tests exist and they vary in sensitivity. A good article on normality tests can be found at this link: (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3693611/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3693611/</a>)</p>
<p>The normality test in the example script below is a recommended test for data of sample size between 5-5000 and will allow missing values. A Shapiro-Wilk test may also be performed for the typical sample size of a year of air toxics results. The script below includes a a line to switch to a Shapiro Wilk test.</p>
<p><br></p>
<p>Click the button below to view code to perform normality test.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stats)
<span class="kw">library</span>(nortest)

data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)

<span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;poc&quot;</span>, <span class="st">&quot;param_code&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;null_code&quot;</span>, <span class="st">&quot;md_limit&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cas&quot;</span>)

data_normresults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">site_name=</span><span class="kw">character</span>(),
                               <span class="dt">analyte=</span><span class="kw">character</span>(),
                               <span class="dt">year=</span><span class="kw">character</span>(),
                                 <span class="dt">w_value=</span><span class="kw">numeric</span>(), 
                                 <span class="dt">p_value=</span><span class="kw">numeric</span>(), 
                                 <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>) 
sites &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>aqs_id)
analytes &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>pollutant)
years &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>year)

<span class="cf">for</span>(i <span class="cf">in</span> sites[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]){
  <span class="cf">for</span>(j <span class="cf">in</span> analytes){
    <span class="cf">for</span>(k <span class="cf">in</span> years){
      
  data_sub =<span class="st"> </span><span class="kw">filter</span>(data , aqs_id <span class="op">==</span><span class="st"> </span>i, pollutant <span class="op">==</span><span class="st"> </span>j, year <span class="op">==</span>k)
  
  <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">unique</span>(data_sub<span class="op">$</span>conc)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>) {
    
    norm_test &lt;-<span class="st"> </span><span class="kw">sf.test</span>(data_sub<span class="op">$</span>conc)
    <span class="co">#norm_test &lt;- shapiro.test(data_sub$conc)</span>
    
    <span class="kw">print</span>(i)
    
    <span class="kw">print</span>(norm_test)
    
    values &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">site_name =</span> i, <span class="dt">analyte=</span>j, <span class="dt">year=</span>k, <span class="dt">w_value =</span> <span class="kw">round</span>(norm_test<span class="op">$</span>statistic, <span class="dt">digits =</span> <span class="dv">2</span>), <span class="dt">p_value =</span> <span class="kw">round</span>(norm_test<span class="op">$</span>p.value, <span class="dt">digits =</span> <span class="dv">2</span>))
    
    data_normresults &lt;-<span class="st"> </span><span class="kw">rbind</span>(values, data_normresults)
    }
  }
  }
}


DT<span class="op">::</span><span class="kw">datatable</span>(<span class="kw">head</span>(data_normresults), <span class="dt">options =</span> dt_options)</code></pre></div>
</div>
<p><br></p>
<p>We also suggest visualizing the data to determine if normality may be a valid assumption. The script below is an example of visual normality tests and includes an explanation of their interpretation. In the Q-Q Plot, normal data will form a straight line with the theoretical distribution quantiles with little deviation from the line. This is a visual test and somewhat subjective. Normal data form histograms that produce a bell shaped curve.</p>
<p>This web tool will allow visual inspection of air toxics data by year, site and pollutants - <a href="https://mpca-pahs.shinyapps.io/NormViz/" class="uri">https://mpca-pahs.shinyapps.io/NormViz/</a>.</p>
<p><br></p>
<p>Click the button below to view the code for the shiny tool above.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
</div>
<p><br></p>
<p>When to use a arithmetic or geometric mean:</p>
<ul>
<li>Use an arithmetic mean when your data are normal and there are less than 5% below detection limit values per year/analyte/site [Kristie made up the 5%, but there is an EPA document looking at the impacts of BDL data. Will cite and incorporate.].</li>
<li>For non-automated scripts: Use a geometric mean if your data are log-normally distributed and there are less than 5% below detection limit values per year/analyte/site.</li>
</ul>
</div>
<div id="boots" class="section level2">
<h2><span class="header-section-number">7.2</span> Bootstrapping</h2>
<p>Bootstrapping provides methods for calculating summary statistics without making assumptions about the distribution from which the data is sampled.</p>
<p>Click the button below to view the bootstrapping code.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><strong>Packages</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(readr)</code></pre></div>
Our data is organized by monitoring site and date. Here’s a sample.
<table>
<thead>
<tr>
<th style="text-align:right;">
AQS_ID
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Conc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-07-30
</td>
<td style="text-align:right;">
0.00148
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-09-30
</td>
<td style="text-align:right;">
0.00064
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-11-30
</td>
<td style="text-align:right;">
0.34256
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-12-30
</td>
<td style="text-align:right;">
0.00064
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-03-30
</td>
<td style="text-align:right;">
0.26219
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-07-30
</td>
<td style="text-align:right;">
0.01113
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-09-30
</td>
<td style="text-align:right;">
0.00044
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-11-30
</td>
<td style="text-align:right;">
0.00127
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-12-30
</td>
<td style="text-align:right;">
0.00113
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Bootstrap function</strong></p>
<p>We currently use the <code>EnvStats</code> package to generate our summary values. It has built in functions to account for non-detect data and allows for different distributions. However, if you’re not dealing with non-detects you can use a simple loop to boot things yourself.</p>
<p>Before you start you’ll want to set the random number generator to ensure you’ll be able to reproduce your results. I’ll use <code>#27</code> below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">27</span>)</code></pre></div>
<p>The general idea is to take a random sample with replacement from the data set, generate the statistic that you’re interested in, record it, then rinse and repeat. Below is the code for how to resample a single site.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Filter data to a single site</span>
df_site1 &lt;-<span class="st"> </span><span class="kw">filter</span>(df, AQS_ID <span class="op">==</span><span class="st"> </span>AQS_ID[<span class="dv">1</span>])

<span class="co"># Pull random sample</span>
<span class="co"># `replace=T` allows for the same value to be pulled multiple times</span>
<span class="co"># `size=nrow(df)` ensures the number of observations in the new table to match the original </span>
random_df &lt;-<span class="st"> </span><span class="kw">sample</span>(df_site1<span class="op">$</span>Conc, <span class="dt">replace =</span> T)

<span class="co"># Generate summary statistic</span>
<span class="kw">quantile</span>(random_df, <span class="fl">0.1</span>)</code></pre></div>
<pre><code>##     10% 
## 0.00064</code></pre>
<p>To repeat this 3,000 times we can wrap these steps into a <code>resample</code> function, and then use <code>sapply</code> to collect the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create  resample function</span>
resample_Conc &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> df_site1<span class="op">$</span>Conc, <span class="dt">Conc_pct =</span> <span class="fl">0.10</span>){

random_df &lt;-<span class="st"> </span><span class="kw">sample</span>(data, <span class="dt">replace =</span> T)

<span class="kw">quantile</span>(random_df, Conc_pct, <span class="dt">na.rm=</span>T)[[<span class="dv">1</span>]]

}

<span class="co"># Repeat using `sapply`</span>
repeats &lt;-<span class="st"> </span><span class="dv">3000</span>

booted_10pct &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>repeats, <span class="dt">FUN=</span><span class="cf">function</span>(x) <span class="kw">resample_Conc</span>(df_site1<span class="op">$</span>Conc))

<span class="co"># The 50th percentile or median Conc</span>
<span class="kw">median</span>(booted_10pct, <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>## [1] 0.00064</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Return the 95th percentile of the booted concentrations</span>
<span class="kw">quantile</span>(booted_10pct, <span class="fl">0.95</span>, <span class="dt">na.rm=</span>T)[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## [1] 0.00148</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Force the 95th percentile to be a recorded value</span>
<span class="kw">sort</span>(booted_10pct)[repeats<span class="op">*</span>.<span class="dv">95</span> <span class="op">+</span><span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] 0.00148</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Upper and lower confidence interval around the median</span>
<span class="kw">quantile</span>(booted_10pct, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>), <span class="dt">na.rm=</span>T)</code></pre></div>
<pre><code>##     2.5%      50%    97.5% 
## 0.000640 0.000640 0.103216</code></pre>
<p><strong>Automate</strong></p>
<p>To finish, put these steps into a <code>boot</code> function and run it on each site by using <code>group_by</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create boot function</span>
boot_low_Conc &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data=</span>df<span class="op">$</span>Conc, <span class="dt">Conc_pct=</span><span class="fl">0.10</span>, <span class="dt">conf_int=</span><span class="fl">0.95</span>, <span class="dt">repeats=</span><span class="dv">3000</span>){

alpha &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>conf_int)<span class="op">/</span><span class="dv">2</span>

booted_10pct &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>repeats, <span class="dt">FUN=</span><span class="cf">function</span>(x) <span class="kw">resample_Conc</span>(data, Conc_pct))

<span class="co"># Upper and lower confidence interval around the median</span>
<span class="kw">list</span>(<span class="kw">quantile</span>(booted_10pct, <span class="kw">c</span>(alpha, <span class="fl">0.5</span>, <span class="dv">1</span><span class="op">-</span>alpha), <span class="dt">na.rm=</span>T))

}

<span class="co"># Use `group_by` to send data for each site to your boot function</span>
conc_summary &lt;-<span class="st"> </span><span class="kw">group_by</span>(df, AQS_ID) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">mutate</span>(<span class="dt">boot_results   =</span> <span class="kw">boot_low_Conc</span>(Conc, <span class="dt">Conc_pct=</span><span class="fl">0.10</span>, <span class="dt">conf_int=</span><span class="fl">0.95</span>)) <span class="op">%&gt;%</span>
<span class="st">                </span><span class="kw">summarize</span>(<span class="dt">Conc_10pct  =</span>  <span class="kw">quantile</span>(Conc, <span class="fl">0.10</span>, <span class="dt">na.rm=</span>T)[[<span class="dv">1</span>]],
                <span class="dt">Low_CL95_conc         =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">1</span>]], 
                <span class="dt">Boot_conc             =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">2</span>]], 
                <span class="dt">Upper_CL95_conc       =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">3</span>]])  </code></pre></div>
<p><strong>Results</strong></p>
<p>The booted confidence limits:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
AQS_ID
</th>
<th style="text-align:right;">
Conc_10pct
</th>
<th style="text-align:right;">
Low_CL95_conc
</th>
<th style="text-align:right;">
Boot_conc
</th>
<th style="text-align:right;">
Upper_CL95_conc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:right;">
0.000640
</td>
<td style="text-align:right;">
0.00064
</td>
<td style="text-align:right;">
0.000640
</td>
<td style="text-align:right;">
0.103216
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:right;">
0.000716
</td>
<td style="text-align:right;">
0.00044
</td>
<td style="text-align:right;">
0.000716
</td>
<td style="text-align:right;">
0.005214
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="below" class="section level2">
<h2><span class="header-section-number">7.3</span> Below the detection limit</h2>
<p>The annual mean or upper confidence limit is reported as below the detection limit when either of the following conditions is true:</p>
<ul>
<li>The number of censored values is greater than 80%.
<ul>
<li>This is based on <em>Cox 2006</em> and MPCA simulations (cite work and results)[www.google.com].</li>
</ul></li>
<li>The annual mean or 95% upper confidence limit is below the method detection limit.</li>
</ul>
</div>
<div id="confidence" class="section level2">
<h2><span class="header-section-number">7.4</span> Upper confidence limits (UCLs)</h2>
<p>If data is not normal, use bootstraping to generate means for each site. The 95% upper confidence limit is the 95th percentile of means generated using bootstrap sampling.</p>
<p>The script below uses bootstrap sampling to generate 1000 means for each site, pollutant, and year and then calculates the 95% UCL by taking the 95th percentile of those means. Values below the MDL are estimated using lognormal MLE estimation for each bootstrap sample. The 95% UCL is not calculated for any site, pollutant, and year which fails to meet completeness requirements and/or minimum detection requirements.</p>
<p>Click the button below to view the code for calculating <em>UCLs</em>.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
</div>
</div>
<div id="incomplete" class="section level2">
<h2><span class="header-section-number">7.5</span> Annual summaries for incomplete data</h2>
<p>There may be situations when a monitoring site does not meet the 75 percent completeness requirement in each quarter of a year, but annual summary statistics are still necessary. In this case, calculate annual summary statistics as usual but note that the site did not meet completeness requirements. The minimum threshold of valid samples required for reporting any annual summary statistics at all is up to the judgement of data analysis staff.</p>
</div>
<div id="health" class="section level2">
<h2><span class="header-section-number">7.6</span> Comparison of data to inhalation health benchmarks</h2>
<p>Chronic Inhalation Health Benchmarks - The annual 95% upper confidence limit is compared to chronic inhalation health benchmarks which are chosen based on the MPCA/MDH hierarchy for inhalation health benchmarks information sources.These risk results are summarized differently for annual measured data reports (The Air Toxics Data Explorer) or if the comparison is used in a cumulative analysis (cumulative AERA) to inform air permitting or environmental review. Acute Inhalation Health Benchmarks - The 2nd highest annual value multiplied by ten is compared to acute inhalation health benchmarks. This adjustment of the 24 hour integrated value approximates an hourly maximum, since acute inhalation health benchmarks are developed to be protective for high short-term exposures (about an hour).</p>
<p>Summarization of risk estimates for a cumulative Air Emission Risk Analaysis - Risk estimates are summed across pollutants thereby applying the concept of additivity. Since not all pollutants are measured at each monitoring site, means of sites are estimated based on population density since we asumme that pollution sources are greater near greater numbers of people. Means are calculated for mid-density sites, and rural sites. Facilities within urban areas are provided risk estimates at the closest or most representative monitor with all pollutants measured. This is described in the cumulative AERA section in the <a href="https://www.pca.state.mn.us/air/aera-guide">AERA guidance</a>. Cumulative AERAs use the mean cumulative risk estimates for the most recent three years of monitored data.</p>
</div>
<div id="roll365" class="section level2">
<h2><span class="header-section-number">7.7</span> Rolling 365 day summaries</h2>
<p><em>Coming soon…</em></p>

</div>
</div>
<script>
  $(".btn_code").click(function() {
    $(this.parentNode).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="summary-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="site-comparisons.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/07-summary_statistics.Rmd",
"text": "Edit"
},
"download": ["air-methods.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
