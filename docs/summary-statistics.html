<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> Summary statistics | air-methods.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content=" Summary statistics | air-methods.utf8" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" Summary statistics | air-methods.utf8" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />

<meta name="author" content="" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="summary-methods.html"/>
<link rel="next" href="site-comparisons.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>1</b> Best practices</a><ul>
<li class="chapter" data-level="1.1" data-path="best-practices.html"><a href="best-practices.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>1.1</b> Welcome to the Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="best-practices.html"><a href="best-practices.html#keep-r-updated"><i class="fa fa-check"></i><b>1.2</b> Keep R updated</a></li>
<li class="chapter" data-level="1.3" data-path="best-practices.html"><a href="best-practices.html#script-organization"><i class="fa fa-check"></i><b>1.3</b> Script organization</a></li>
<li class="chapter" data-level="1.4" data-path="best-practices.html"><a href="best-practices.html#divide-and-conquer"><i class="fa fa-check"></i><b>1.4</b> Divide and conquer</a></li>
<li class="chapter" data-level="1.5" data-path="best-practices.html"><a href="best-practices.html#codebooks-metadata-and-data-dictionaries"><i class="fa fa-check"></i><b>1.5</b> Codebooks, metadata, and data dictionaries</a></li>
<li class="chapter" data-level="1.6" data-path="best-practices.html"><a href="best-practices.html#data-formatting"><i class="fa fa-check"></i><b>1.6</b> Data formatting</a></li>
<li class="chapter" data-level="1.7" data-path="best-practices.html"><a href="best-practices.html#pollutant-names"><i class="fa fa-check"></i><b>1.7</b> Pollutant names</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="get-data.html"><a href="get-data.html"><i class="fa fa-check"></i><b>2</b> Get data</a><ul>
<li class="chapter" data-level="2.1" data-path="get-data.html"><a href="get-data.html#air-monitoring"><i class="fa fa-check"></i><b>2.1</b> Air monitoring</a><ul>
<li class="chapter" data-level="2.1.1" data-path="get-data.html"><a href="get-data.html#AQS"><i class="fa fa-check"></i><b>2.1.1</b> Retrieving data from AQS</a></li>
<li class="chapter" data-level="2.1.2" data-path="get-data.html"><a href="get-data.html#rqamd"><i class="fa fa-check"></i><b>2.1.2</b> Retrieving data from AQS DataMart</a></li>
<li class="chapter" data-level="2.1.3" data-path="get-data.html"><a href="get-data.html#aqi-now"><i class="fa fa-check"></i><b>2.1.3</b> Current AQI observations</a></li>
<li class="chapter" data-level="2.1.4" data-path="get-data.html"><a href="get-data.html#wairsites"><i class="fa fa-check"></i><b>2.1.4</b> WAIR Site information table</a></li>
<li class="chapter" data-level="2.1.5" data-path="get-data.html"><a href="get-data.html#monitors"><i class="fa fa-check"></i><b>2.1.5</b> AirNow:Active AQI monitors</a></li>
<li class="chapter" data-level="2.1.6" data-path="get-data.html"><a href="get-data.html#EPAsites"><i class="fa fa-check"></i><b>2.1.6</b> EPA Google Earth Site Maps</a></li>
<li class="chapter" data-level="2.1.7" data-path="get-data.html"><a href="get-data.html#lims"><i class="fa fa-check"></i><b>2.1.7</b> Retrieving data from LIMS via Tableau</a></li>
<li class="chapter" data-level="2.1.8" data-path="get-data.html"><a href="get-data.html#AirVision"><i class="fa fa-check"></i><b>2.1.8</b> Retrieving continuous data from AirVision</a></li>
<li class="chapter" data-level="2.1.9" data-path="get-data.html"><a href="get-data.html#wair"><i class="fa fa-check"></i><b>2.1.9</b> Retrieving data from MPCA WAIR database</a></li>
<li class="chapter" data-level="2.1.10" data-path="get-data.html"><a href="get-data.html#toxics"><i class="fa fa-check"></i><b>2.1.10</b> Air toxics Data Explorer</a></li>
<li class="chapter" data-level="2.1.11" data-path="get-data.html"><a href="get-data.html#criteria"><i class="fa fa-check"></i><b>2.1.11</b> Criteria Pollutant Data Explorer</a></li>
<li class="chapter" data-level="2.1.12" data-path="get-data.html"><a href="get-data.html#AQI"><i class="fa fa-check"></i><b>2.1.12</b> Air Quality Index Summary Reports</a></li>
<li class="chapter" data-level="2.1.13" data-path="get-data.html"><a href="get-data.html#PAHs"><i class="fa fa-check"></i><b>2.1.13</b> Air Monitoring for PAHs</a></li>
<li class="chapter" data-level="2.1.14" data-path="get-data.html"><a href="get-data.html#tableau"><i class="fa fa-check"></i><b>2.1.14</b> Internal Data Explorers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="get-data.html"><a href="get-data.html#health-and-standards"><i class="fa fa-check"></i><b>2.2</b> Health and standards</a><ul>
<li class="chapter" data-level="2.2.1" data-path="get-data.html"><a href="get-data.html#IHBs"><i class="fa fa-check"></i><b>2.2.1</b> Inhalation health benchmarks (IHBs)</a></li>
<li class="chapter" data-level="2.2.2" data-path="get-data.html"><a href="get-data.html#NAAQS"><i class="fa fa-check"></i><b>2.2.2</b> Air Quality Standards (NAAQS and MAAQS)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="get-data.html"><a href="get-data.html#air-modeling"><i class="fa fa-check"></i><b>2.3</b> Air modeling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="get-data.html"><a href="get-data.html#nata"><i class="fa fa-check"></i><b>2.3.1</b> NATA modeling</a></li>
<li class="chapter" data-level="2.3.2" data-path="get-data.html"><a href="get-data.html#mnrisks"><i class="fa fa-check"></i><b>2.3.2</b> MNRISKS statewide risk modeling</a></li>
<li class="chapter" data-level="2.3.3" data-path="get-data.html"><a href="get-data.html#downscale"><i class="fa fa-check"></i><b>2.3.3</b> Downscaler modeling results for Ozone and PM2.5</a></li>
<li class="chapter" data-level="2.3.4" data-path="get-data.html"><a href="get-data.html#cmaq"><i class="fa fa-check"></i><b>2.3.4</b> CMAQ Ozone modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="get-data.html"><a href="get-data.html#context"><i class="fa fa-check"></i><b>2.4</b> Context</a><ul>
<li class="chapter" data-level="2.4.1" data-path="get-data.html"><a href="get-data.html#mn-ei"><i class="fa fa-check"></i><b>2.4.1</b> MN Emissions Inventory</a></li>
<li class="chapter" data-level="2.4.2" data-path="get-data.html"><a href="get-data.html#nei"><i class="fa fa-check"></i><b>2.4.2</b> EPA’s NEI</a></li>
<li class="chapter" data-level="2.4.3" data-path="get-data.html"><a href="get-data.html#fac-coords"><i class="fa fa-check"></i><b>2.4.3</b> Facility locations</a></li>
<li class="chapter" data-level="2.4.4" data-path="get-data.html"><a href="get-data.html#wx-obs"><i class="fa fa-check"></i><b>2.4.4</b> Weather observations</a></li>
<li class="chapter" data-level="2.4.5" data-path="get-data.html"><a href="get-data.html#hysplit"><i class="fa fa-check"></i><b>2.4.5</b> HYSPLIT wind trajectories</a></li>
<li class="chapter" data-level="2.4.6" data-path="get-data.html"><a href="get-data.html#landuse"><i class="fa fa-check"></i><b>2.4.6</b> Land use maps</a></li>
<li class="chapter" data-level="2.4.7" data-path="get-data.html"><a href="get-data.html#census"><i class="fa fa-check"></i><b>2.4.7</b> United States Census boundaries</a></li>
<li class="chapter" data-level="2.4.8" data-path="get-data.html"><a href="get-data.html#acs"><i class="fa fa-check"></i><b>2.4.8</b> American Community Survey (ACS)</a></li>
</ul></li>
</ul></li>
<li><a href="quality-assurance-methods.html#quality-assurance-methods"><strong>Quality assurance methods</strong></a></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#missing"><i class="fa fa-check"></i><b>3.1</b> Blank, NULL, and missing values</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#quals"><i class="fa fa-check"></i><b>3.2</b> Qualified data</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#dups"><i class="fa fa-check"></i><b>3.3</b> Duplicate observations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-validation.html"><a href="data-validation.html"><i class="fa fa-check"></i><b>4</b> Data validation</a><ul>
<li class="chapter" data-level="4.1" data-path="data-validation.html"><a href="data-validation.html#leaks"><i class="fa fa-check"></i><b>4.1</b> Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="4.2" data-path="data-validation.html"><a href="data-validation.html#outs"><i class="fa fa-check"></i><b>4.2</b> Extreme values and outliers</a></li>
<li class="chapter" data-level="4.3" data-path="data-validation.html"><a href="data-validation.html#sticky2"><i class="fa fa-check"></i><b>4.3</b> Sequential repeats and “sticky” numbers</a></li>
<li class="chapter" data-level="4.4" data-path="data-validation.html"><a href="data-validation.html#unique"><i class="fa fa-check"></i><b>4.4</b> Unique detected values</a></li>
<li class="chapter" data-level="4.5" data-path="data-validation.html"><a href="data-validation.html#valid_ref"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="collocated-monitors.html"><a href="collocated-monitors.html"><i class="fa fa-check"></i><b>5</b> Collocated monitors</a><ul>
<li class="chapter" data-level="5.1" data-path="collocated-monitors.html"><a href="collocated-monitors.html#evalpocs"><i class="fa fa-check"></i><b>5.1</b> Evaluate collocated air monitors</a></li>
<li class="chapter" data-level="5.2" data-path="collocated-monitors.html"><a href="collocated-monitors.html#pripocs"><i class="fa fa-check"></i><b>5.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="detection-limits.html"><a href="detection-limits.html"><i class="fa fa-check"></i><b>6</b> Detection limits</a><ul>
<li class="chapter" data-level="6.1" data-path="detection-limits.html"><a href="detection-limits.html#method-detection-limit"><i class="fa fa-check"></i><b>6.1</b> Method Detection Limit</a></li>
<li class="chapter" data-level="6.2" data-path="detection-limits.html"><a href="detection-limits.html#calculating-mdls"><i class="fa fa-check"></i><b>6.2</b> Calculating MDLs</a></li>
<li class="chapter" data-level="6.3" data-path="detection-limits.html"><a href="detection-limits.html#finding-mpca-detection-limits"><i class="fa fa-check"></i><b>6.3</b> Finding MPCA detection limits</a></li>
<li class="chapter" data-level="6.4" data-path="detection-limits.html"><a href="detection-limits.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>6.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="6.5" data-path="detection-limits.html"><a href="detection-limits.html#estimating-below-detection-values"><i class="fa fa-check"></i><b>6.5</b> Estimating below detection values</a></li>
<li class="chapter" data-level="6.6" data-path="detection-limits.html"><a href="detection-limits.html#recommended-steps"><i class="fa fa-check"></i><b>6.6</b> Recommended Steps</a></li>
<li class="chapter" data-level="6.7" data-path="detection-limits.html"><a href="detection-limits.html#multiple-detection-limits"><i class="fa fa-check"></i><b>6.7</b> Multiple detection limits</a></li>
<li class="chapter" data-level="6.8" data-path="detection-limits.html"><a href="detection-limits.html#reporting-limits"><i class="fa fa-check"></i><b>6.8</b> Reporting limits</a></li>
<li class="chapter" data-level="6.9" data-path="detection-limits.html"><a href="detection-limits.html#references"><i class="fa fa-check"></i><b>6.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="completeness-checks.html"><a href="completeness-checks.html"><i class="fa fa-check"></i><b>7</b> Completeness checks</a><ul>
<li class="chapter" data-level="7.1" data-path="completeness-checks.html"><a href="completeness-checks.html#complete"><i class="fa fa-check"></i><b>7.1</b> Completeness checks</a></li>
</ul></li>
<li><a href="summary-methods.html#summary-methods"><strong>Summary methods</strong></a></li>
<li class="chapter" data-level="8" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>8</b> Summary statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-statistics.html"><a href="summary-statistics.html#normal"><i class="fa fa-check"></i><b>8.1</b> Test for normality</a></li>
<li class="chapter" data-level="8.2" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>8.2</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.3" data-path="summary-statistics.html"><a href="summary-statistics.html#below"><i class="fa fa-check"></i><b>8.3</b> Below the detection limit</a></li>
<li class="chapter" data-level="8.4" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>8.4</b> Upper confidence limits (UCLs)</a></li>
<li class="chapter" data-level="8.5" data-path="summary-statistics.html"><a href="summary-statistics.html#incomplete"><i class="fa fa-check"></i><b>8.5</b> Annual summaries for incomplete data</a></li>
<li class="chapter" data-level="8.6" data-path="summary-statistics.html"><a href="summary-statistics.html#health"><i class="fa fa-check"></i><b>8.6</b> Comparison of data to inhalation health benchmarks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="site-comparisons.html"><a href="site-comparisons.html"><i class="fa fa-check"></i><b>9</b> Site comparisons</a><ul>
<li class="chapter" data-level="9.1" data-path="site-comparisons.html"><a href="site-comparisons.html#confidence-intervals"><i class="fa fa-check"></i><b>9.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="9.2" data-path="site-comparisons.html"><a href="site-comparisons.html#tools-to-visualize-differences"><i class="fa fa-check"></i><b>9.2</b> Tools to visualize differences</a><ul>
<li class="chapter" data-level="" data-path="site-comparisons.html"><a href="site-comparisons.html#beeswarm-plots"><i class="fa fa-check"></i>Beeswarm Plots</a></li>
<li class="chapter" data-level="" data-path="site-comparisons.html"><a href="site-comparisons.html#correlation-matrices"><i class="fa fa-check"></i>Correlation matrices</a></li>
</ul></li>
<li><a href="site-comparisons.html#references-1"><em>References</em></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="start-finish.html"><a href="start-finish.html"><i class="fa fa-check"></i><b>10</b> From start to finish</a><ul>
<li class="chapter" data-level="10.1" data-path="start-finish.html"><a href="start-finish.html#using-functions"><i class="fa fa-check"></i><b>10.1</b> Using functions</a></li>
<li class="chapter" data-level="10.2" data-path="start-finish.html"><a href="start-finish.html#a-simpler-analysis"><i class="fa fa-check"></i><b>10.2</b> A simpler analysis</a></li>
</ul></li>
<li><a href="visuals.html#visuals"><strong>Visuals</strong></a></li>
<li class="chapter" data-level="11" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>11</b> Charts</a><ul>
<li class="chapter" data-level="11.1" data-path="charts.html"><a href="charts.html#calendar-plots"><i class="fa fa-check"></i><b>11.1</b> Calendar plots</a></li>
<li class="chapter" data-level="11.2" data-path="charts.html"><a href="charts.html#colors-and-themes"><i class="fa fa-check"></i><b>11.2</b> Colors and themes</a></li>
<li class="chapter" data-level="11.3" data-path="charts.html"><a href="charts.html#pollution-roses"><i class="fa fa-check"></i><b>11.3</b> Pollution roses</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>12</b> Time series</a><ul>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#hour-of-the-day"><i class="fa fa-check"></i>Hour of the day</a></li>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#day-of-the-week"><i class="fa fa-check"></i>Day of the week</a></li>
<li class="chapter" data-level="" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i>Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a><ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-map-of-air-monitors"><i class="fa fa-check"></i>Interactive map of air monitors</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#creating-shapefiles-in-r"><i class="fa fa-check"></i>Creating shapefiles in R</a></li>
</ul></li>
<li><a href="mpca-data-tools.html#mpca-data-tools"><strong>MPCA data tools</strong></a></li>
<li class="chapter" data-level="14" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html"><i class="fa fa-check"></i><b>14</b> Air toxics explorer</a><ul>
<li class="chapter" data-level="14.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-cleaning-1"><i class="fa fa-check"></i><b>14.1</b> Data Cleaning</a><ul>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#null-results"><i class="fa fa-check"></i>Null Results</a></li>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#duplicate-observations"><i class="fa fa-check"></i>Duplicate Observations</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-validation-1"><i class="fa fa-check"></i><b>14.2</b> Data Validation</a><ul>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#parameter-occurrence-codes-pocs"><i class="fa fa-check"></i>Parameter Occurrence Codes (POCs)</a></li>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-completeness"><i class="fa fa-check"></i>Data Completeness</a></li>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#below-the-detection-limit"><i class="fa fa-check"></i>Below the detection limit</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#producing-annual-summaries"><i class="fa fa-check"></i><b>14.3</b> Producing Annual Summaries</a><ul>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#calculating-annual-means"><i class="fa fa-check"></i>Calculating annual means</a></li>
<li class="chapter" data-level="" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#calculating-upper-confidence-limits"><i class="fa fa-check"></i>Calculating upper confidence limits</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#comparing-sites"><i class="fa fa-check"></i><b>14.4</b> Comparing sites</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="criteria-pollutant-explorer.html"><a href="criteria-pollutant-explorer.html"><i class="fa fa-check"></i><b>15</b> Criteria pollutant explorer</a></li>
<li class="chapter" data-level="16" data-path="aqi-explorer.html"><a href="aqi-explorer.html"><i class="fa fa-check"></i><b>16</b> AQI explorer</a></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a><ul>
<li><a href="edit-this-book.html#references-2"><em>References</em></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summary-statistics" class="section level1">
<h1><span class="header-section-number"></span> Summary statistics</h1>
<p><img src="images/cover7.jpg" align="right" style="margin-top: -4px; margin-left: 24px; width: 34%;" /></p>
<p><br></p>
<p>The summary methods described in this chapter include:</p>
<p><a href="summary-statistics.html#normal">8.1</a> <strong>Normality</strong><br />
<a href="summary-statistics.html#boots">8.2</a> <strong>Bootstrapping</strong><br />
<a href="summary-statistics.html#below">8.3</a> <strong>Below the detection limit</strong><br />
<a href="summary-statistics.html#confidence">8.4</a> <strong>Confidence intervals</strong><br />
<a href="summary-statistics.html#incomplete">8.5</a> <strong>Annual summaries for incomplete data</strong><br />
<a href="summary-statistics.html#health">8.6</a> <strong>Comparison of data to inhalation health benchmarks</strong></p>
<p><br></p>
<div id="normal" class="section level2">
<h2><span class="header-section-number">8.1</span> Test for normality</h2>
<p>Data should be tested for normality prior to determining the type of summary statistic to report. In general environmental data are non-normal and contain with many low values and a few high values. This causes the mean of the data to be higher than the median (right skewed). Many normality tests exist and they vary in sensitivity. A good article on normality tests can be found at <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3693611/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3693611/</a>.</p>
<p>The normality test in the example script below is a recommended test for data of sample size between 5-5000 and will allow missing values. A Shapiro-Wilk test may also be performed for the typical sample size of a year of air toxics results. The script below includes a a line to switch to a Shapiro Wilk test.</p>
<p><br></p>
<p><em>Click below to view code for a normality test.</em></p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><strong>Normality test</strong></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="summary-statistics.html#cb62-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb62-2"><a href="summary-statistics.html#cb62-2"></a><span class="kw">library</span>(stats)</span>
<span id="cb62-3"><a href="summary-statistics.html#cb62-3"></a><span class="kw">library</span>(nortest)</span>
<span id="cb62-4"><a href="summary-statistics.html#cb62-4"></a></span>
<span id="cb62-5"><a href="summary-statistics.html#cb62-5"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)</span>
<span id="cb62-6"><a href="summary-statistics.html#cb62-6"></a></span>
<span id="cb62-7"><a href="summary-statistics.html#cb62-7"></a><span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;poc&quot;</span>, <span class="st">&quot;param_code&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;null_code&quot;</span>, <span class="st">&quot;md_limit&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cas&quot;</span>)</span>
<span id="cb62-8"><a href="summary-statistics.html#cb62-8"></a></span>
<span id="cb62-9"><a href="summary-statistics.html#cb62-9"></a>data_normresults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">site_name=</span><span class="kw">character</span>(),</span>
<span id="cb62-10"><a href="summary-statistics.html#cb62-10"></a>                               <span class="dt">analyte=</span><span class="kw">character</span>(),</span>
<span id="cb62-11"><a href="summary-statistics.html#cb62-11"></a>                               <span class="dt">year=</span><span class="kw">character</span>(),</span>
<span id="cb62-12"><a href="summary-statistics.html#cb62-12"></a>                                 <span class="dt">w_value=</span><span class="kw">numeric</span>(), </span>
<span id="cb62-13"><a href="summary-statistics.html#cb62-13"></a>                                 <span class="dt">p_value=</span><span class="kw">numeric</span>(), </span>
<span id="cb62-14"><a href="summary-statistics.html#cb62-14"></a>                                 <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>) </span>
<span id="cb62-15"><a href="summary-statistics.html#cb62-15"></a>sites &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>aqs_id)</span>
<span id="cb62-16"><a href="summary-statistics.html#cb62-16"></a>analytes &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>pollutant)</span>
<span id="cb62-17"><a href="summary-statistics.html#cb62-17"></a>years &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>year)</span>
<span id="cb62-18"><a href="summary-statistics.html#cb62-18"></a></span>
<span id="cb62-19"><a href="summary-statistics.html#cb62-19"></a><span class="cf">for</span>(i <span class="cf">in</span> sites[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]){</span>
<span id="cb62-20"><a href="summary-statistics.html#cb62-20"></a>  <span class="cf">for</span>(j <span class="cf">in</span> analytes){</span>
<span id="cb62-21"><a href="summary-statistics.html#cb62-21"></a>    <span class="cf">for</span>(k <span class="cf">in</span> years){</span>
<span id="cb62-22"><a href="summary-statistics.html#cb62-22"></a>      </span>
<span id="cb62-23"><a href="summary-statistics.html#cb62-23"></a>  data_sub &lt;-<span class="st"> </span><span class="kw">filter</span>(data , aqs_id <span class="op">==</span><span class="st"> </span>i, pollutant <span class="op">==</span><span class="st"> </span>j, year <span class="op">==</span>k)</span>
<span id="cb62-24"><a href="summary-statistics.html#cb62-24"></a>  </span>
<span id="cb62-25"><a href="summary-statistics.html#cb62-25"></a>  <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">unique</span>(data_sub<span class="op">$</span>conc)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>) {</span>
<span id="cb62-26"><a href="summary-statistics.html#cb62-26"></a>    </span>
<span id="cb62-27"><a href="summary-statistics.html#cb62-27"></a>    norm_test &lt;-<span class="st"> </span><span class="kw">sf.test</span>(data_sub<span class="op">$</span>conc)</span>
<span id="cb62-28"><a href="summary-statistics.html#cb62-28"></a>    <span class="co">#norm_test &lt;- shapiro.test(data_sub$conc)</span></span>
<span id="cb62-29"><a href="summary-statistics.html#cb62-29"></a>    </span>
<span id="cb62-30"><a href="summary-statistics.html#cb62-30"></a>    <span class="kw">print</span>(i)</span>
<span id="cb62-31"><a href="summary-statistics.html#cb62-31"></a>    </span>
<span id="cb62-32"><a href="summary-statistics.html#cb62-32"></a>    <span class="kw">print</span>(norm_test)</span>
<span id="cb62-33"><a href="summary-statistics.html#cb62-33"></a>    </span>
<span id="cb62-34"><a href="summary-statistics.html#cb62-34"></a>    values &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">site_name =</span> i, <span class="dt">analyte=</span>j, <span class="dt">year=</span>k, <span class="dt">w_value =</span> <span class="kw">round</span>(norm_test<span class="op">$</span>statistic, <span class="dt">digits =</span> <span class="dv">2</span>), <span class="dt">p_value =</span> <span class="kw">round</span>(norm_test<span class="op">$</span>p.value, <span class="dt">digits =</span> <span class="dv">2</span>))</span>
<span id="cb62-35"><a href="summary-statistics.html#cb62-35"></a>    </span>
<span id="cb62-36"><a href="summary-statistics.html#cb62-36"></a>    data_normresults &lt;-<span class="st"> </span><span class="kw">rbind</span>(values, data_normresults)</span>
<span id="cb62-37"><a href="summary-statistics.html#cb62-37"></a>    }</span>
<span id="cb62-38"><a href="summary-statistics.html#cb62-38"></a>  }</span>
<span id="cb62-39"><a href="summary-statistics.html#cb62-39"></a>  }</span>
<span id="cb62-40"><a href="summary-statistics.html#cb62-40"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="summary-statistics.html#cb63-1"></a>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="kw">head</span>(data_normresults), <span class="dt">options =</span> dt_options)</span></code></pre></div>
<div id="htmlwidget-6602a7cc29406f4e4343" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6602a7cc29406f4e4343">{"x":{"filter":"none","data":[["W","W44","W43","W42","W41","W40"],[271231003,271231003,271231003,271231003,271231003,271231003],["Selenium","Nickel","Manganese","Lead","Cobalt","Chromium"],[2009,2009,2009,2009,2009,2009],[0.93,0.52,0.98,0.86,0.38,0.85],[0,0,0.46,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>site_name<\/th>\n      <th>analyte<\/th>\n      <th>year<\/th>\n      <th>w_value<\/th>\n      <th>p_value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<p><br></p>
<p>We also suggest visualizing the data to determine if normality may be a valid assumption. The script below is an example of visual normality tests and includes an explanation of their interpretation. In the Q-Q Plot, normal data will form a straight line with the theoretical distribution quantiles with little deviation from the line. This is a visual test and somewhat subjective. Normal data form histograms that produce a bell shaped curve.</p>
<p>Here’s an example tool to inspect your data by year, site and pollutant: <a href="https://mpca-pahs.shinyapps.io/NormViz/">https://mpca-pahs.shinyapps.io/NormViz/</a></p>
<p><em>Click to view the code for the shiny tool above.</em></p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><strong>Shiny tool</strong></p>
</div>
<p><br></p>
<p>When to use a arithmetic or geometric mean:</p>
<ul>
<li>Use an arithmetic mean when your data are normal and there are less than 5% below detection limit values per year/analyte/site.</li>
<li>For non-automated scripts: Use a geometric mean if your data are log-normally distributed and there are less than 5% below detection limit values per year/analyte/site.</li>
</ul>
</div>
<div id="boots" class="section level2">
<h2><span class="header-section-number">8.2</span> Bootstrapping</h2>
<p>Bootstrapping provides methods for calculating summary statistics without making assumptions about the distribution from which the data is sampled.</p>
<p><em>Click to view the bootstrapping code.</em></p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><strong>Bootstrapping</strong></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="summary-statistics.html#cb64-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb64-2"><a href="summary-statistics.html#cb64-2"></a><span class="kw">library</span>(readr)</span></code></pre></div>
Our data is organized by monitoring site and date. Here’s a sample.
<table>
<thead>
<tr>
<th style="text-align:right;">
AQS_ID
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Conc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-07-30
</td>
<td style="text-align:right;">
0.00148
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-09-30
</td>
<td style="text-align:right;">
0.00064
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-11-30
</td>
<td style="text-align:right;">
0.34256
</td>
</tr>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:left;">
2009-12-30
</td>
<td style="text-align:right;">
0.00064
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-03-30
</td>
<td style="text-align:right;">
0.26219
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-07-30
</td>
<td style="text-align:right;">
0.01113
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-09-30
</td>
<td style="text-align:right;">
0.00044
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-11-30
</td>
<td style="text-align:right;">
0.00127
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:left;">
2009-12-30
</td>
<td style="text-align:right;">
0.00113
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Bootstrap function</strong></p>
<p>We currently use the <code>EnvStats</code> package to generate air toxics summary values. It has built in functions to account for non-detect data and allows for different distributions. However, if you’re not dealing with non-detects you can use a simple loop to boot things yourself.</p>
<p>Before you start you’ll want to set the random number generator to ensure you’ll be able to reproduce your results. I’ll use <code>#27</code> below.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="summary-statistics.html#cb65-1"></a><span class="kw">set.seed</span>(<span class="dv">27</span>)</span></code></pre></div>
<p>The general idea is to take a random sample with replacement from the data set, generate the statistic that you’re interested in, record it, then rinse and repeat. Below is the code for how to resample a single site.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="summary-statistics.html#cb66-1"></a><span class="co"># Filter data to a single site</span></span>
<span id="cb66-2"><a href="summary-statistics.html#cb66-2"></a>df_site1 &lt;-<span class="st"> </span><span class="kw">filter</span>(df, AQS_ID <span class="op">==</span><span class="st"> </span>AQS_ID[<span class="dv">1</span>])</span>
<span id="cb66-3"><a href="summary-statistics.html#cb66-3"></a></span>
<span id="cb66-4"><a href="summary-statistics.html#cb66-4"></a><span class="co"># Pull random sample</span></span>
<span id="cb66-5"><a href="summary-statistics.html#cb66-5"></a><span class="co"># `replace=T` allows for the same value to be pulled multiple times</span></span>
<span id="cb66-6"><a href="summary-statistics.html#cb66-6"></a><span class="co"># `size=nrow(df)` ensures the number of observations in the new table to match the original </span></span>
<span id="cb66-7"><a href="summary-statistics.html#cb66-7"></a>random_df &lt;-<span class="st"> </span><span class="kw">sample</span>(df_site1<span class="op">$</span>Conc, <span class="dt">replace =</span> T)</span>
<span id="cb66-8"><a href="summary-statistics.html#cb66-8"></a></span>
<span id="cb66-9"><a href="summary-statistics.html#cb66-9"></a><span class="co"># Generate summary statistic</span></span>
<span id="cb66-10"><a href="summary-statistics.html#cb66-10"></a><span class="kw">quantile</span>(random_df, <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##     10% 
## 0.00064</code></pre>
<p>To repeat this 3,000 times we can wrap these steps into a <code>resample</code> function, and then use <code>sapply</code> to collect the results.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="summary-statistics.html#cb68-1"></a><span class="co"># Create  resample function</span></span>
<span id="cb68-2"><a href="summary-statistics.html#cb68-2"></a>resample_Conc &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> df_site1<span class="op">$</span>Conc, <span class="dt">Conc_pct =</span> <span class="fl">0.10</span>){</span>
<span id="cb68-3"><a href="summary-statistics.html#cb68-3"></a></span>
<span id="cb68-4"><a href="summary-statistics.html#cb68-4"></a>random_df &lt;-<span class="st"> </span><span class="kw">sample</span>(data, <span class="dt">replace =</span> T)</span>
<span id="cb68-5"><a href="summary-statistics.html#cb68-5"></a></span>
<span id="cb68-6"><a href="summary-statistics.html#cb68-6"></a><span class="kw">quantile</span>(random_df, Conc_pct, <span class="dt">na.rm=</span>T)[[<span class="dv">1</span>]]</span>
<span id="cb68-7"><a href="summary-statistics.html#cb68-7"></a></span>
<span id="cb68-8"><a href="summary-statistics.html#cb68-8"></a>}</span>
<span id="cb68-9"><a href="summary-statistics.html#cb68-9"></a></span>
<span id="cb68-10"><a href="summary-statistics.html#cb68-10"></a><span class="co"># Repeat using `sapply`</span></span>
<span id="cb68-11"><a href="summary-statistics.html#cb68-11"></a>repeats &lt;-<span class="st"> </span><span class="dv">3000</span></span>
<span id="cb68-12"><a href="summary-statistics.html#cb68-12"></a></span>
<span id="cb68-13"><a href="summary-statistics.html#cb68-13"></a>booted_10pct &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>repeats, <span class="dt">FUN =</span> <span class="cf">function</span>(x)</span>
<span id="cb68-14"><a href="summary-statistics.html#cb68-14"></a>  <span class="kw">resample_Conc</span>(df_site1<span class="op">$</span>Conc))</span>
<span id="cb68-15"><a href="summary-statistics.html#cb68-15"></a></span>
<span id="cb68-16"><a href="summary-statistics.html#cb68-16"></a><span class="co"># The 50th percentile or median Conc</span></span>
<span id="cb68-17"><a href="summary-statistics.html#cb68-17"></a><span class="kw">median</span>(booted_10pct, <span class="dt">na.rm=</span>T)</span></code></pre></div>
<pre><code>## [1] 0.00064</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="summary-statistics.html#cb70-1"></a><span class="co"># Return the 95th percentile of the booted concentrations</span></span>
<span id="cb70-2"><a href="summary-statistics.html#cb70-2"></a><span class="kw">quantile</span>(booted_10pct, <span class="fl">0.95</span>, <span class="dt">na.rm =</span> T)[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1] 0.00148</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="summary-statistics.html#cb72-1"></a><span class="co"># Force the 95th percentile to be a recorded value</span></span>
<span id="cb72-2"><a href="summary-statistics.html#cb72-2"></a><span class="kw">sort</span>(booted_10pct)[repeats<span class="op">*</span>.<span class="dv">95</span> <span class="op">+</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.00148</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="summary-statistics.html#cb74-1"></a><span class="co"># Upper and lower confidence interval around the median</span></span>
<span id="cb74-2"><a href="summary-statistics.html#cb74-2"></a><span class="kw">quantile</span>(booted_10pct, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>), <span class="dt">na.rm =</span> T)</span></code></pre></div>
<pre><code>##     2.5%      50%    97.5% 
## 0.000640 0.000640 0.103216</code></pre>
<p><strong>Automate</strong></p>
<p>To finish, put these steps into a <code>boot</code> function and run it on each site by using <code>group_by</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="summary-statistics.html#cb76-1"></a><span class="co"># Create boot function</span></span>
<span id="cb76-2"><a href="summary-statistics.html#cb76-2"></a>boot_low_Conc &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">data     =</span> df<span class="op">$</span>Conc, </span>
<span id="cb76-3"><a href="summary-statistics.html#cb76-3"></a>                          <span class="dt">Conc_pct =</span> <span class="fl">0.10</span>, </span>
<span id="cb76-4"><a href="summary-statistics.html#cb76-4"></a>                          <span class="dt">conf_int =</span> <span class="fl">0.95</span>, </span>
<span id="cb76-5"><a href="summary-statistics.html#cb76-5"></a>                          <span class="dt">repeats  =</span> <span class="dv">3000</span>){</span>
<span id="cb76-6"><a href="summary-statistics.html#cb76-6"></a></span>
<span id="cb76-7"><a href="summary-statistics.html#cb76-7"></a>alpha &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>conf_int)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb76-8"><a href="summary-statistics.html#cb76-8"></a></span>
<span id="cb76-9"><a href="summary-statistics.html#cb76-9"></a>booted_10pct &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>repeats, <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">resample_Conc</span>(data, Conc_pct))</span>
<span id="cb76-10"><a href="summary-statistics.html#cb76-10"></a></span>
<span id="cb76-11"><a href="summary-statistics.html#cb76-11"></a><span class="co"># Upper and lower confidence interval around the median</span></span>
<span id="cb76-12"><a href="summary-statistics.html#cb76-12"></a><span class="kw">list</span>(<span class="kw">quantile</span>(booted_10pct, <span class="kw">c</span>(alpha, <span class="fl">0.5</span>, <span class="dv">1</span><span class="op">-</span>alpha), <span class="dt">na.rm =</span> T))</span>
<span id="cb76-13"><a href="summary-statistics.html#cb76-13"></a></span>
<span id="cb76-14"><a href="summary-statistics.html#cb76-14"></a>}</span>
<span id="cb76-15"><a href="summary-statistics.html#cb76-15"></a></span>
<span id="cb76-16"><a href="summary-statistics.html#cb76-16"></a><span class="co"># Use `group_by` to send data for each site to your boot function</span></span>
<span id="cb76-17"><a href="summary-statistics.html#cb76-17"></a>conc_summary &lt;-<span class="st"> </span><span class="kw">group_by</span>(df, AQS_ID) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-18"><a href="summary-statistics.html#cb76-18"></a><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">boot_results   =</span> <span class="kw">boot_low_Conc</span>(Conc, <span class="dt">Conc_pct=</span><span class="fl">0.10</span>, <span class="dt">conf_int=</span><span class="fl">0.95</span>)) <span class="op">%&gt;%</span></span>
<span id="cb76-19"><a href="summary-statistics.html#cb76-19"></a><span class="st">                </span><span class="kw">summarize</span>(<span class="dt">Conc_10pct  =</span>  <span class="kw">quantile</span>(Conc, <span class="fl">0.10</span>, <span class="dt">na.rm=</span>T)[[<span class="dv">1</span>]],</span>
<span id="cb76-20"><a href="summary-statistics.html#cb76-20"></a>                <span class="dt">Low_CL95_conc         =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">1</span>]], </span>
<span id="cb76-21"><a href="summary-statistics.html#cb76-21"></a>                <span class="dt">Boot_conc             =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">2</span>]], </span>
<span id="cb76-22"><a href="summary-statistics.html#cb76-22"></a>                <span class="dt">Upper_CL95_conc       =</span> <span class="kw">unlist</span>(boot_results[<span class="dv">1</span>])[[<span class="dv">3</span>]])  </span></code></pre></div>
<p><strong>Results</strong></p>
<p>The booted confidence limits:</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
AQS_ID
</th>
<th style="text-align:right;">
Conc_10pct
</th>
<th style="text-align:right;">
Low_CL95_conc
</th>
<th style="text-align:right;">
Boot_conc
</th>
<th style="text-align:right;">
Upper_CL95_conc
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
270535501
</td>
<td style="text-align:right;">
0.000640
</td>
<td style="text-align:right;">
0.00064
</td>
<td style="text-align:right;">
0.000640
</td>
<td style="text-align:right;">
0.103216
</td>
</tr>
<tr>
<td style="text-align:right;">
270535502
</td>
<td style="text-align:right;">
0.000716
</td>
<td style="text-align:right;">
0.00044
</td>
<td style="text-align:right;">
0.000716
</td>
<td style="text-align:right;">
0.005214
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="below" class="section level2">
<h2><span class="header-section-number">8.3</span> Below the detection limit</h2>
<p>The annual mean or upper confidence limit is reported as below the detection limit when either of the following conditions is true:</p>
<ul>
<li>The number of censored values is greater than 80%.
<ul>
<li>This is based on <em>Cox 2006</em> and MPCA simulations (cite work and results)[www.google.com].</li>
</ul></li>
<li>The annual mean or 95% upper confidence limit is below the method detection limit.</li>
</ul>
</div>
<div id="confidence" class="section level2">
<h2><span class="header-section-number">8.4</span> Upper confidence limits (UCLs)</h2>
<p>If data is not normal, use bootstraping to generate means for each site. The 95% upper confidence limit is the 95th percentile of means generated using bootstrap sampling.</p>
<p>The script below uses bootstrap sampling to generate 1000 means for each site, pollutant, and year and then calculates the 95% UCL by taking the 95th percentile of those means. Values below the MDL are estimated using lognormal MLE estimation for each bootstrap sample. The 95% UCL is not calculated for any site, pollutant, and year which fails to meet completeness requirements and/or minimum detection requirements.</p>
<p><em>Click to view code for calculating UCLs.</em></p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><strong>Upper Confidence Limits</strong></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="summary-statistics.html#cb77-1"></a><span class="co"># DATA prep:</span></span>
<span id="cb77-2"><a href="summary-statistics.html#cb77-2"></a><span class="co">## For this function data must have names: </span></span>
<span id="cb77-3"><a href="summary-statistics.html#cb77-3"></a><span class="co">## &quot;AQSID&quot;, &quot;POC&quot;, &quot;Parameter&quot;, &quot;Date&quot;, &quot;Result&quot;, &quot;MDL&quot;, &quot;Pollutant&quot;</span></span>
<span id="cb77-4"><a href="summary-statistics.html#cb77-4"></a></span>
<span id="cb77-5"><a href="summary-statistics.html#cb77-5"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb77-6"><a href="summary-statistics.html#cb77-6"></a><span class="kw">library</span>(EnvStats)</span>
<span id="cb77-7"><a href="summary-statistics.html#cb77-7"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb77-8"><a href="summary-statistics.html#cb77-8"></a></span>
<span id="cb77-9"><a href="summary-statistics.html#cb77-9"></a>seed &lt;-<span class="st"> </span><span class="dv">2017</span></span>
<span id="cb77-10"><a href="summary-statistics.html#cb77-10"></a></span>
<span id="cb77-11"><a href="summary-statistics.html#cb77-11"></a>data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)</span>
<span id="cb77-12"><a href="summary-statistics.html#cb77-12"></a></span>
<span id="cb77-13"><a href="summary-statistics.html#cb77-13"></a></span>
<span id="cb77-14"><a href="summary-statistics.html#cb77-14"></a><span class="kw">names</span>(data)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AQSID&quot;</span>, <span class="st">&quot;POC&quot;</span>, <span class="st">&quot;Parameter&quot;</span>, <span class="st">&quot;Date&quot;</span>,<span class="st">&quot;Result&quot;</span>,</span>
<span id="cb77-15"><a href="summary-statistics.html#cb77-15"></a>                       <span class="st">&quot;Null_Data_Code&quot;</span>, <span class="st">&quot;MDL&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;CAS&quot;</span>)</span>
<span id="cb77-16"><a href="summary-statistics.html#cb77-16"></a></span>
<span id="cb77-17"><a href="summary-statistics.html#cb77-17"></a>data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-18"><a href="summary-statistics.html#cb77-18"></a><span class="st">        </span><span class="kw">filter</span>(AQSID <span class="op">==</span><span class="st"> </span><span class="dv">270370020</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-19"><a href="summary-statistics.html#cb77-19"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Monitoring Site</span><span class="st">`</span> =<span class="st"> </span>AQSID, </span>
<span id="cb77-20"><a href="summary-statistics.html#cb77-20"></a>               <span class="dt">PollutantGroup    =</span> Pollutant, </span>
<span id="cb77-21"><a href="summary-statistics.html#cb77-21"></a>               <span class="dt">Censored          =</span> Result <span class="op">&lt;</span><span class="st"> </span>MDL, </span>
<span id="cb77-22"><a href="summary-statistics.html#cb77-22"></a>               <span class="dt">Result            =</span> <span class="kw">ifelse</span>(Censored, MDL, Result))</span>
<span id="cb77-23"><a href="summary-statistics.html#cb77-23"></a></span>
<span id="cb77-24"><a href="summary-statistics.html#cb77-24"></a></span>
<span id="cb77-25"><a href="summary-statistics.html#cb77-25"></a>UCL_<span class="dv">95</span> =<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">Boot_Repeats =</span> <span class="dv">1000</span>) {</span>
<span id="cb77-26"><a href="summary-statistics.html#cb77-26"></a>  </span>
<span id="cb77-27"><a href="summary-statistics.html#cb77-27"></a>  <span class="kw">library</span>(EnvStats)</span>
<span id="cb77-28"><a href="summary-statistics.html#cb77-28"></a>  </span>
<span id="cb77-29"><a href="summary-statistics.html#cb77-29"></a>  <span class="kw">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb77-30"><a href="summary-statistics.html#cb77-30"></a>  </span>
<span id="cb77-31"><a href="summary-statistics.html#cb77-31"></a>  annual_AT_means &lt;-<span class="st"> </span><span class="cf">function</span>(air_toxics) {</span>
<span id="cb77-32"><a href="summary-statistics.html#cb77-32"></a>  </span>
<span id="cb77-33"><a href="summary-statistics.html#cb77-33"></a>  air_toxics &lt;-<span class="st"> </span><span class="kw">mutate</span>(air_toxics, </span>
<span id="cb77-34"><a href="summary-statistics.html#cb77-34"></a>                       <span class="dt">Year =</span> <span class="kw">year</span>(<span class="kw">ymd</span>(Date)), </span>
<span id="cb77-35"><a href="summary-statistics.html#cb77-35"></a>                       <span class="dt">Quarter =</span> <span class="kw">quarter</span>(<span class="kw">ymd</span>(Date)))</span>
<span id="cb77-36"><a href="summary-statistics.html#cb77-36"></a>  </span>
<span id="cb77-37"><a href="summary-statistics.html#cb77-37"></a>  sample_complete &lt;-<span class="st"> </span>air_toxics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-38"><a href="summary-statistics.html#cb77-38"></a><span class="st">                     </span><span class="kw">group_by</span>(AQSID, Pollutant, Year, Quarter, MDL) <span class="op">%&gt;%</span></span>
<span id="cb77-39"><a href="summary-statistics.html#cb77-39"></a><span class="st">                     </span><span class="kw">summarise</span>(<span class="dt">Complete =</span> ( (<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(Result) ) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(Result) ) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.75</span> ) ) <span class="op">%&gt;%</span></span>
<span id="cb77-40"><a href="summary-statistics.html#cb77-40"></a><span class="st">                     </span><span class="kw">mutate</span>(<span class="dt">Complete =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(Complete), F, Complete) ) <span class="op">%&gt;%</span></span>
<span id="cb77-41"><a href="summary-statistics.html#cb77-41"></a><span class="st">                     </span><span class="kw">group_by</span>(AQSID, Pollutant, Year, MDL) <span class="op">%&gt;%</span></span>
<span id="cb77-42"><a href="summary-statistics.html#cb77-42"></a><span class="st">                     </span><span class="kw">summarise</span>(<span class="dt">Complete =</span> <span class="kw">all</span>(Complete) )</span>
<span id="cb77-43"><a href="summary-statistics.html#cb77-43"></a>  </span>
<span id="cb77-44"><a href="summary-statistics.html#cb77-44"></a>  enough_detects &lt;-<span class="st"> </span>air_toxics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-45"><a href="summary-statistics.html#cb77-45"></a><span class="st">                    </span><span class="kw">group_by</span>(AQSID, Pollutant, Year, MDL) <span class="op">%&gt;%</span></span>
<span id="cb77-46"><a href="summary-statistics.html#cb77-46"></a><span class="st">                    </span><span class="kw">summarise</span>(<span class="dt">Detected =</span> <span class="kw">mean</span>(Censored, <span class="dt">na.rm =</span> T) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.8</span> )</span>
<span id="cb77-47"><a href="summary-statistics.html#cb77-47"></a>  </span>
<span id="cb77-48"><a href="summary-statistics.html#cb77-48"></a>  site_means &lt;-<span class="st"> </span>air_toxics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-49"><a href="summary-statistics.html#cb77-49"></a><span class="st">    </span><span class="kw">group_by</span>(AQSID, Pollutant, Year, MDL) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-50"><a href="summary-statistics.html#cb77-50"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">ifelse</span>(<span class="kw">length</span>(<span class="kw">unique</span>(Result[<span class="op">!</span><span class="kw">is.na</span>(Result) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>Censored] ) ) <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>, <span class="ot">NA</span>,</span>
<span id="cb77-51"><a href="summary-statistics.html#cb77-51"></a>     <span class="kw">ifelse</span> (<span class="kw">any</span>(Censored, <span class="dt">na.rm =</span> T), <span class="kw">elnormAltCensored</span>(Result, Censored, <span class="dt">method =</span> <span class="st">&quot;impute.w.mle&quot;</span>, <span class="dt">ci =</span> F)<span class="op">$</span>parameters[[<span class="dv">1</span>]], <span class="kw">mean</span>(Result, <span class="dt">na.rm =</span> T) ) ) )</span>
<span id="cb77-52"><a href="summary-statistics.html#cb77-52"></a>  </span>
<span id="cb77-53"><a href="summary-statistics.html#cb77-53"></a>  site_means &lt;-<span class="st"> </span><span class="kw">left_join</span>(site_means, sample_complete, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;AQSID&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;MDL&quot;</span>) ) <span class="op">%&gt;%</span></span>
<span id="cb77-54"><a href="summary-statistics.html#cb77-54"></a><span class="st">    </span><span class="kw">left_join</span>(enough_detects, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;AQSID&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;MDL&quot;</span>) ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-55"><a href="summary-statistics.html#cb77-55"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Mean =</span> <span class="kw">ifelse</span>(Complete <span class="op">&amp;</span><span class="st"> </span>Detected, Mean, <span class="ot">NA</span>), <span class="dt">ID =</span> <span class="kw">paste</span>(AQSID, Pollutant, Year) )</span>
<span id="cb77-56"><a href="summary-statistics.html#cb77-56"></a></span>
<span id="cb77-57"><a href="summary-statistics.html#cb77-57"></a>  <span class="kw">return</span>(site_means)</span>
<span id="cb77-58"><a href="summary-statistics.html#cb77-58"></a>  </span>
<span id="cb77-59"><a href="summary-statistics.html#cb77-59"></a>}</span>
<span id="cb77-60"><a href="summary-statistics.html#cb77-60"></a>  </span>
<span id="cb77-61"><a href="summary-statistics.html#cb77-61"></a>  MLE_est &lt;-<span class="st"> </span><span class="cf">function</span>(data){</span>
<span id="cb77-62"><a href="summary-statistics.html#cb77-62"></a>    </span>
<span id="cb77-63"><a href="summary-statistics.html#cb77-63"></a>    results =<span class="st"> </span>data<span class="op">$</span>Result</span>
<span id="cb77-64"><a href="summary-statistics.html#cb77-64"></a>    </span>
<span id="cb77-65"><a href="summary-statistics.html#cb77-65"></a>    censored =<span class="st"> </span>data<span class="op">$</span>Censored</span>
<span id="cb77-66"><a href="summary-statistics.html#cb77-66"></a>    </span>
<span id="cb77-67"><a href="summary-statistics.html#cb77-67"></a>    n =<span class="st"> </span><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(results))</span>
<span id="cb77-68"><a href="summary-statistics.html#cb77-68"></a>    </span>
<span id="cb77-69"><a href="summary-statistics.html#cb77-69"></a>    <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">unique</span>(results[<span class="op">!</span><span class="kw">is.na</span>(results) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>censored] ) ) <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> ) {</span>
<span id="cb77-70"><a href="summary-statistics.html#cb77-70"></a>      MLE_means =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb77-71"><a href="summary-statistics.html#cb77-71"></a>    }</span>
<span id="cb77-72"><a href="summary-statistics.html#cb77-72"></a>    </span>
<span id="cb77-73"><a href="summary-statistics.html#cb77-73"></a>    <span class="cf">else</span> {</span>
<span id="cb77-74"><a href="summary-statistics.html#cb77-74"></a>      random.rows =<span class="st"> </span><span class="ot">NULL</span>  </span>
<span id="cb77-75"><a href="summary-statistics.html#cb77-75"></a>      </span>
<span id="cb77-76"><a href="summary-statistics.html#cb77-76"></a>      random.rows =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(censored) <span class="op">&amp;</span><span class="st"> </span>(<span class="op">!</span>censored) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">duplicated</span>(results) ), <span class="dv">2</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb77-77"><a href="summary-statistics.html#cb77-77"></a>      </span>
<span id="cb77-78"><a href="summary-statistics.html#cb77-78"></a>      random.rows =<span class="st"> </span><span class="kw">c</span>(random.rows, <span class="kw">sample</span>(<span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(censored)), n<span class="dv">-2</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span>
<span id="cb77-79"><a href="summary-statistics.html#cb77-79"></a>      </span>
<span id="cb77-80"><a href="summary-statistics.html#cb77-80"></a>      MLE_means =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">sum</span>(censored[random.rows], <span class="dt">na.rm =</span> T) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="kw">mean</span>(results[random.rows]), <span class="kw">elnormAltCensored</span>(results[random.rows], censored[random.rows], <span class="dt">method =</span> <span class="st">&quot;impute.w.mle&quot;</span>, <span class="dt">ci =</span> F)<span class="op">$</span>parameters[[<span class="dv">1</span>]] )</span>
<span id="cb77-81"><a href="summary-statistics.html#cb77-81"></a>      </span>
<span id="cb77-82"><a href="summary-statistics.html#cb77-82"></a>    }</span>
<span id="cb77-83"><a href="summary-statistics.html#cb77-83"></a>    </span>
<span id="cb77-84"><a href="summary-statistics.html#cb77-84"></a>    <span class="kw">return</span>(MLE_means)</span>
<span id="cb77-85"><a href="summary-statistics.html#cb77-85"></a>  }</span>
<span id="cb77-86"><a href="summary-statistics.html#cb77-86"></a>  </span>
<span id="cb77-87"><a href="summary-statistics.html#cb77-87"></a>  data &lt;-<span class="st"> </span><span class="kw">mutate</span>(data, <span class="dt">ID =</span> <span class="kw">paste</span>(AQSID, Pollutant, Year))</span>
<span id="cb77-88"><a href="summary-statistics.html#cb77-88"></a>  </span>
<span id="cb77-89"><a href="summary-statistics.html#cb77-89"></a>  Bootstrap_means &lt;-<span class="st"> </span><span class="kw">replicate</span>(Boot_Repeats, (<span class="kw">by</span>(data, data<span class="op">$</span>ID, MLE_est) ) )</span>
<span id="cb77-90"><a href="summary-statistics.html#cb77-90"></a>  </span>
<span id="cb77-91"><a href="summary-statistics.html#cb77-91"></a>  CL &lt;-<span class="st"> </span><span class="kw">apply</span>(Bootstrap_means, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">sort</span>(x)[<span class="kw">ceiling</span>(<span class="fl">0.95</span> <span class="op">*</span><span class="st"> </span>Boot_Repeats)] )</span>
<span id="cb77-92"><a href="summary-statistics.html#cb77-92"></a>  </span>
<span id="cb77-93"><a href="summary-statistics.html#cb77-93"></a>  CL &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> <span class="kw">names</span>(CL), <span class="dt">UCL95 =</span> <span class="kw">unname</span>(CL))</span>
<span id="cb77-94"><a href="summary-statistics.html#cb77-94"></a>  </span>
<span id="cb77-95"><a href="summary-statistics.html#cb77-95"></a>  annual_summary =<span class="st"> </span><span class="kw">left_join</span>(<span class="kw">annual_AT_means</span>(data), CL, <span class="dt">by =</span> <span class="st">&quot;ID&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">UCL95 =</span> <span class="kw">ifelse</span>(Complete <span class="op">&amp;</span><span class="st"> </span>Detected, UCL95, <span class="ot">NA</span>) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>ID)</span>
<span id="cb77-96"><a href="summary-statistics.html#cb77-96"></a>  </span>
<span id="cb77-97"><a href="summary-statistics.html#cb77-97"></a>  <span class="kw">return</span>(annual_summary)</span>
<span id="cb77-98"><a href="summary-statistics.html#cb77-98"></a>  </span>
<span id="cb77-99"><a href="summary-statistics.html#cb77-99"></a>}</span>
<span id="cb77-100"><a href="summary-statistics.html#cb77-100"></a></span>
<span id="cb77-101"><a href="summary-statistics.html#cb77-101"></a><span class="kw">set.seed</span>(seed)</span>
<span id="cb77-102"><a href="summary-statistics.html#cb77-102"></a></span>
<span id="cb77-103"><a href="summary-statistics.html#cb77-103"></a>annual_summary =<span class="st"> </span><span class="kw">UCL_95</span>(data, <span class="dv">100</span>)</span></code></pre></div>
</div>
</div>
<div id="incomplete" class="section level2">
<h2><span class="header-section-number">8.5</span> Annual summaries for incomplete data</h2>
<p>There may be situations when a monitoring site does not meet the 75% completeness requirement in each quarter of a year, but annual summary statistics are still necessary. In this case, calculate annual summary statistics as usual, but add a flag noting that the site did not meet completeness requirements. The minimum threshold of valid samples required for reporting annual summary statistics may be based on the professional judgement of data analysis staff, but must meet statistical test assumptions.</p>
</div>
<div id="health" class="section level2">
<h2><span class="header-section-number">8.6</span> Comparison of data to inhalation health benchmarks</h2>
<p><strong>Chronic Inhalation Health Benchmarks</strong><br />
The annual 95% upper confidence limit is compared to chronic inhalation health benchmarks which are chosen based on the MPCA/MDH hierarchy for inhalation health benchmarks information sources.These risk results are summarized differently for annual measured data reports (The Air Toxics Data Explorer) or if the comparison is used in a cumulative analysis (cumulative AERA) to inform air permitting or environmental review.</p>
<p><br></p>
<p><strong>Acute Inhalation Health Benchmarks</strong><br />
The 2nd highest annual value multiplied by ten is compared to acute inhalation health benchmarks. This adjustment of the 24 hour integrated value approximates an hourly maximum, since acute inhalation health benchmarks are developed to be protective for high short-term exposures (about an hour).</p>
<p><strong>Summary of risk estimates for cumulative Air Emission Risk Analaysis</strong></p>
<p>Cumulative AERAs use the mean cumulative risk estimate from the most recent three years of monitored data. For cumulative risks, we apply additivity and sum risk estimates across pollutants. Since all pollutants are not measured at each monitoring site, multiple sites are used to generate a cumulative risk estimate for various population densities.</p>
<p>Means are calculated for urban, mid-density and rural sites. Facilities within urban areas may also be provided with risk estimates for the closest or most representative monitor with all pollutants measured.</p>
<p>This is described further in the cumulative AERA section of the <a href="https://www.pca.state.mn.us/air/aera-guide">AERA guide</a>.</p>
<p><br></p>
<p><br> <a href="summary-statistics.html#summary-statistics">Back to top</a></p>

</div>
</div>
<script>
  $(".btn_code").click(function() {
    $(this.parentNode).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="summary-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="site-comparisons.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/07-summary_statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["air-methods.pdf", "air-methods.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
