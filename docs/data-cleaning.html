<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.5.2 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="quality-assurance-methods.html">
<link rel="next" href="collocated-monitors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.3/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>1</b> Best practices</a><ul>
<li class="chapter" data-level="1.1" data-path="best-practices.html"><a href="best-practices.html#tidyverse"><i class="fa fa-check"></i><b>1.1</b> Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="best-practices.html"><a href="best-practices.html#pollutant-names"><i class="fa fa-check"></i><b>1.2</b> Pollutant names</a></li>
<li class="chapter" data-level="1.3" data-path="best-practices.html"><a href="best-practices.html#keeping-r-up-to-date"><i class="fa fa-check"></i><b>1.3</b> Keeping R up-to-date</a></li>
<li class="chapter" data-level="1.4" data-path="best-practices.html"><a href="best-practices.html#script-layout"><i class="fa fa-check"></i><b>1.4</b> Script layout</a></li>
<li class="chapter" data-level="1.5" data-path="best-practices.html"><a href="best-practices.html#divide-and-conquer"><i class="fa fa-check"></i><b>1.5</b> Divide and conquer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-data.html"><a href="getting-data.html"><i class="fa fa-check"></i><b>2</b> Getting data</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-data.html"><a href="getting-data.html#air-monitoring"><i class="fa fa-check"></i><b>2.1</b> Air monitoring</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-data.html"><a href="getting-data.html#AQS"><i class="fa fa-check"></i><b>2.1.1</b> Retrieving data from AQS</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-data.html"><a href="getting-data.html#rqamd"><i class="fa fa-check"></i><b>2.1.2</b> Retrieving data from AQS DataMart</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-data.html"><a href="getting-data.html#aqi-now"><i class="fa fa-check"></i><b>2.1.3</b> Current AQI observations</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-data.html"><a href="getting-data.html#monitors"><i class="fa fa-check"></i><b>2.1.4</b> Active AQI monitors</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-data.html"><a href="getting-data.html#lims"><i class="fa fa-check"></i><b>2.1.5</b> Retrieving data from LIMS via Tableau</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-data.html"><a href="getting-data.html#AirVision"><i class="fa fa-check"></i><b>2.1.6</b> Retrieving continuous data from AirVision</a></li>
<li class="chapter" data-level="2.1.7" data-path="getting-data.html"><a href="getting-data.html#wair"><i class="fa fa-check"></i><b>2.1.7</b> Retrieving data from MPCA WAIR database</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-data.html"><a href="getting-data.html#health-and-standards"><i class="fa fa-check"></i><b>2.2</b> Health and standards</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-data.html"><a href="getting-data.html#IHBs"><i class="fa fa-check"></i><b>2.2.1</b> Inhalation health benchmarks</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-data.html"><a href="getting-data.html#NAAQS"><i class="fa fa-check"></i><b>2.2.2</b> Air Quality Standards (NAAQs and MAAQS)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-data.html"><a href="getting-data.html#air-modeling"><i class="fa fa-check"></i><b>2.3</b> Air modeling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-data.html"><a href="getting-data.html#nata"><i class="fa fa-check"></i><b>2.3.1</b> NATA modeling</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-data.html"><a href="getting-data.html#mnrisks"><i class="fa fa-check"></i><b>2.3.2</b> MNRISKS statewide risk modeling</a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-data.html"><a href="getting-data.html#downscale"><i class="fa fa-check"></i><b>2.3.3</b> Downscaler modeling results for Ozone and PM2.5</a></li>
<li class="chapter" data-level="2.3.4" data-path="getting-data.html"><a href="getting-data.html#cmaq"><i class="fa fa-check"></i><b>2.3.4</b> CMAQ Ozone modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-data.html"><a href="getting-data.html#context"><i class="fa fa-check"></i><b>2.4</b> Context</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-data.html"><a href="getting-data.html#mn-ei"><i class="fa fa-check"></i><b>2.4.1</b> MN Emissions Inventory</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-data.html"><a href="getting-data.html#nei"><i class="fa fa-check"></i><b>2.4.2</b> EPA’s NEI</a></li>
<li class="chapter" data-level="2.4.3" data-path="getting-data.html"><a href="getting-data.html#fac-coords"><i class="fa fa-check"></i><b>2.4.3</b> Facility locations</a></li>
<li class="chapter" data-level="2.4.4" data-path="getting-data.html"><a href="getting-data.html#wx-obs"><i class="fa fa-check"></i><b>2.4.4</b> Weather observations</a></li>
<li class="chapter" data-level="2.4.5" data-path="getting-data.html"><a href="getting-data.html#hysplit"><i class="fa fa-check"></i><b>2.4.5</b> HYSPLIT wind trajectories</a></li>
<li class="chapter" data-level="2.4.6" data-path="getting-data.html"><a href="getting-data.html#landuse"><i class="fa fa-check"></i><b>2.4.6</b> Land use maps</a></li>
<li class="chapter" data-level="2.4.7" data-path="getting-data.html"><a href="getting-data.html#census"><i class="fa fa-check"></i><b>2.4.7</b> United States Census boundaries</a></li>
<li class="chapter" data-level="2.4.8" data-path="getting-data.html"><a href="getting-data.html#acs"><i class="fa fa-check"></i><b>2.4.8</b> American Community Survey (ACS)</a></li>
</ul></li>
</ul></li>
<li><a href="quality-assurance-methods.html#quality-assurance-methods"><strong>Quality assurance methods</strong></a></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#missing"><i class="fa fa-check"></i><b>3.1</b> Remove blank, NULL, and missing values</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#quals"><i class="fa fa-check"></i><b>3.2</b> Remove <em>Qualified</em> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#leaks"><i class="fa fa-check"></i><b>3.3</b> Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="3.4" data-path="data-cleaning.html"><a href="data-cleaning.html#outs"><i class="fa fa-check"></i><b>3.4</b> Exceptional values and outliers</a></li>
<li class="chapter" data-level="3.5" data-path="data-cleaning.html"><a href="data-cleaning.html#sticky2"><i class="fa fa-check"></i><b>3.5</b> Sequential repeats and “sticky” numbers</a></li>
<li class="chapter" data-level="3.6" data-path="data-cleaning.html"><a href="data-cleaning.html#unique"><i class="fa fa-check"></i><b>3.6</b> Unique detected values</a></li>
<li class="chapter" data-level="3.7" data-path="data-cleaning.html"><a href="data-cleaning.html#valid_ref"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collocated-monitors.html"><a href="collocated-monitors.html"><i class="fa fa-check"></i><b>4</b> Collocated monitors</a><ul>
<li class="chapter" data-level="4.1" data-path="collocated-monitors.html"><a href="collocated-monitors.html#evalpocs"><i class="fa fa-check"></i><b>4.1</b> Evaluate collocated air monitors</a></li>
<li class="chapter" data-level="4.2" data-path="collocated-monitors.html"><a href="collocated-monitors.html#pripocs"><i class="fa fa-check"></i><b>4.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="detection-limits.html"><a href="detection-limits.html"><i class="fa fa-check"></i><b>5</b> Detection limits</a><ul>
<li class="chapter" data-level="5.1" data-path="detection-limits.html"><a href="detection-limits.html#method-detection-limit---definition"><i class="fa fa-check"></i><b>5.1</b> Method Detection Limit - <em>Definition</em></a></li>
<li class="chapter" data-level="5.2" data-path="detection-limits.html"><a href="detection-limits.html#procedure-for-calculating-method-detection-limits"><i class="fa fa-check"></i><b>5.2</b> Procedure for calculating method detection limits</a></li>
<li class="chapter" data-level="5.3" data-path="detection-limits.html"><a href="detection-limits.html#finding-detection-limits"><i class="fa fa-check"></i><b>5.3</b> Finding detection limits</a></li>
<li class="chapter" data-level="5.4" data-path="detection-limits.html"><a href="detection-limits.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>5.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="5.5" data-path="detection-limits.html"><a href="detection-limits.html#estimating-below-detection-values-what-not-to-do"><i class="fa fa-check"></i><b>5.5</b> Estimating below detection values <em>(what not to do)</em></a></li>
<li class="chapter" data-level="5.6" data-path="detection-limits.html"><a href="detection-limits.html#below-detection-values"><i class="fa fa-check"></i><b>5.6</b> Below detection values</a></li>
<li class="chapter" data-level="5.7" data-path="detection-limits.html"><a href="detection-limits.html#multiple-detection-limits"><i class="fa fa-check"></i><b>5.7</b> Multiple detection limits</a></li>
<li class="chapter" data-level="5.8" data-path="detection-limits.html"><a href="detection-limits.html#references"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="completeness-checks.html"><a href="completeness-checks.html"><i class="fa fa-check"></i><b>6</b> Completeness checks</a><ul>
<li class="chapter" data-level="6.1" data-path="completeness-checks.html"><a href="completeness-checks.html#complete"><i class="fa fa-check"></i><b>6.1</b> Completeness checks</a></li>
</ul></li>
<li><a href="summary-methods.html#summary-methods"><strong>Summary methods</strong></a></li>
<li class="chapter" data-level="7" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>7</b> Summary statistics</a><ul>
<li class="chapter" data-level="7.1" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>7.1</b> Bootstrapping</a></li>
<li class="chapter" data-level="7.2" data-path="summary-statistics.html"><a href="summary-statistics.html#below"><i class="fa fa-check"></i><b>7.2</b> Below the detection limit</a></li>
<li class="chapter" data-level="7.3" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>7.3</b> Upper confidence limits (UCLs)</a></li>
<li class="chapter" data-level="7.4" data-path="summary-statistics.html"><a href="summary-statistics.html#incomplete"><i class="fa fa-check"></i><b>7.4</b> Annual summaries for incomplete data</a></li>
<li class="chapter" data-level="7.5" data-path="summary-statistics.html"><a href="summary-statistics.html#health"><i class="fa fa-check"></i><b>7.5</b> Comparison of data to inhalation health benchmarks</a></li>
<li class="chapter" data-level="7.6" data-path="summary-statistics.html"><a href="summary-statistics.html#roll365"><i class="fa fa-check"></i><b>7.6</b> Rolling 365 day summaries</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="site-comparisons.html"><a href="site-comparisons.html"><i class="fa fa-check"></i><b>8</b> Site comparisons</a><ul>
<li class="chapter" data-level="8.1" data-path="site-comparisons.html"><a href="site-comparisons.html#confidence-intervals"><i class="fa fa-check"></i><b>8.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.2" data-path="site-comparisons.html"><a href="site-comparisons.html#tools-to-visualize-data"><i class="fa fa-check"></i><b>8.2</b> Tools to visualize data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="site-comparisons.html"><a href="site-comparisons.html#beeswarm-plots"><i class="fa fa-check"></i><b>8.2.1</b> Beeswarm Plots</a></li>
<li class="chapter" data-level="8.2.2" data-path="site-comparisons.html"><a href="site-comparisons.html#correlation-matrices"><i class="fa fa-check"></i><b>8.2.2</b> Correlation matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="start-finish.html"><a href="start-finish.html"><i class="fa fa-check"></i><b>9</b> Start to finish</a><ul>
<li class="chapter" data-level="9.1" data-path="start-finish.html"><a href="start-finish.html#functions"><i class="fa fa-check"></i><b>9.1</b> <strong>Functions</strong></a></li>
<li class="chapter" data-level="9.2" data-path="start-finish.html"><a href="start-finish.html#analysis-steps"><i class="fa fa-check"></i><b>9.2</b> <strong>Analysis Steps</strong></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>10</b> Charts</a><ul>
<li class="chapter" data-level="10.1" data-path="charts.html"><a href="charts.html#boxplots"><i class="fa fa-check"></i><b>10.1</b> Boxplots</a><ul>
<li class="chapter" data-level="10.1.1" data-path="charts.html"><a href="charts.html#log-boxplots"><i class="fa fa-check"></i><b>10.1.1</b> Log boxplots</a></li>
<li class="chapter" data-level="10.1.2" data-path="charts.html"><a href="charts.html#outliers"><i class="fa fa-check"></i><b>10.1.2</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="charts.html"><a href="charts.html#calendar-plots"><i class="fa fa-check"></i><b>10.2</b> Calendar plots</a></li>
<li class="chapter" data-level="10.3" data-path="charts.html"><a href="charts.html#color-palettes"><i class="fa fa-check"></i><b>10.3</b> Color palettes</a></li>
<li class="chapter" data-level="10.4" data-path="charts.html"><a href="charts.html#pollution-roses"><i class="fa fa-check"></i><b>10.4</b> Pollution roses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>11</b> Time series</a><ul>
<li class="chapter" data-level="11.1" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i><b>11.1</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>12</b> Maps</a><ul>
<li class="chapter" data-level="12.1" data-path="maps.html"><a href="maps.html#kriging"><i class="fa fa-check"></i><b>12.1</b> Kriging</a></li>
<li class="chapter" data-level="12.2" data-path="maps.html"><a href="maps.html#spatial-averaging-and-aggregation"><i class="fa fa-check"></i><b>12.2</b> Spatial averaging and aggregation</a></li>
<li class="chapter" data-level="12.3" data-path="maps.html"><a href="maps.html#creating-shapefiles-in-r-adn-joining-to-ej-areas"><i class="fa fa-check"></i><b>12.3</b> Creating shapefiles in R adn joining to EJ areas</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>13</b> Additional resources</a></li>
<li><a href="mpca-data-tools.html#mpca-data-tools"><strong>MPCA data tools</strong></a></li>
<li class="chapter" data-level="14" data-path="aqi-explorer.html"><a href="aqi-explorer.html"><i class="fa fa-check"></i><b>14</b> AQI explorer</a></li>
<li class="chapter" data-level="15" data-path="criteria-pollutant-explorer.html"><a href="criteria-pollutant-explorer.html"><i class="fa fa-check"></i><b>15</b> Criteria pollutant explorer</a></li>
<li class="chapter" data-level="16" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html"><i class="fa fa-check"></i><b>16</b> Air toxics explorer</a><ul>
<li class="chapter" data-level="16.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#mpca-air-toxics-methods"><i class="fa fa-check"></i><b>16.1</b> MPCA Air Toxics Methods</a><ul>
<li class="chapter" data-level="16.1.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-cleaning-1"><i class="fa fa-check"></i><b>16.1.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="16.1.2" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-validation-1"><i class="fa fa-check"></i><b>16.1.2</b> Data Validation</a></li>
<li class="chapter" data-level="16.1.3" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#parameter-occurrence-codes-pocs"><i class="fa fa-check"></i><b>16.1.3</b> Parameter Occurrence Codes (POCs)</a></li>
<li class="chapter" data-level="16.1.4" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#producing-annual-summaries"><i class="fa fa-check"></i><b>16.1.4</b> Producing Annual Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-cleaning" class="section level1">
<h1><span class="header-section-number"></span> Data cleaning</h1>
<p><br> <strong>Maintains Chapter</strong></p>
<blockquote>
<p>Derek</p>
</blockquote>
<p><img src="images/data-cleaning.jpg" width="55%" /></p>
<p>Before jumping into your analysis you’ll want to clean it up with some helpful quality checks and formatting procedures.</p>
<p>These procedures include steps to:</p>
<p><a href="data-cleaning.html#missing">3.1</a> <strong>Remove blank, invalid, NULL, and missing values</strong><br />
<a href="data-cleaning.html#quals">3.2</a> <strong>Evaluate qualified data</strong><br />
<a href="data-cleaning.html#dups"><strong>??</strong></a> <strong>Remove duplicate observations</strong></p>
<div id="missing" class="section level2">
<h2><span class="header-section-number">3.1</span> Remove blank, NULL, and missing values</h2>
<p><strong>Description</strong><br />
Large monitoring data sets often contain observations with missing concentrations, detection limits or other non-instrument result entries that can lead to incorrect summary statistics.</p>
<p><br> <strong>Recommended steps</strong></p>
<ol style="list-style-type: decimal">
<li>Identify any blank, NULL, <code>-999</code>, and missing values.</li>
<li>If available, review Null Data Codes. These codes will tell you why the data is missing. Most data sets will include null data codes. For AQS null code descriptions, see <a href="https://aqs.epa.gov/aqsweb/documents/codetables/qualifiers.html" class="uri">https://aqs.epa.gov/aqsweb/documents/codetables/qualifiers.html</a>.</li>
<li>Determine if your analysis needs to account for missing data before deleting observations. You may want to perform a count on all sample dates to quantify the expected number of observations.</li>
<li>If you no longer need these records, remove them from the dataset.</li>
<li>Document your process. Wait, you did that by writing it in an R script.</li>
</ol>
<p><br> <strong>Why not keep them?</strong></p>
<p>In most cases, our analyses do not require or allow filling in missing values. For this reason, it makes sense to remove them. However, for some analyses you may want to fill the missing values. The method for filling values will be project specific and decisions should be documented. Data sets should identify any records that include a replaced missing value.</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>Click the button below to view a step by step example of the methods above.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><br> Load example monitoring data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;aqs_id,poc,param_code,date,conc,null_code,md_limit,pollutant,cas</span>
<span class="st">                  271231003,1,12101,&quot;2004-01-04&quot;,-999.99,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-01-10&quot;,0.23,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-01-16&quot;,0.35,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-01-22&quot;,0.22,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-01-28&quot;,NA,NA,0.08,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-02-03&quot;,0.07,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-02-09&quot;,0.02,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-02-15&quot;,&quot; &quot;,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-02-21&quot;,0.03,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271231003,1,12101,&quot;2004-02-27&quot;,0.21,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271377001,1,12101,&quot;2007-09-21&quot;,NULL,a,0.04,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">                  271377001,1,12101,&quot;2007-09-21&quot;,0.14,NA,0.04,&quot;Aluminum&quot;,&quot;7429-90-5&quot;&#39;</span>)</code></pre></div>
<p><br> <em>Sample monitoring data</em> <div id="htmlwidget-ad097f972dea34df6e29" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ad097f972dea34df6e29">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271231003,271231003,271231003],[1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101],["2004-01-04","2004-01-10","2004-01-16","2004-01-22","2004-01-28","2004-02-03"],["-999.99","0.23","0.35","0.22",null,"0.07"],[null,null,null,null,null,null],[0.06,0.06,0.06,0.06,0.08,0.06],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,6]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
<p><br> Create a function to test for missing concentration values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test for missing concentrations, non-numeric values, and -999</span>
missing_conc &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  
  <span class="kw">is.na</span>(<span class="kw">as.numeric</span>(x)) <span class="op">||</span><span class="st"> </span><span class="kw">as.numeric</span>(x) <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="dv">900</span>
  
}</code></pre></div>
<p><br> Use the function to add a column to your data <code>conc_missing</code> that tests for missing concentration values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a new TRUE/FALSE column labeling each result as missing or not</span>
data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">conc_missing =</span> <span class="kw">missing_conc</span>(conc))

<span class="co"># Select all missing observations</span>
missing_values &lt;-<span class="st"> </span><span class="kw">filter</span>(data, conc_missing <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) </code></pre></div>
<p><br> <em>Missing values</em> <div id="htmlwidget-589c03c8fa107df56484" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-589c03c8fa107df56484">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271377001],[1,1,1,1],[12101,12101,12101,12101],["2004-01-04","2004-01-28","2004-02-15","2007-09-21"],["-999.99",null,null,"NULL"],[0.06,0.08,0.06,0.04],["Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5"],[true,true,true,true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n      <th>conc_missing<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,5]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
<p><br> Filter the data to only non-missing observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, conc_missing <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</code></pre></div>
<p><br> <em>The new and improved cleaner data</em><br />
<div id="htmlwidget-b8c20c51347d63b587bf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b8c20c51347d63b587bf">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271231003,271231003,271231003,271231003,271377001],[1,1,1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101,12101,12101],["2004-01-10","2004-01-16","2004-01-22","2004-02-03","2004-02-09","2004-02-21","2004-02-27","2007-09-21"],["0.23","0.35","0.22","0.07","0.02","0.03","0.21","0.14"],[0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.04],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"],[false,false,false,false,false,false,false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n      <th>conc_missing<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,5]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
<p><br> You can create similar functions to test for missing dates, site IDs, detection limits, and parameter codes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test for missing dates</span>
missing_dates &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">is.na</span>(<span class="kw">as.character</span>(x)) <span class="op">||</span><span class="st"> </span>
<span class="st">    </span><span class="kw">nchar</span>(<span class="kw">as.character</span>(x)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">11</span> <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(<span class="kw">as.character</span>(x)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">6</span>
}

<span class="co"># Test for missing site IDs</span>
missing_sites &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">is.na</span>(<span class="kw">as.character</span>(x)) <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(<span class="kw">as.character</span>(x)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span> 
}

<span class="co"># Test for missing detection limits</span>
missing_dls &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">is.na</span>(<span class="kw">as.numeric</span>(x)) <span class="op">||</span><span class="st"> </span><span class="kw">as.numeric</span>(x) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>
}

<span class="co"># Test for missing parameter codes</span>
missing_param &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">is.na</span>(<span class="kw">as.numeric</span>(x)) <span class="op">||</span><span class="st"> </span><span class="kw">as.numeric</span>(x) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>
<span class="st">    </span><span class="kw">nchar</span>(<span class="kw">as.character</span>(x)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(<span class="kw">as.character</span>(x)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">9</span>
}</code></pre></div>
<p><br> To apply these functions all at once use <code>dplyr</code>’s great function called <code>mutate()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create new TRUE/FALSE columns labeling each result as missing or not</span>
data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">conc_missing  =</span> <span class="kw">missing_conc</span>(conc),
              <span class="dt">date_missing   =</span> <span class="kw">missing_dates</span>(date),
              <span class="dt">site_missing   =</span> <span class="kw">missing_sites</span>(aqs_id),
              <span class="dt">dl_missing     =</span> <span class="kw">missing_dls</span>(md_limit),
              <span class="dt">param_missing  =</span> <span class="kw">missing_param</span>(param_code)) 

<span class="co"># Filter to remove any rows with a missing parameter.</span>
<span class="co"># We use sum() to count the number of missing parameters.</span>
<span class="co"># In this case we will drop any row with at least one missing parameter.</span>
data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">filter</span>(<span class="kw">sum</span>(<span class="kw">c</span>(conc_missing, 
                     date_missing, 
                     site_missing, 
                     dl_missing, 
                     param_missing), <span class="dt">na.rm =</span> T) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<p><br> <em>The super cleaner data</em><br />
<div id="htmlwidget-fa485050bb9e87f0ef3d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fa485050bb9e87f0ef3d">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8"],[271231003,271231003,271231003,271231003,271231003,271231003,271231003,271377001],[1,1,1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101,12101,12101],["2004-01-10","2004-01-16","2004-01-22","2004-02-03","2004-02-09","2004-02-21","2004-02-27","2007-09-21"],["0.23","0.35","0.22","0.07","0.02","0.03","0.21","0.14"],[null,null,null,null,null,null,null,null],[0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.04],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"],[false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n      <th>conc_missing<\/th>\n      <th>date_missing<\/th>\n      <th>site_missing<\/th>\n      <th>dl_missing<\/th>\n      <th>param_missing<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,7]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
</div>
</div>
<div id="quals" class="section level2">
<h2><span class="header-section-number">3.2</span> Remove <em>Qualified</em> data</h2>
<p><strong>Description</strong><br />
Valid sample results may have data qualifiers. These qualifiers provide contextual information about factors that can influence results. In the AQS data format, qualifiers are listed in 10 qualifier fields. A sample may have more than one qualifier. Descriptions of the AQS qualifier codes are available from the EPA at <a href="https://aqs.epa.gov/aqsweb/documents/codetables/qualifiers.html" class="uri">https://aqs.epa.gov/aqsweb/documents/codetables/qualifiers.html</a>.</p>
<p><br> <strong>Recommended steps</strong></p>
<ol style="list-style-type: decimal">
<li>Filter data to view samples with Qualifier codes</li>
<li>Evaluate whether any of the qualified data will unduly influence your analysis. For example, you may want to remove samples influenced by unique events.</li>
<li>When removing qualified data, maintain a copy of the original data set and document what values have been removed. In some cases, you may want to run your analysis with and without the qualified values to characterize the influence of the qualified data on the results.</li>
</ol>
<p>&lt;<br> <strong>Sample <code>R</code> script</strong></p>
<p>Click the button below to view a step by step example of the methods above.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<pre><code>## NULL</code></pre>
<p><br></p>
<h2 id="dups"><span class="header-section-number">3.2</span> Duplicate observations</h2>
<p><strong>Description</strong></p>
<p>Large monitoring data sets often contain multiple observations from the same monitor for the same time period. When multiple observations do occur they tend to be identified by or by a qualifier describing why the second observation was recorded (e.g. a duplicate for quality control). The treatment of these duplicate values will depend on the analysis.</p>
<p><br> <strong>Recommended steps</strong></p>
<ol style="list-style-type: decimal">
<li>Identify duplicate observations.</li>
<li>A duplicate in the data is likely the result of an error. Consult the lab about duplicate values.</li>
<li>Treatment of a duplicate observation will depend on the project.
<ul>
<li>For criteria pollutant design values, treatment of duplicate samples is defined for each pollutant in the <a href="https://www.ecfr.gov/cgi-bin/text-idx?tpl=/ecfrbrowse/Title40/40cfr50_main_02.tpl">Appendices of 40 CFR 50</a>.</li>
<li>For air toxics, treatment of duplicate values will depend on the analysis. In some cases you may want to average the results. In others, you may want to take the maximum value.</li>
</ul></li>
<li>If you identify records that are completely duplicated (same date, same site, same POC, same result, same MDL), delete these records prior to completing analyses.<br />
</li>
<li>For automated annual summaries, use the following hierarchy to remove duplicates:
<ul>
<li>Calculate the mean concentration of all non-censored observations.</li>
<li>If all observations are censored, select the observation with the lowest detection limit.</li>
<li>If all observations are censored and the detection limits are equal, select a single observation.</li>
</ul></li>
</ol>
<p><br> <strong>Why not keep all the data?</strong></p>
<p>Leaving multiple observations for some dates in the data set is likely to bias calculated summary statistics. For example, duplicate ozone observations from January would be likely to skew the annual average lower. By limiting the number of observations to 1 per day, we can remove the bias due to duplicate observations.</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>Click the button below to view a step by step example of the methods above.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><br> Load the sample monitoring data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">text =</span> <span class="st">&#39;</span>
<span class="st">aqs_id,poc,param_code,date,conc,null_code,md_limit,pollutant,cas</span>
<span class="st">271231003,1,12101,&quot;2004-01-04&quot;,0.05,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-01-10&quot;,0.23,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-01-16&quot;,0.35,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-01-22&quot;,0.22,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-01-28&quot;,0.01,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-03&quot;,0.07,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-09&quot;,0.02,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-15&quot;,0.07,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-21&quot;,0.03,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-21&quot;,0.02,NA,0.05,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-27&quot;,0.04,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271231003,1,12101,&quot;2004-02-27&quot;,0.21,NA,0.06,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271377001,1,12101,&quot;2007-09-21&quot;,0.18,NA,0.04,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271377001,1,12101,&quot;2007-09-21&quot;,0.14,NA,0.04,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">271377001,1,12101,&quot;2007-09-21&quot;,0.14,NA,0.04,&quot;Aluminum&quot;,&quot;7429-90-5&quot;</span>
<span class="st">&#39;</span>, <span class="dt">stringsAsFactor =</span> F)</code></pre></div>
<p><br> <em>Sample monitoring data</em> <div id="htmlwidget-0c373a21772d36178bb5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c373a21772d36178bb5">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271377001,271377001,271377001],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101],["2004-01-04","2004-01-10","2004-01-16","2004-01-22","2004-01-28","2004-02-03","2004-02-09","2004-02-15","2004-02-21","2004-02-21","2004-02-27","2004-02-27","2007-09-21","2007-09-21","2007-09-21"],[0.05,0.23,0.35,0.22,0.01,0.07,0.02,0.07,0.03,0.02,0.04,0.21,0.18,0.14,0.14],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.06,0.06,0.04,0.04,0.04],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,6]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
<p><br> Delete rows of data that are exact duplicates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check for exact duplicate rows</span>
dup_rows &lt;-<span class="st"> </span>data[<span class="kw">duplicated</span>(data), ]

<span class="co"># Drop the exact duplicates</span>
data    &lt;-<span class="st"> </span>data[<span class="op">!</span><span class="kw">duplicated</span>(data), ]</code></pre></div>
<p><br> Add a unique column ID to each site/poc/param-code/date combination.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add unique key to each row</span>
data<span class="op">$</span>key &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data)

<span class="co"># Create a unique ID for each site/poc/param-code/date combination</span>
data<span class="op">$</span>unique_sample_id &lt;-<span class="st"> </span><span class="kw">paste</span>(data<span class="op">$</span>aqs_id, data<span class="op">$</span>poc, data<span class="op">$</span>param_code, data<span class="op">$</span>date, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-36"></span>
<div id="htmlwidget-295fdb5cc9a7000da72e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-295fdb5cc9a7000da72e">{"x":{"filter":"none","data":[[1,2,3,4,5,6],["271231003_1_12101_2004-01-04","271231003_1_12101_2004-01-10","271231003_1_12101_2004-01-16","271231003_1_12101_2004-01-22","271231003_1_12101_2004-01-28","271231003_1_12101_2004-02-03"],[271231003,271231003,271231003,271231003,271231003,271231003],[1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101],["2004-01-04","2004-01-10","2004-01-16","2004-01-22","2004-01-28","2004-02-03"],[0.05,0.23,0.35,0.22,0.01,0.07],[null,null,null,null,null,null],[0.06,0.06,0.06,0.06,0.06,0.06],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>key<\/th>\n      <th>unique_sample_id<\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,2,3,4,6,8]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 3.1: Unique ID column added.
</p>
</div>
<p><br> Test for duplicate observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Label duplicate samples</span>
data &lt;-<span class="st"> </span><span class="kw">group_by</span>(data, unique_sample_id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">duplicate =</span> <span class="kw">n</span>() <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Create duplicate table</span>
dupes &lt;-<span class="st"> </span><span class="kw">filter</span>(data, duplicate <span class="op">==</span><span class="st"> </span>T)</code></pre></div>
<p><br> <em>Duplicate observations</em> <div id="htmlwidget-17882b33882652f011c7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-17882b33882652f011c7">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271231003,271377001,271377001],[1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101],["2004-02-21","2004-02-21","2004-02-27","2004-02-27","2007-09-21","2007-09-21"],[0.03,0.02,0.04,0.21,0.18,0.14],[null,null,null,null,null,null],[0.06,0.05,0.06,0.06,0.04,0.04],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"],[9,10,11,12,13,14],["271231003_1_12101_2004-02-21","271231003_1_12101_2004-02-21","271231003_1_12101_2004-02-27","271231003_1_12101_2004-02-27","271377001_1_12101_2007-09-21","271377001_1_12101_2007-09-21"],[true,true,true,true,true,true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n      <th>key<\/th>\n      <th>unique_sample_id<\/th>\n      <th>duplicate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,6,9]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
<p><br> If duplicates are found, use the following hierarchy to remove duplicates:</p>
<ol style="list-style-type: decimal">
<li>Calculate the mean concentration of all non-censored observations.</li>
<li>If all observations are censored, select the observation with the lowest detection limit.</li>
<li>If all observations are censored and the detection limits are equal, select a single observation.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Replace censored observations with NA</span>
dupes &lt;-<span class="st"> </span>dupes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">conc =</span> <span class="kw">ifelse</span>(conc <span class="op">&gt;=</span><span class="st"> </span>md_limit, conc, <span class="ot">NA</span>))

<span class="co"># Calculate the mean of non-censored observations</span>
dupes &lt;-<span class="st"> </span><span class="kw">group_by</span>(dupes, unique_sample_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">conc =</span> <span class="kw">mean</span>(conc, <span class="dt">na.rm =</span> T))


<span class="co"># Arrange by concentration and detection limit, then select the first observation</span>
dupes &lt;-<span class="st"> </span><span class="kw">group_by</span>(dupes, unique_sample_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">arrange</span>(<span class="kw">desc</span>(conc), md_limit) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">filter</span>(key <span class="op">==</span><span class="st"> </span>key[<span class="dv">1</span>])

<span class="co"># Remove Unique IDs with duplicates from data</span>
data &lt;-<span class="st"> </span><span class="kw">filter</span>(data, <span class="op">!</span>duplicate)

<span class="co"># Attach the selected duplicates with highest result and lowest detection limit</span>
data &lt;-<span class="st"> </span><span class="kw">rbind</span>(data, dupes)</code></pre></div>
<br> <em>The new cleaner data</em><br />

<div class="figure"><span id="fig:unnamed-chunk-40"></span>
<div id="htmlwidget-2ee5c2657369e1673449" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2ee5c2657369e1673449">{"x":{"filter":"none","data":[[271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271231003,271377001,271231003],[1,1,1,1,1,1,1,1,1,1,1],[12101,12101,12101,12101,12101,12101,12101,12101,12101,12101,12101],["2004-01-04","2004-01-10","2004-01-16","2004-01-22","2004-01-28","2004-02-03","2004-02-09","2004-02-15","2004-02-27","2007-09-21","2004-02-21"],[0.05,0.23,0.35,0.22,0.01,0.07,0.02,0.07,0.21,0.16,null],[null,null,null,null,null,null,null,null,null,null,null],[0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.04,0.05],["Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum","Aluminum"],["7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5","7429-90-5"],["271231003_1_12101_2004-01-04","271231003_1_12101_2004-01-10","271231003_1_12101_2004-01-16","271231003_1_12101_2004-01-22","271231003_1_12101_2004-01-28","271231003_1_12101_2004-02-03","271231003_1_12101_2004-02-09","271231003_1_12101_2004-02-15","271231003_1_12101_2004-02-27","271377001_1_12101_2007-09-21","271231003_1_12101_2004-02-21"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>cas<\/th>\n      <th>unique_sample_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,6]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 3.2: Final data set with 1 duplicate removed.
</p>
</div>
</div>
<p><br> <a href="data-cleaning.html#missing">Back to top</a></p>

<h1 id="data-validation"><span class="header-section-number">3.2</span> Data validation</h1>
<p><img src="https://i0.wp.com/catscradleshelter.org/wp-content/uploads/2015/10/8-quality-control.jpg?fit=1200%2C800" width="62%" /></p>
<p><strong>Maintains chapter</strong></p>
<blockquote>
<p>Kristie</p>
</blockquote>
<p><br></p>
<p>Environmental monitoring data can be subject to error. One way to catch these errors is to complete routines to find data that are inconsistent with expectations or do not comply with data rules. Data validation tasks should be completed at a scheduled frequency depending on the data frequency and the resources available.</p>
<p>Some important errors to check for include:</p>
<ul>
<li><a href="data-cleaning.html#leaks">3.3</a> <strong>Leaks, instrument drift, and sample contamination</strong></li>
<li><a href="data-cleaning.html#outs">3.4</a> <strong>Outliers and extreme values</strong><br />
</li>
<li><a href="data-cleaning.html#sticky2">3.5</a> <strong>Sequential repeats and <em>sticky</em> numbers</strong><br />
</li>
<li><a href="data-cleaning.html#unique">3.6</a> <strong>Unique values</strong></li>
</ul>
<p><br> There are other potential validation steps that may be done for specific sets of pollutants. The description of these methods in this web book are in development.</p>
<p><br> <strong>Why not average the exceptional data over the year?</strong></p>
<p>Further investigation by laboratory staff is required if the laboratory equipment or system is in error. If the laboratory is not in error, these concentrations require additional investigation by data analysts and potentially by air pollution source specialists. For these reasons, these data validation steps are critical. A decreasing signal or repeated sequential measurement means that the data are not interpretable. An exceptionally high value could mean laboratory contamination or potentially could contribute to human health impacts if the high value is accurate.</p>
<p><br> <strong>Basic validation tests</strong></p>
<ol style="list-style-type: decimal">
<li>Identify potential instrument drift.</li>
<li>Find low values where this is not common.</li>
<li>Identify exceptional values.</li>
<li>Find extreme values that may be in error or from contamination.</li>
<li>Identify sequential identical values (sticking).</li>
<li>Test - Find 3 repeating values that are exactly the same.</li>
<li>Report findings to laboratory for further investigation.</li>
</ol>
<p><br> <br> The following sections on data validation will use the example monitoring data loaded below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(RcppRoll)
<span class="kw">library</span>(lubridate)


##need to confirm that this data set has sequential repeats, some high values and at least 10 dates with numbers
data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)

<span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;poc&quot;</span>, <span class="st">&quot;param_code&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="st">&quot;null_code&quot;</span>, <span class="st">&quot;md_limit&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;cas&quot;</span>)

dt_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">scrollX =</span> T, <span class="dt">autoWidth =</span> T, <span class="dt">searching =</span> F, <span class="dt">ordering =</span> F, <span class="dt">lengthChange =</span> F, <span class="dt">paginate =</span> F, <span class="dt">info =</span> F)</code></pre></div>
<p><br> <em>Table: Sample monitoring data</em><br />
<div id="htmlwidget-d056855355d7d51313de" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d056855355d7d51313de">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],[270535501,270535501,270535501,270535501,270535501,270535501,270535501,270535501,270535501,270535501],[1,1,1,1,1,1,1,1,1,1],[12102,12102,12102,12102,12102,12102,12102,12102,12102,12102],["2009-07-30","2009-08-05","2009-08-11","2009-09-16","2009-09-22","2009-08-17","2009-08-23","2009-08-29","2009-09-04","2009-09-10"],[0.00127,0.00223,0.0037,0.0018,0.0027,0.00173,0.00257,0.00101,0.00604,0.0029],[null,null,null,null,null,null,null,null,null,null],[0.0028236,0.0028236,0.0028236,0.0028236,0.0028236,0.0028236,0.0028236,0.0028236,0.0028236,0.0028236],["Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony"],[2009,2009,2009,2009,2009,2009,2009,2009,2009,2009],["7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>year<\/th>\n      <th>cas<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
</div>
<p>_First it’s always a good idea to look at the data. If there are a lower number of numeric data points the statistical tests that follow may not be necessary.</p>
<p>_Open this web tool to chart all measured pollutants for each site for the cleaned data set. (<a href="https://mpca-pahs.shinyapps.io/ChartCleanData/" class="uri">https://mpca-pahs.shinyapps.io/ChartCleanData/</a>)</p>
<p><img src="images/data-detectionlimits.jpg" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="leaks" class="section level2">
<h2><span class="header-section-number">3.3</span> Instrument drift or leaks in a system.</h2>
<p>The example test set up to detect intrument drift checks for a difference in variance of carbon tetrachloride between a calendar quarter for two consecutive years. This test works for VOC air toxics measurements only. Carbon tetrachloride was chosen because it is a banned substance and no longer in use, it has very few below detection limit values, and no direct sources. It has seasonally variable concentrations, so calendar quarters were compared to eliminate the detection of seasonal differences. The statistical test used was a Levenes Test for homogeneity of variance. This test could be applied to other surrogate compounds where there are multiple analytes, or could be applied to single measurements when there is only one analyte for the instrument in questions (i.e. PM2.5).</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>Click the button below to view a step by step example of the method above.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)

data<span class="op">$</span>conc &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data<span class="op">$</span>conc)
data<span class="op">$</span>aqs_id &lt;-<span class="st"> </span><span class="kw">as.character</span>(data<span class="op">$</span>aqs_id)
sites &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>aqs_id)
years &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>year)
data<span class="op">$</span>quarter =<span class="st"> </span><span class="kw">quarter</span>(data<span class="op">$</span>date)
quarters &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>quarter)
pocs &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>poc)

clean_values =<span class="st"> </span><span class="cf">function</span>(data) {
  data<span class="op">$</span>conc =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(data<span class="op">$</span>conc))
  data<span class="op">$</span>conc[<span class="kw">abs</span>(data<span class="op">$</span>conc) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">999</span>] =<span class="st"> </span><span class="ot">NA</span>
  <span class="kw">return</span>(data)
}

data =<span class="st"> </span><span class="kw">clean_values</span>(data)

levene_function =<span class="st"> </span><span class="cf">function</span>(conc, quarter_year, row, col) {
  <span class="cf">if</span>(<span class="kw">length</span>(<span class="kw">unique</span>(quarter_year))<span class="op">&lt;</span><span class="dv">2</span>){
  <span class="kw">return</span>(<span class="ot">NA</span>)} 
  data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">conc =</span> conc, <span class="dt">quarter_year =</span> quarter_year)
  <span class="kw">return</span>(<span class="kw">leveneTest</span>(conc<span class="op">~</span><span class="kw">as.factor</span>(quarter_year), <span class="dt">data =</span> data)[row,col])
}

leak_table_unfiltered &lt;-<span class="st"> </span><span class="kw">data.frame</span>()
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">max</span>(years)<span class="op">:</span><span class="kw">max</span>(years)<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(years)){
  <span class="cf">for</span>(j <span class="cf">in</span> i<span class="op">+</span><span class="dv">1</span>){
    data_carbontet=<span class="kw">data.frame</span>()
  data_carbontet &lt;-<span class="st"> </span><span class="kw">filter</span>(data, pollutant<span class="op">==</span><span class="st">&quot;Carbon Tetrachloride&quot;</span>, <span class="op">!</span><span class="kw">is.na</span>(conc), year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(i, j))
data_carbontet<span class="op">$</span>quarter_year =<span class="st"> </span><span class="kw">paste</span>(data_carbontet<span class="op">$</span>quarter, <span class="st">&quot;_&quot;</span>, data_carbontet<span class="op">$</span>year)
data_carbontet &lt;-<span class="st"> </span>data_carbontet <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(aqs_id, poc, quarter) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">fvalue_levene =</span> <span class="kw">levene_function</span>(conc, quarter_year, <span class="dv">1</span>,<span class="dv">2</span>), 
            <span class="dt">pval_levene =</span> <span class="kw">levene_function</span>(conc, quarter_year, <span class="dv">1</span>,<span class="dv">3</span>), 
            <span class="dt">deg_free_levene =</span> <span class="kw">levene_function</span>(conc, quarter_year, <span class="dv">2</span>,<span class="dv">1</span>),
            <span class="dt">Year_1 =</span> <span class="kw">min</span>(year), 
            <span class="dt">Year_2 =</span> <span class="kw">max</span>(year),
            <span class="dt">Mean_Year_1 =</span> <span class="kw">mean</span>(conc[year<span class="op">==</span><span class="kw">min</span>(year)], <span class="dt">na.rm=</span>T),
            <span class="dt">Mean_Year_2 =</span> <span class="kw">mean</span>(conc[year<span class="op">==</span><span class="kw">max</span>(year)], <span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()
leak_table_unfiltered  &lt;-<span class="st"> </span><span class="kw">rbind</span>(leak_table_unfiltered,data_carbontet)
  }
}
leak_table &lt;-<span class="st"> </span><span class="kw">filter</span>(leak_table_unfiltered, pval_levene<span class="op">&lt;</span><span class="fl">0.01</span>, <span class="kw">abs</span>(Year_<span class="dv">1</span><span class="op">-</span>Year_<span class="dv">2</span>)<span class="op">==</span><span class="dv">1</span>)
leak_table<span class="op">$</span>Warning_Type &lt;-<span class="st"> &quot;Decrease_in_Measurements&quot;</span>

<span class="kw">datatable</span>(<span class="kw">head</span>(leak_table, <span class="dv">10</span>), <span class="dt">options =</span> dt_options) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">formatSignif</span>(<span class="kw">c</span>(<span class="st">&quot;fvalue_levene&quot;</span>, <span class="st">&quot;pval_levene&quot;</span>, <span class="st">&quot;Mean_Year_1&quot;</span>, <span class="st">&quot;Mean_Year_2&quot;</span>), <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<div id="htmlwidget-65864cf96b1b65fa722d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-65864cf96b1b65fa722d">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["270370423","270370020","270530963","270532006","271230871","271630436","271630438","271630438","270370423","270370442"],[1,1,1,1,1,1,1,1,1,1],[4,4,2,4,2,3,3,4,1,1],[12.8321167205998,8.30419781899444,10.1333525159204,7.83209847219974,31.8806166808157,10.0837964429286,7.84104281230434,7.95904130875383,8.69768548121835,15.5590610596442],[0.00186383643593451,0.00766282765700795,0.00355204671115566,0.00935632233004537,6.16044447634282e-006,0.00407513052426005,0.0099248877988128,0.00869911012386778,0.00665583043404958,0.000571273066957217],[20,27,28,27,26,24,24,28,26,25],[2012,2010,2010,2010,2010,2010,2010,2010,2009,2009],[2013,2011,2011,2011,2011,2011,2011,2011,2010,2010],[0.498802857142857,0.514200666666667,0.827502666666667,0.511833571428571,0.844817857142857,0.561594,0.573758,0.512104,0.494757857142857,0.468064666666667],[0.595147333333333,0.474537142857143,0.491134666666667,0.496167333333333,0.500149285714286,0.542759090909091,0.54276,0.489876,0.554974285714286,0.546286666666667],["Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements","Decrease_in_Measurements"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>quarter<\/th>\n      <th>fvalue_levene<\/th>\n      <th>pval_levene<\/th>\n      <th>deg_free_levene<\/th>\n      <th>Year_1<\/th>\n      <th>Year_2<\/th>\n      <th>Mean_Year_1<\/th>\n      <th>Mean_Year_2<\/th>\n      <th>Warning_Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatSignif(this, row, data, 4, 2, 3, ',', '.');\nDTWidget.formatSignif(this, row, data, 5, 2, 3, ',', '.');\nDTWidget.formatSignif(this, row, data, 9, 2, 3, ',', '.');\nDTWidget.formatSignif(this, row, data, 10, 2, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<div id="outs" class="section level2">
<h2><span class="header-section-number">3.4</span> Exceptional values and outliers</h2>
<p>These are detected by comparing each measured concentration to 3 x the 75th percentile of the data set by year, site, and pollutant. For now, collocated measurements (POCS) are not tested separately. For data with higher temporal variability, such as black carbon and ultrafine particulates, a criteria of 3 x the 95th percentile of the data set by year, site and pollutant should be used. The criteria for exceptional values was designed to balance sensitivity to actually find extremely high values with a limit to the number of extreme values that may be expected in a year of air monitoring. For example, most air pollution measurements are much higher during fire works, such as occurrs on July 4th and December 31st. These data are not in error, they are accurate representations of the air concentrations during those times.</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>Click the button to view a step by step example.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test for exceptionally high values [above 75th percentile X 3]</span>
high_data &lt;-<span class="st"> </span><span class="kw">group_by</span>(data, year, aqs_id, pollutant) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">AR_Mean =</span> <span class="kw">mean</span>(conc, <span class="dt">na.rm=</span>T), <span class="dt">Percentile_75 =</span> <span class="kw">quantile</span>(conc, <span class="fl">0.75</span>, <span class="dt">na.rm =</span> T), <span class="dt">Percentile_75_X3 =</span> Percentile_<span class="dv">75</span><span class="op">*</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()

high_data &lt;-<span class="st"> </span><span class="kw">filter</span>(high_data, conc<span class="op">&gt;</span>Percentile_75_X3, <span class="op">!</span><span class="kw">is.na</span>(conc), AR_Mean<span class="op">&gt;</span>md_limit, Percentile_<span class="dv">75</span><span class="op">&gt;</span><span class="dv">0</span>)


high_data<span class="op">$</span>Warning_Type &lt;-<span class="st"> &quot;Exceptionally_High_Value_Test&quot;</span>
high_data &lt;-<span class="st"> </span><span class="kw">unique</span>(high_data)

<span class="kw">datatable</span>(<span class="kw">head</span>(high_data, <span class="dv">10</span>), <span class="dt">options =</span> dt_options) </code></pre></div>
<div id="htmlwidget-17aa326532f598c42468" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-17aa326532f598c42468">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["270370465","270370465","270370465","270370465","270370465","270370465","270370465","270370465","270370465","270370465"],[1,2,1,1,1,2,1,2,1,2],[12102,12102,12102,12102,12102,12102,12102,12102,12102,12102],["2009-02-12","2009-02-12","2009-03-26","2009-12-21","2010-08-24","2010-08-24","2010-10-11","2010-10-11","2013-07-09","2013-07-09"],[0.02077,0.02092,0.01616,0.04905,0.04287,0.04097,0.01284,0.01235,0.01329,0.01338],[null,null,null,null,null,null,null,null,null,null],[0.0028236,0.0028236,0.0028236,0.0028236,0.0023556,0.0023556,0.0023556,0.0023556,0.00218715,0.00218715],["Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony","Antimony"],[2009,2009,2009,2009,2010,2010,2010,2010,2013,2013],["7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0"],[1,1,1,4,3,3,4,4,3,3],[0.00486700854700855,0.00486700854700855,0.00486700854700855,0.00486700854700855,0.00380803738317757,0.00380803738317757,0.00380803738317757,0.00380803738317757,0.00299623853211009,0.00299623853211009],[0.00521,0.00521,0.00521,0.00521,0.003975,0.003975,0.003975,0.003975,0.00372,0.00372],[0.01563,0.01563,0.01563,0.01563,0.011925,0.011925,0.011925,0.011925,0.01116,0.01116],["Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test","Exceptionally_High_Value_Test"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>year<\/th>\n      <th>cas<\/th>\n      <th>quarter<\/th>\n      <th>AR_Mean<\/th>\n      <th>Percentile_75<\/th>\n      <th>Percentile_75_X3<\/th>\n      <th>Warning_Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,3,5,7,9,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">high_data &lt;-<span class="st"> </span>high_data[, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;Warning_Type&quot;</span>)]</code></pre></div>
</div>
</div>
<div id="sticky2" class="section level2">
<h2><span class="header-section-number">3.5</span> Sequential repeats and “sticky” numbers</h2>
<p>Three sequential replicate values may be a result of a machine error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test for exceptionally high values [above 75th percentile X 3]</span>
repeat_data &lt;-<span class="st"> </span><span class="kw">group_by</span>(data, poc, year, aqs_id, pollutant) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(year, aqs_id, poc, pollutant, date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Previous_Day   =</span> <span class="kw">lag</span>(conc, <span class="dv">1</span>), 
         <span class="dt">Two_Days_Prior =</span> <span class="kw">lag</span>(conc, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()
repeat_data &lt;-<span class="st"> </span><span class="kw">mutate</span>(repeat_data, <span class="dt">Repeat_Test =</span> <span class="kw">ifelse</span>(<span class="kw">round</span>(conc, <span class="dt">digits =</span> <span class="dv">4</span>) <span class="op">==</span><span class="st"> </span><span class="kw">round</span>(Previous_Day, <span class="dt">digits =</span> <span class="dv">4</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">round</span>(Previous_Day, <span class="dt">digits =</span> <span class="dv">4</span>) <span class="op">==</span><span class="st"> </span><span class="kw">round</span>(Two_Days_Prior, <span class="dt">digits=</span><span class="dv">4</span>), <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>))

repeat_data<span class="op">$</span>Warning_Type &lt;-<span class="st"> &quot;Repeat_Test&quot;</span>

repeat_data &lt;-<span class="st"> </span><span class="kw">filter</span>(repeat_data, conc <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st">  </span>Repeat_Test <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)

<span class="kw">datatable</span>(<span class="kw">head</span>(repeat_data, <span class="dv">10</span>), <span class="dt">options =</span> dt_options)</code></pre></div>
<div id="htmlwidget-e899a2e5b9cffe909124" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e899a2e5b9cffe909124">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020"],[1,1,1,1,1,1,1,1,1,1],[43218,12105,12105,12105,12105,43806,12110,12110,12113,43815],["2009-04-13","2009-03-08","2009-08-11","2009-08-17","2009-12-09","2009-10-16","2009-05-19","2009-11-03","2009-10-28","2009-06-12"],[0.02212,0.00022,1e-005,4e-005,1e-005,0.01034,0.00011,5e-005,0.00012,0.06071],[null,null,null,null,null,null,null,null,null,null],[0.120844061030091,0.0017316,0.0017316,0.0017316,0.0017316,0.387415757930539,0.0022308,0.0022308,0.0015288,0.273432395381246],["1,3-Butadiene","Beryllium","Beryllium","Beryllium","Beryllium","Bromoform","Cadmium","Cadmium","Cobalt","Ethylene Dichloride"],[2009,2009,2009,2009,2009,2009,2009,2009,2009,2009],["106-99-0","7440-41-7","7440-41-7","7440-41-7","7440-41-7","75-25-2","7440-43-9","7440-43-9","7440-48-4","107-06-2"],[2,1,3,3,4,4,2,4,4,2],[0.02212,0.00021,0,1e-005,0,0.01034,0.0001,2e-005,9e-005,0.06071],[0.02212,0.00018,0,0,0,0.01034,0.00015,0,0.00015,0.06071],["TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE"],["Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>aqs_id<\/th>\n      <th>poc<\/th>\n      <th>param_code<\/th>\n      <th>date<\/th>\n      <th>conc<\/th>\n      <th>null_code<\/th>\n      <th>md_limit<\/th>\n      <th>pollutant<\/th>\n      <th>year<\/th>\n      <th>cas<\/th>\n      <th>quarter<\/th>\n      <th>Previous_Day<\/th>\n      <th>Two_Days_Prior<\/th>\n      <th>Repeat_Test<\/th>\n      <th>Warning_Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[2,3,5,7,9,11,12,13]},{"orderable":false,"targets":0}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">repeat_data &lt;-<span class="st"> </span>repeat_data[, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;pollutant&quot;</span>, <span class="st">&quot;aqs_id&quot;</span>, <span class="st">&quot;Warning_Type&quot;</span>)]

<span class="co"># Note</span>
## There are many repeating values in the Toxics data. None in PAHs. Approximately 3,200 for UFPs, but this is 15 minute data. We may need a more stringent test for UFPs.</code></pre></div>
<p><br> <em>Table: Dates and pollutants to check including the potential issue</em><br />
<div id="htmlwidget-a32f0dbb51bf6cc3094b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a32f0dbb51bf6cc3094b">{"x":{"filter":"none","data":[["2009-04-13","2009-03-08","2009-08-11","2009-08-17","2009-12-09","2009-10-16","2009-05-19","2009-11-03","2009-10-28","2009-06-12"],["1,3-Butadiene","Beryllium","Beryllium","Beryllium","Beryllium","Bromoform","Cadmium","Cadmium","Cobalt","Ethylene Dichloride"],["270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020","270370020"],["Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test","Repeat_Test"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>date<\/th>\n      <th>pollutant<\/th>\n      <th>aqs_id<\/th>\n      <th>Warning_Type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
</div>
<div id="unique" class="section level2">
<h2><span class="header-section-number">3.6</span> Unique detected values</h2>
<p>In some cases the detected observations at a site may all be an identical value. Identical observations scattered throughout monitoring results at a single monitor can indicate a machine error. In addition, calculating summary statistics often requires a minimum number of unique values, as it is difficult to make assumptions about the distribution of a data set when the values are all <code>1</code> or <code>2</code>.</p>
<p><br> <strong>Example <code>R</code> script</strong></p>
<p>Click the button below to view a step by step example of counting unqiue detected values.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<p><br> Packages</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>Our example data is organized by monitoring site and date.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-53"></span>
<div id="htmlwidget-d7a8de88104be5a2cb3f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7a8de88104be5a2cb3f">{"x":{"filter":"none","data":[[270535501,270535501,270535501,270535501,270535501],[1,1,1,1,1],[12102,12102,12102,12102,12102],["2009-07-30","2009-08-05","2009-08-11","2009-09-16","2009-09-22"],[0.00127,0.00223,0.0037,0.0018,0.0027],[null,null,null,null,null],[0.0028236,0.0028236,0.0028236,0.0028236,0.0028236],["Antimony","Antimony","Antimony","Antimony","Antimony"],[2009,2009,2009,2009,2009],["7440-36-0","7440-36-0","7440-36-0","7440-36-0","7440-36-0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>AQSID<\/th>\n      <th>POC<\/th>\n      <th>Param_Code<\/th>\n      <th>Date<\/th>\n      <th>Concentration<\/th>\n      <th>Null_Code<\/th>\n      <th>Dlimit<\/th>\n      <th>Pollutant<\/th>\n      <th>Year<\/th>\n      <th>CAS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"autoWidth":true,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"info":false,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,6,8]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 3.3: Sample data table.
</p>
</div>
<p><br></p>
<p>Count the number of unique detected values for each year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">        </span><span class="kw">group_by</span>(AQSID, POC, Param_Code, CAS, Year) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">detected_obs  =</span> <span class="kw">ifelse</span>(Concentration <span class="op">&lt;</span><span class="st"> </span>Dlimit, <span class="ot">NA</span>, Concentration), 
               <span class="dt">unique_values =</span> <span class="kw">n_distinct</span>(detected_obs, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p><br></p>
<p>Flag sites with less than 3 unique values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">          </span><span class="kw">group_by</span>(AQSID, POC, Param_Code, CAS, Year) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">summarize</span>(<span class="dt">unique_values =</span> unique_values[<span class="dv">1</span>],
                    <span class="dt">unique_flag   =</span> unique_values <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">ungroup</span>()</code></pre></div>
<p><br></p>
<p><strong>Final table with added <code>unique_flag</code>.</strong> <div id="htmlwidget-c52b86ff909684b6bf26" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c52b86ff909684b6bf26">{"x":{"filter":"none","data":[[271230868,270072303,270530969,270532006,270370442,271630438,270370443,271630436,270530966,270370442],[1,1,1,1,1,1,1,2,1,1],[45202,43218,45220,43860,43843,42153,43248,43218,43502,43231],["108-88-3","106-99-0","100-42-5","75-01-4","106-93-4","75-15-0","110-82-7","106-99-0","50-00-0","110-54-3"],[2013,2011,2009,2012,2009,2013,2010,2012,2013,2013],[50,5,0,0,0,3,18,10,52,37],[false,false,true,true,true,false,false,false,false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>AQSID<\/th>\n      <th>POC<\/th>\n      <th>Param_Code<\/th>\n      <th>CAS<\/th>\n      <th>Year<\/th>\n      <th>unique_values<\/th>\n      <th>unique_flag<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":0,"autoWidth":0,"searching":false,"ordering":false,"lengthChange":false,"paginate":false,"pageLength":10,"info":0,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,5]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script></p>
</div>
<p><br></p>
</div>
<div id="valid_ref" class="section level2">
<h2><span class="header-section-number">3.7</span> References</h2>
<p><a href="https://www3.epa.gov/ttnamti1/files/ambient/airtox/NATTS%20TAD%20Revision%203_FINAL%20October%202016.pdf">USEPA Technical Support Document for the Nation Air Toxics Trends Sites</a></p>
<p><a href="https://webgate.ec.europa.eu/fpfis/mwikis/essvalidserv/images/a/ad/PRACTICAL_GUIDE_TO_DATA_VALIDATION.pdf">European Union Guide to Data Validation</a></p>
<p><a href="https://www.epa.gov/sites/production/files/2015-06/documents/g8-final.pdf">US EPA Guidance on Data Verification and Data Validation</a></p>
<p><a href="https://www3.epa.gov/ttnamti1/files/ambient/airtox/workbook/T-Workbook_Secs1-8.pdf">US EPA Data Validation Workbook Presentation and Training Materials</a></p>
<p><a href="https://nepis.epa.gov/Exe/ZyPDF.cgi/P1006PAB.PDF?Dockey=P1006PAB.PDF">US EPA Data Analysis Workbook</a></p>
<p><a href="http://www.sciencedirect.com/science/article/pii/S1352231007004840">Temporal variability of selected air toxics in the United States</a></p>
<p><a href="http://www.tandfonline.com/doi/pdf/10.1080/10473289.2006.10464576">Spatial and temporal analysis of national air toxics data</a></p>

</div>
</div>
<script>
  $(".btn_code").click(function() {
    $(this.parentNode).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="quality-assurance-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="collocated-monitors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/02-data_cleaning.Rmd",
"text": "Edit"
},
"download": ["air-methods.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
