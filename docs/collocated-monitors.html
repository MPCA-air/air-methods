<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.5.2 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/MPCA-air/air-methods" />
  <meta property="og:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />
  
  <meta name="github-repo" content="MPCA-air/air-methods" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  <meta name="twitter:image" content="https://github.com/MPCA-air/air-methodsimages/cover.jpeg" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-cleaning.html">
<link rel="next" href="detection-limits.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.3/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://mpca-air.github.io/air-methods">Methods for air data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="best-practices.html"><a href="best-practices.html"><i class="fa fa-check"></i><b>1</b> Best practices</a><ul>
<li class="chapter" data-level="1.1" data-path="best-practices.html"><a href="best-practices.html#tidyverse"><i class="fa fa-check"></i><b>1.1</b> Tidyverse</a></li>
<li class="chapter" data-level="1.2" data-path="best-practices.html"><a href="best-practices.html#pollutant-names"><i class="fa fa-check"></i><b>1.2</b> Pollutant names</a></li>
<li class="chapter" data-level="1.3" data-path="best-practices.html"><a href="best-practices.html#keeping-r-up-to-date"><i class="fa fa-check"></i><b>1.3</b> Keeping R up-to-date</a></li>
<li class="chapter" data-level="1.4" data-path="best-practices.html"><a href="best-practices.html#script-layout"><i class="fa fa-check"></i><b>1.4</b> Script layout</a></li>
<li class="chapter" data-level="1.5" data-path="best-practices.html"><a href="best-practices.html#divide-and-conquer"><i class="fa fa-check"></i><b>1.5</b> Divide and conquer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-data.html"><a href="getting-data.html"><i class="fa fa-check"></i><b>2</b> Getting data</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-data.html"><a href="getting-data.html#air-monitoring"><i class="fa fa-check"></i><b>2.1</b> Air monitoring</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-data.html"><a href="getting-data.html#AQS"><i class="fa fa-check"></i><b>2.1.1</b> Retrieving data from AQS</a></li>
<li class="chapter" data-level="2.1.2" data-path="getting-data.html"><a href="getting-data.html#rqamd"><i class="fa fa-check"></i><b>2.1.2</b> Retrieving data from AQS DataMart</a></li>
<li class="chapter" data-level="2.1.3" data-path="getting-data.html"><a href="getting-data.html#aqi-now"><i class="fa fa-check"></i><b>2.1.3</b> Current AQI observations</a></li>
<li class="chapter" data-level="2.1.4" data-path="getting-data.html"><a href="getting-data.html#monitors"><i class="fa fa-check"></i><b>2.1.4</b> Active AQI monitors</a></li>
<li class="chapter" data-level="2.1.5" data-path="getting-data.html"><a href="getting-data.html#lims"><i class="fa fa-check"></i><b>2.1.5</b> Retrieving data from LIMS via Tableau</a></li>
<li class="chapter" data-level="2.1.6" data-path="getting-data.html"><a href="getting-data.html#AirVision"><i class="fa fa-check"></i><b>2.1.6</b> Retrieving continuous data from AirVision</a></li>
<li class="chapter" data-level="2.1.7" data-path="getting-data.html"><a href="getting-data.html#wair"><i class="fa fa-check"></i><b>2.1.7</b> Retrieving data from MPCA WAIR database</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-data.html"><a href="getting-data.html#health-and-standards"><i class="fa fa-check"></i><b>2.2</b> Health and standards</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-data.html"><a href="getting-data.html#IHBs"><i class="fa fa-check"></i><b>2.2.1</b> Inhalation health benchmarks</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-data.html"><a href="getting-data.html#NAAQS"><i class="fa fa-check"></i><b>2.2.2</b> Air Quality Standards (NAAQs and MAAQS)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-data.html"><a href="getting-data.html#air-modeling"><i class="fa fa-check"></i><b>2.3</b> Air modeling</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-data.html"><a href="getting-data.html#nata"><i class="fa fa-check"></i><b>2.3.1</b> NATA modeling</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-data.html"><a href="getting-data.html#mnrisks"><i class="fa fa-check"></i><b>2.3.2</b> MNRISKS statewide risk modeling</a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-data.html"><a href="getting-data.html#downscale"><i class="fa fa-check"></i><b>2.3.3</b> Downscaler modeling results for Ozone and PM2.5</a></li>
<li class="chapter" data-level="2.3.4" data-path="getting-data.html"><a href="getting-data.html#cmaq"><i class="fa fa-check"></i><b>2.3.4</b> CMAQ Ozone modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-data.html"><a href="getting-data.html#context"><i class="fa fa-check"></i><b>2.4</b> Context</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-data.html"><a href="getting-data.html#mn-ei"><i class="fa fa-check"></i><b>2.4.1</b> MN Emissions Inventory</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-data.html"><a href="getting-data.html#nei"><i class="fa fa-check"></i><b>2.4.2</b> EPA’s NEI</a></li>
<li class="chapter" data-level="2.4.3" data-path="getting-data.html"><a href="getting-data.html#fac-coords"><i class="fa fa-check"></i><b>2.4.3</b> Facility locations</a></li>
<li class="chapter" data-level="2.4.4" data-path="getting-data.html"><a href="getting-data.html#wx-obs"><i class="fa fa-check"></i><b>2.4.4</b> Weather observations</a></li>
<li class="chapter" data-level="2.4.5" data-path="getting-data.html"><a href="getting-data.html#hysplit"><i class="fa fa-check"></i><b>2.4.5</b> HYSPLIT wind trajectories</a></li>
<li class="chapter" data-level="2.4.6" data-path="getting-data.html"><a href="getting-data.html#landuse"><i class="fa fa-check"></i><b>2.4.6</b> Land use maps</a></li>
<li class="chapter" data-level="2.4.7" data-path="getting-data.html"><a href="getting-data.html#census"><i class="fa fa-check"></i><b>2.4.7</b> United States Census boundaries</a></li>
<li class="chapter" data-level="2.4.8" data-path="getting-data.html"><a href="getting-data.html#acs"><i class="fa fa-check"></i><b>2.4.8</b> American Community Survey (ACS)</a></li>
</ul></li>
</ul></li>
<li><a href="quality-assurance-methods.html#quality-assurance-methods"><strong>Quality assurance methods</strong></a></li>
<li class="chapter" data-level="3" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>3</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.1" data-path="data-cleaning.html"><a href="data-cleaning.html#missing"><i class="fa fa-check"></i><b>3.1</b> Remove blank, NULL, and missing values</a></li>
<li class="chapter" data-level="3.2" data-path="data-cleaning.html"><a href="data-cleaning.html#quals"><i class="fa fa-check"></i><b>3.2</b> Remove <em>Qualified</em> data</a></li>
<li class="chapter" data-level="3.3" data-path="data-cleaning.html"><a href="data-cleaning.html#leaks"><i class="fa fa-check"></i><b>3.3</b> Instrument drift or leaks in a system.</a></li>
<li class="chapter" data-level="3.4" data-path="data-cleaning.html"><a href="data-cleaning.html#outs"><i class="fa fa-check"></i><b>3.4</b> Exceptional values and outliers</a></li>
<li class="chapter" data-level="3.5" data-path="data-cleaning.html"><a href="data-cleaning.html#sticky2"><i class="fa fa-check"></i><b>3.5</b> Sequential repeats and “sticky” numbers</a></li>
<li class="chapter" data-level="3.6" data-path="data-cleaning.html"><a href="data-cleaning.html#unique"><i class="fa fa-check"></i><b>3.6</b> Unique detected values</a></li>
<li class="chapter" data-level="3.7" data-path="data-cleaning.html"><a href="data-cleaning.html#valid_ref"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collocated-monitors.html"><a href="collocated-monitors.html"><i class="fa fa-check"></i><b>4</b> Collocated monitors</a><ul>
<li class="chapter" data-level="4.1" data-path="collocated-monitors.html"><a href="collocated-monitors.html#evalpocs"><i class="fa fa-check"></i><b>4.1</b> Evaluate collocated air monitors</a></li>
<li class="chapter" data-level="4.2" data-path="collocated-monitors.html"><a href="collocated-monitors.html#pripocs"><i class="fa fa-check"></i><b>4.2</b> Prioritize multiple air monitors (POCs)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="detection-limits.html"><a href="detection-limits.html"><i class="fa fa-check"></i><b>5</b> Detection limits</a><ul>
<li class="chapter" data-level="5.1" data-path="detection-limits.html"><a href="detection-limits.html#method-detection-limit---definition"><i class="fa fa-check"></i><b>5.1</b> Method Detection Limit - <em>Definition</em></a></li>
<li class="chapter" data-level="5.2" data-path="detection-limits.html"><a href="detection-limits.html#procedure-for-calculating-method-detection-limits"><i class="fa fa-check"></i><b>5.2</b> Procedure for calculating method detection limits</a></li>
<li class="chapter" data-level="5.3" data-path="detection-limits.html"><a href="detection-limits.html#finding-detection-limits"><i class="fa fa-check"></i><b>5.3</b> Finding detection limits</a></li>
<li class="chapter" data-level="5.4" data-path="detection-limits.html"><a href="detection-limits.html#qualifier-codes-for-detection-limits"><i class="fa fa-check"></i><b>5.4</b> Qualifier Codes for Detection Limits</a></li>
<li class="chapter" data-level="5.5" data-path="detection-limits.html"><a href="detection-limits.html#estimating-below-detection-values-what-not-to-do"><i class="fa fa-check"></i><b>5.5</b> Estimating below detection values <em>(what not to do)</em></a></li>
<li class="chapter" data-level="5.6" data-path="detection-limits.html"><a href="detection-limits.html#below-detection-values"><i class="fa fa-check"></i><b>5.6</b> Below detection values</a></li>
<li class="chapter" data-level="5.7" data-path="detection-limits.html"><a href="detection-limits.html#multiple-detection-limits"><i class="fa fa-check"></i><b>5.7</b> Multiple detection limits</a></li>
<li class="chapter" data-level="5.8" data-path="detection-limits.html"><a href="detection-limits.html#references"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="completeness-checks.html"><a href="completeness-checks.html"><i class="fa fa-check"></i><b>6</b> Completeness checks</a><ul>
<li class="chapter" data-level="6.1" data-path="completeness-checks.html"><a href="completeness-checks.html#complete"><i class="fa fa-check"></i><b>6.1</b> Completeness checks</a></li>
</ul></li>
<li><a href="summary-methods.html#summary-methods"><strong>Summary methods</strong></a></li>
<li class="chapter" data-level="7" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>7</b> Summary statistics</a><ul>
<li class="chapter" data-level="7.1" data-path="summary-statistics.html"><a href="summary-statistics.html#boots"><i class="fa fa-check"></i><b>7.1</b> Bootstrapping</a></li>
<li class="chapter" data-level="7.2" data-path="summary-statistics.html"><a href="summary-statistics.html#below"><i class="fa fa-check"></i><b>7.2</b> Below the detection limit</a></li>
<li class="chapter" data-level="7.3" data-path="summary-statistics.html"><a href="summary-statistics.html#confidence"><i class="fa fa-check"></i><b>7.3</b> Upper confidence limits (UCLs)</a></li>
<li class="chapter" data-level="7.4" data-path="summary-statistics.html"><a href="summary-statistics.html#incomplete"><i class="fa fa-check"></i><b>7.4</b> Annual summaries for incomplete data</a></li>
<li class="chapter" data-level="7.5" data-path="summary-statistics.html"><a href="summary-statistics.html#health"><i class="fa fa-check"></i><b>7.5</b> Comparison of data to inhalation health benchmarks</a></li>
<li class="chapter" data-level="7.6" data-path="summary-statistics.html"><a href="summary-statistics.html#roll365"><i class="fa fa-check"></i><b>7.6</b> Rolling 365 day summaries</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="site-comparisons.html"><a href="site-comparisons.html"><i class="fa fa-check"></i><b>8</b> Site comparisons</a><ul>
<li class="chapter" data-level="8.1" data-path="site-comparisons.html"><a href="site-comparisons.html#confidence-intervals"><i class="fa fa-check"></i><b>8.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.2" data-path="site-comparisons.html"><a href="site-comparisons.html#tools-to-visualize-data"><i class="fa fa-check"></i><b>8.2</b> Tools to visualize data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="site-comparisons.html"><a href="site-comparisons.html#beeswarm-plots"><i class="fa fa-check"></i><b>8.2.1</b> Beeswarm Plots</a></li>
<li class="chapter" data-level="8.2.2" data-path="site-comparisons.html"><a href="site-comparisons.html#correlation-matrices"><i class="fa fa-check"></i><b>8.2.2</b> Correlation matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="start-finish.html"><a href="start-finish.html"><i class="fa fa-check"></i><b>9</b> Start to finish</a><ul>
<li class="chapter" data-level="9.1" data-path="start-finish.html"><a href="start-finish.html#functions"><i class="fa fa-check"></i><b>9.1</b> <strong>Functions</strong></a></li>
<li class="chapter" data-level="9.2" data-path="start-finish.html"><a href="start-finish.html#analysis-steps"><i class="fa fa-check"></i><b>9.2</b> <strong>Analysis Steps</strong></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>10</b> Charts</a><ul>
<li class="chapter" data-level="10.1" data-path="charts.html"><a href="charts.html#boxplots"><i class="fa fa-check"></i><b>10.1</b> Boxplots</a><ul>
<li class="chapter" data-level="10.1.1" data-path="charts.html"><a href="charts.html#log-boxplots"><i class="fa fa-check"></i><b>10.1.1</b> Log boxplots</a></li>
<li class="chapter" data-level="10.1.2" data-path="charts.html"><a href="charts.html#outliers"><i class="fa fa-check"></i><b>10.1.2</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="charts.html"><a href="charts.html#calendar-plots"><i class="fa fa-check"></i><b>10.2</b> Calendar plots</a></li>
<li class="chapter" data-level="10.3" data-path="charts.html"><a href="charts.html#color-palettes"><i class="fa fa-check"></i><b>10.3</b> Color palettes</a></li>
<li class="chapter" data-level="10.4" data-path="charts.html"><a href="charts.html#pollution-roses"><i class="fa fa-check"></i><b>10.4</b> Pollution roses</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>11</b> Time series</a><ul>
<li class="chapter" data-level="11.1" data-path="time-series.html"><a href="time-series.html#seasonality"><i class="fa fa-check"></i><b>11.1</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>12</b> Maps</a><ul>
<li class="chapter" data-level="12.1" data-path="maps.html"><a href="maps.html#kriging"><i class="fa fa-check"></i><b>12.1</b> Kriging</a></li>
<li class="chapter" data-level="12.2" data-path="maps.html"><a href="maps.html#spatial-averaging-and-aggregation"><i class="fa fa-check"></i><b>12.2</b> Spatial averaging and aggregation</a></li>
<li class="chapter" data-level="12.3" data-path="maps.html"><a href="maps.html#creating-shapefiles-in-r-adn-joining-to-ej-areas"><i class="fa fa-check"></i><b>12.3</b> Creating shapefiles in R adn joining to EJ areas</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>13</b> Additional resources</a></li>
<li><a href="mpca-data-tools.html#mpca-data-tools"><strong>MPCA data tools</strong></a></li>
<li class="chapter" data-level="14" data-path="aqi-explorer.html"><a href="aqi-explorer.html"><i class="fa fa-check"></i><b>14</b> AQI explorer</a></li>
<li class="chapter" data-level="15" data-path="criteria-pollutant-explorer.html"><a href="criteria-pollutant-explorer.html"><i class="fa fa-check"></i><b>15</b> Criteria pollutant explorer</a></li>
<li class="chapter" data-level="16" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html"><i class="fa fa-check"></i><b>16</b> Air toxics explorer</a><ul>
<li class="chapter" data-level="16.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#mpca-air-toxics-methods"><i class="fa fa-check"></i><b>16.1</b> MPCA Air Toxics Methods</a><ul>
<li class="chapter" data-level="16.1.1" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-cleaning-1"><i class="fa fa-check"></i><b>16.1.1</b> Data Cleaning</a></li>
<li class="chapter" data-level="16.1.2" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#data-validation-1"><i class="fa fa-check"></i><b>16.1.2</b> Data Validation</a></li>
<li class="chapter" data-level="16.1.3" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#parameter-occurrence-codes-pocs"><i class="fa fa-check"></i><b>16.1.3</b> Parameter Occurrence Codes (POCs)</a></li>
<li class="chapter" data-level="16.1.4" data-path="air-toxics-explorer.html"><a href="air-toxics-explorer.html#producing-annual-summaries"><i class="fa fa-check"></i><b>16.1.4</b> Producing Annual Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="edit-this-book.html"><a href="edit-this-book.html"><i class="fa fa-check"></i>Edit this book</a></li>
<li class="divider"></li>
<li><a href="https://github.com/MPCA-air" target="blank">Created by MPCA-air</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="collocated-monitors" class="section level1">
<h1><span class="header-section-number"></span> Collocated monitors</h1>
<p><img src="https://imgs.xkcd.com/comics/box_plot.png" width="95%" /></p>
<p>Analysis steps for collocated monitors include:</p>
<p><a href="collocated-monitors.html#evalpocs">4.1</a> <strong>Evaluate sites with collocated monitors</strong><br />
<a href="collocated-monitors.html#pripocs">4.2</a> <strong>Prioritize observations from collocated monitors</strong></p>
<p><br> <em>Chapter Maintainance</em> <Derek Nagel
<br> <br></p>
<div id="evalpocs" class="section level2">
<h2><span class="header-section-number">4.1</span> Evaluate collocated air monitors</h2>
<p><strong>Description</strong></p>
<p>Collocated samples are multiple samples taken for a pollutant from the same monitoring site at the same time. Collocated samples provide an extra layer of quality assurance by taking multiple measurements under very similar conditions which helps detect machine, lab, and human error. Depending on the results from collocated monitors, only one of the monitors, or potentially neither may be considered as valid measurements.</p>
<p><br> <strong>Why not keep all the data?</strong></p>
<p>Leaving observations for multiple POCs in the data set is likely to bias calculated summary statistics. For example, consider a site that starts with two monitors operating during the winter months, but after one malfunctions, the site is left with one monitor operating for the remainder of the year. If we were to calculate the annual average for this site, the mean would be biased by having twice as many observations during the winter months. By limiting the number of observations to 1 per day, we can remove the bias due to the extra winter observations.</p>
<p><br> <strong>Recommended steps</strong></p>
<p>Viewing a scatterplot of collocated measurements is suggested as it helps to view both obvious and subtle irregularities between collocated measurements. If there is evidence of bias in one of the monitors (values from one collocated monitor are usually higher than the other), or there is large variance between the collocated monitors (values differ from each other by significant margins), then both collocated monitors need to be investigated further.</p>
<p>EPA recommends that collocated monitors have no higher than a 15% coefficient of variation between their measurements. Calculating the CV for every measurement pair does not make sense as small differences (i.e. 0.001 and 0.002) have the same CV as large differences (i.e. 10 and 20). Therefore, we chose to look at the median CV for each site, pollutant, and year then flag collocated monitors if the median CV is greater than 15 which suggests differences between the collocated monitors are systematic. We only calculate the CV for collocated monitors on days which both have valid measurements greater than or equal to the MDL since there is lower confidence in values below the MDL. We only compare the median CV to the threshold of 15 if there are at least 10 calculated CV values since it does not make sense to flag monitors where only a few values are above detection.</p>
<p>If collocated monitors do not agree, then consult with the lab, field or quality assurance team to determine if there is a problem with one of the POCs. If they determine that one of POCs is reliable and the other is not, then only use data from the reliable POC. If they cannot determine which POC is the problem, then confidence in the measurements from both collocated monitors is reduced and * no measurements taken from either collocated monitor should be used.* More than likely, we will be asked to report results. We will have lower confidence in the accuracy of those results</p>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>The function <code>POC_compare</code> below generates scatterplots comparing sample values from POC 1 and POC 2 for sites with collocated monitors. If most points on the scatterplot are close to the red line and the correlation is high, then measurements from both POCs are considered equally valid. If points are not close to the red line or the correlation is not high, then both POCs need to be investigated to determine if one POC is more relaible.</p>
<p>Click the button below to view example R script.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)
<span class="kw">names</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AQSID&quot;</span>, <span class="st">&quot;POC&quot;</span>, <span class="st">&quot;Parameter&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Result&quot;</span>, <span class="st">&quot;null_code&quot;</span>, <span class="st">&quot;MDL&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;cas&quot;</span>)

POC_compare =<span class="st"> </span><span class="cf">function</span>(data) {

<span class="kw">library</span>(shiny)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(rsconnect)  
  
data =<span class="st"> </span><span class="kw">distinct</span>(data, AQSID, POC, Parameter, Date, Pollutant, Year, <span class="dt">.keep_all =</span> T) <span class="co">#replace with better cleaning function</span>
data =<span class="st"> </span><span class="kw">spread</span>(data, POC, Result) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Status =</span> <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">1</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span>MDL  <span class="op">&amp;</span><span class="st"> `</span><span class="dt">2</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span>MDL, <span class="st">&quot;POCs 1 and 2 below MDL&quot;</span>, <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">1</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span>MDL, <span class="st">&quot;POC 1 below MDL&quot;</span>, <span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">2</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span>MDL, <span class="st">&quot;POC 2 below MDL&quot;</span>, <span class="st">&quot;POCs 1 and 2 above MDL&quot;</span>) ) ) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(Status)



Pollutant &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>Pollutant)
Site &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>AQSID)
Year &lt;-<span class="st"> </span><span class="kw">unique</span>(data<span class="op">$</span>Year)

<span class="kw">shinyApp</span>(
  <span class="dt">ui =</span> <span class="kw">fluidPage</span>(<span class="dt">responsive =</span> <span class="ot">FALSE</span>,
                 <span class="kw">fluidRow</span>(
                   <span class="kw">column</span>(<span class="dv">3</span>,
                          <span class="dt">style =</span> <span class="st">&quot;padding-bottom: 20px;&quot;</span>,
                          <span class="kw">inputPanel</span>(
                            <span class="kw">selectInput</span>(<span class="st">&quot;Pollutant&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a pollutant&quot;</span>, <span class="dt">choices =</span> Pollutant),
                            <span class="kw">selectInput</span>(<span class="st">&quot;Year&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a year&quot;</span>, <span class="dt">choices =</span> Year),
                            <span class="kw">selectInput</span>(<span class="st">&quot;Site&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Choose a site&quot;</span>, <span class="dt">choices =</span> Site))),
                   <span class="kw">column</span>(<span class="dv">9</span>,
                          <span class="kw">plotOutput</span>(<span class="st">&#39;normviz&#39;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>)))),
  
  
  <span class="dt">server =</span> <span class="cf">function</span>(input, output) {
    
    
    
    
    output<span class="op">$</span>normviz &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({
      <span class="kw">print</span>(input<span class="op">$</span>Pollutant)
      <span class="kw">print</span>(input<span class="op">$</span>Site)
      <span class="kw">print</span>(input<span class="op">$</span>Year)
      data_sub =<span class="st"> </span><span class="kw">filter</span>(data, Pollutant<span class="op">==</span>input<span class="op">$</span>Pollutant, AQSID <span class="op">==</span><span class="st"> </span>input<span class="op">$</span>Site, Year <span class="op">==</span><span class="st"> </span>input<span class="op">$</span>Year)
      <span class="kw">ggplot</span>(data_sub, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">1</span><span class="st">`</span>, <span class="dt">y =</span> <span class="st">`</span><span class="dt">2</span><span class="st">`</span>, <span class="dt">color =</span> Status)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_segment</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">1000</span>, <span class="dt">xend=</span><span class="dv">1000</span>, <span class="dt">y=</span><span class="op">-</span><span class="dv">1000</span>, <span class="dt">yend=</span><span class="dv">1000</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;POC comparison chart&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;POC 1&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;POC 2&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Correlation =&quot;</span>, <span class="kw">round</span>(<span class="kw">cor</span>(data_sub<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>,data_sub<span class="op">$</span><span class="st">`</span><span class="dt">2</span><span class="st">`</span>, <span class="dt">use =</span> <span class="st">&quot;complete&quot;</span>), <span class="dv">2</span>) ) )
    })
    
  })

}

<span class="kw">POC_compare</span>(data)</code></pre></div>
<p><br></p>
</div>
<div id="pripocs" class="section level2">
<h2><span class="header-section-number">4.2</span> Prioritize multiple air monitors (POCs)</h2>
<p><strong>Description</strong></p>
<p>If both collocated monitors at a site are considered equally valid, then a single value must be chosen from multiple collocated values to avoid double-counting values at a single site.</p>
<p><br> <strong>Recommended steps</strong></p>
<p>For air toxics, measurements from collocated monitors are considered equally valid unless there is a specific reason to treat them differently. Therefore, these methods are used for dealing with collocated samples where the POCs generally provide similar results.</p>
<ol style="list-style-type: decimal">
<li><p>If one monitor has a valid measurement, and the other does not, then the valid measurement is used.</p></li>
<li><p>If one monitor has a valid measurement greater than or equal to the MDL and the other has a valid measurement less than the MDL, then the measurement above the MDL is used as a conservative approach as there is greater confidence in the value above the MDL.</p></li>
<li><p>If both monitors have valid measurements above the MDL, then those values are averaged since both values are equally valid and the “true” value is assumed to likely be between the two values.</p></li>
</ol>
<p><br> <strong>Sample <code>R</code> script</strong></p>
<p>The script below uses the <code>POC_average()</code> function to combine results from multiple POCs into one combined site result according to the rules listed above.</p>
<p>Click the button below to view example R script.</p>
<div class="toggle">
<button class="btn_code">
Show <strong>R</strong> code
</button>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/MPCA-air/air-methods/master/airtoxics_data_2009_2013.csv&#39;</span>)
<span class="kw">names</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AQSID&quot;</span>, <span class="st">&quot;POC&quot;</span>, <span class="st">&quot;Parameter&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Result&quot;</span>, <span class="st">&quot;Null_Data_Code&quot;</span>, <span class="st">&quot;MDL&quot;</span>, <span class="st">&quot;Pollutant&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;CAS&quot;</span>)

POC_average =<span class="st"> </span><span class="cf">function</span>(data) {
  <span class="kw">library</span>(tidyverse)
  
  POC_averaging =<span class="st"> </span><span class="cf">function</span>(Result, Censored) {
    
    Result =<span class="st"> </span>Result[<span class="op">!</span><span class="kw">is.na</span>(Result)]
    Censored =<span class="st"> </span>Censored[<span class="op">!</span><span class="kw">is.na</span>(Censored)]
    
    <span class="cf">if</span>(<span class="kw">all</span>(Censored, <span class="dt">na.rm =</span> T)) {
      <span class="kw">return</span> (<span class="kw">mean</span>(Result, <span class="dt">na.rm =</span> T))
    }
    <span class="cf">else</span> {
      <span class="kw">return</span> (<span class="kw">mean</span>(Result[<span class="op">!</span>Censored], <span class="dt">na.rm =</span> T ) )
    }
    
  }
  
  data =<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(AQSID, Parameter, Pollutant, Date, MDL) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">Result =</span> <span class="kw">POC_averaging</span>(Result, Censored), <span class="dt">Censored =</span> <span class="kw">all</span>(Censored, <span class="dt">na.rm =</span> T) ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Result =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(Result), <span class="ot">NA</span>, Result), <span class="dt">Censored =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(Result), <span class="ot">NA</span>, Censored))
  <span class="kw">return</span> (<span class="kw">select</span>(data, AQSID, Parameter, Pollutant, Date, Result, MDL, Censored) ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()
}

POC_averaged_data =<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Censored =</span> Result <span class="op">&lt;</span><span class="st"> </span>MDL) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">POC_average</span>()</code></pre></div>

</div>
</div>
<script>
  $(".btn_code").click(function() {
    $(this.parentNode).toggleClass("open");
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="data-cleaning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="detection-limits.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MPCA-air/air-methods/edit/master/04-collocated_monitors.Rmd",
"text": "Edit"
},
"download": ["air-methods.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
